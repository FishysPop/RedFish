"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __name = (target, value) => __defProp(target, "name", { value, configurable: true });
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/index.ts
var src_exports = {};
__export(src_exports, {
  AppleMusicExtractor: () => AppleMusicExtractor,
  AttachmentExtractor: () => AttachmentExtractor,
  Internal: () => internal_exports,
  ReverbnationExtractor: () => ReverbnationExtractor,
  SoundCloudExtractor: () => SoundCloudExtractor,
  SpotifyExtractor: () => SpotifyExtractor,
  UA: () => UA,
  VimeoExtractor: () => VimeoExtractor,
  YouTubeExtractor: () => YoutubeExtractor,
  YouTubeLibs: () => YouTubeLibs,
  YoutubeExtractor: () => YoutubeExtractor,
  createImport: () => createImport,
  getFetch: () => getFetch,
  loadYtdl: () => loadYtdl,
  lyricsExtractor: () => lyricsExtractor,
  makeYTSearch: () => makeYTSearch,
  version: () => version
});
module.exports = __toCommonJS(src_exports);

// src/extractors/SoundCloudExtractor.ts
var import_discord_player = require("discord-player");
var import_soundcloud_scraper = require("soundcloud-scraper");
var soundcloud = new import_soundcloud_scraper.Client(void 0, {
  fetchAPIKey: true
});
var SoundCloudExtractor = class extends import_discord_player.BaseExtractor {
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [
      import_discord_player.QueryType.SOUNDCLOUD,
      import_discord_player.QueryType.SOUNDCLOUD_PLAYLIST,
      import_discord_player.QueryType.SOUNDCLOUD_SEARCH,
      import_discord_player.QueryType.SOUNDCLOUD_TRACK,
      import_discord_player.QueryType.AUTO,
      import_discord_player.QueryType.AUTO_SEARCH
    ].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    if (track.queryType === import_discord_player.QueryType.SOUNDCLOUD_TRACK)
      return this.handle(track.author || track.title, {
        requestedBy: track.requestedBy,
        type: import_discord_player.QueryType.SOUNDCLOUD_SEARCH
      });
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player.QueryType.SOUNDCLOUD_TRACK: {
        const trackInfo = await soundcloud.getSongInfo(query, {
          fetchComments: false,
          fetchEmbed: false,
          fetchStreamURL: true
        }).catch(import_discord_player.Util.noop);
        if (!trackInfo)
          return this.emptyResponse();
        const track = new import_discord_player.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(trackInfo.duration)),
          description: trackInfo.description,
          thumbnail: trackInfo.thumbnail,
          views: trackInfo.playCount,
          author: trackInfo.author.name,
          requestedBy: context.requestedBy,
          source: "soundcloud",
          engine: trackInfo,
          queryType: context.type
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      case import_discord_player.QueryType.SOUNDCLOUD_PLAYLIST: {
        const data = await soundcloud.getPlaylist(query, {
          fetchEmbed: false
        }).catch(import_discord_player.Util.noop);
        if (!data)
          return { playlist: null, tracks: [] };
        const res = new import_discord_player.Playlist(this.context.player, {
          title: data.title,
          description: data.description ?? "",
          thumbnail: data.thumbnail ?? "https://soundcloud.com/pwa-icon-192.png",
          type: "playlist",
          source: "soundcloud",
          author: {
            name: data.author?.name ?? data.author?.username ?? "Unknown Artist",
            url: data.author?.profile
          },
          tracks: [],
          id: `${data.id}`,
          url: data.url,
          rawPlaylist: data
        });
        for (const song of data.tracks) {
          const track = new import_discord_player.Track(this.context.player, {
            title: song.title,
            description: song.description ?? "",
            author: song.author?.username ?? song.author?.name ?? "Unknown Artist",
            url: song.url,
            thumbnail: song.thumbnail,
            duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(song.duration)),
            views: song.playCount ?? 0,
            requestedBy: context.requestedBy,
            playlist: res,
            source: "soundcloud",
            engine: song,
            queryType: context.type
          });
          track.extractor = this;
          res.tracks.push(track);
        }
        return { playlist: res, tracks: res.tracks };
      }
      default: {
        const tracks = await soundcloud.search(query, "track").catch(import_discord_player.Util.noop);
        if (!tracks || !tracks.length)
          return this.emptyResponse();
        const resolvedTracks = [];
        for (const searchedTrack of tracks) {
          const trackInfo = await soundcloud.getSongInfo(searchedTrack.url, {
            fetchStreamURL: true,
            fetchComments: false,
            fetchEmbed: false
          }).catch(import_discord_player.Util.noop);
          if (!trackInfo)
            continue;
          const track = new import_discord_player.Track(this.context.player, {
            title: trackInfo.title,
            url: trackInfo.url,
            duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(trackInfo.duration)),
            description: trackInfo.description,
            thumbnail: trackInfo.thumbnail,
            views: trackInfo.playCount,
            author: trackInfo.author.name,
            requestedBy: context.requestedBy,
            source: "soundcloud",
            engine: trackInfo,
            queryType: "soundcloudTrack"
          });
          track.extractor = this;
          resolvedTracks.push(track);
        }
        return { playlist: null, tracks: resolvedTracks };
      }
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    if (engine && engine.streamURL) {
      return engine.streamURL;
    }
    const url = await soundcloud.fetchStreamURL(info.url).catch(import_discord_player.Util.noop);
    if (!url)
      throw new Error("Could not extract stream from this track source");
    if (engine) {
      engine.streamURL = url;
    } else {
      info.raw.engine = {
        streamURL: url
      };
    }
    return url;
  }
};
__name(SoundCloudExtractor, "SoundCloudExtractor");
SoundCloudExtractor.identifier = "com.discord-player.soundcloudextractor";

// src/extractors/YoutubeExtractor.ts
var import_youtube_sr2 = require("youtube-sr");
var import_discord_player2 = require("discord-player");

// src/extractors/common/helper.ts
var import_youtube_sr = require("youtube-sr");
var factory;
var createImport = /* @__PURE__ */ __name((lib) => import(lib).catch(() => null), "createImport");
var UA = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Edg/109.0.1518.49";
var YouTubeLibs = [
  "ytdl-core",
  "@distube/ytdl-core",
  "play-dl"
];
var forcedLib = process.env.DP_FORCE_YTDL_MOD;
if (forcedLib)
  YouTubeLibs.unshift(forcedLib);
var getFetch = typeof fetch !== "undefined" ? fetch : async (info, init) => {
  let dy;
  if (dy = await createImport("undici")) {
    return (dy.fetch || dy.default.fetch)(info, init);
  } else if (dy = await createImport("node-fetch")) {
    return (dy.fetch || dy.default)(info, init);
  } else {
    throw new Error("No fetch lib found");
  }
};
async function loadYtdl(options, force = false) {
  if (factory && !force)
    return factory;
  let lib, _ytLibName, _stream;
  for (const ytlib of YouTubeLibs) {
    lib = await import(ytlib).then(
      (m) => m,
      () => null
    );
    if (!lib)
      continue;
    lib = lib.default || lib;
    _ytLibName = ytlib;
    break;
  }
  if (lib) {
    const isYtdl = ["ytdl-core", "@distube/ytdl-core"].some((lib2) => lib2 === _ytLibName);
    _stream = /* @__PURE__ */ __name(async (query) => {
      if (isYtdl) {
        const dl = lib;
        const info = await dl.getInfo(query, options);
        const formats = info.formats.filter((format) => {
          return info.videoDetails.isLiveContent ? format.isHLS && format.hasAudio : format.hasAudio;
        }).sort((a, b) => Number(b.audioBitrate) - Number(a.audioBitrate) || Number(a.bitrate) - Number(b.bitrate));
        const fmt = formats.find((format) => !format.hasVideo) || formats.sort((a, b) => Number(a.bitrate) - Number(b.bitrate))[0];
        return fmt.url;
      } else {
        const dl = lib;
        const info = await dl.video_info(query);
        const formats = info.format.filter((format) => {
          const re2 = /\/manifest\/hls_(variant|playlist)\//;
          if (!format.url)
            return false;
          if (info.video_details.live)
            return re2.test(format.url) && typeof format.bitrate === "number";
          return typeof format.bitrate === "number";
        }).sort((a, b) => Number(b.bitrate) - Number(a.bitrate));
        const fmt = formats.find((format) => !format.qualityLabel) || formats.sort((a, b) => Number(a.bitrate) - Number(b.bitrate))[0];
        return fmt.url;
      }
    }, "_stream");
  } else {
    throw new Error(`Could not load youtube library. Install one of ${YouTubeLibs.map((lib2) => `"${lib2}"`).join(", ")}`);
  }
  factory = { name: _ytLibName, stream: _stream, lib };
  return factory;
}
__name(loadYtdl, "loadYtdl");
async function makeYTSearch(query, opt) {
  const res = await import_youtube_sr.YouTube.search(query, {
    type: "video",
    requestOptions: opt
  }).catch(() => {
  });
  return res || [];
}
__name(makeYTSearch, "makeYTSearch");

// src/extractors/YoutubeExtractor.ts
var validQueryDomains = /* @__PURE__ */ new Set(["youtube.com", "www.youtube.com", "m.youtube.com", "music.youtube.com", "gaming.youtube.com"]);
var validPathDomains = /^https?:\/\/(youtu\.be\/|(www\.)?youtube\.com\/(embed|v|shorts)\/)/;
var idRegex = /^[a-zA-Z0-9-_]{11}$/;
var _YoutubeExtractor = class extends import_discord_player2.BaseExtractor {
  async activate() {
    const fn = this.options.createStream;
    if (typeof fn === "function") {
      this._stream = (q) => {
        return fn(this, q);
      };
      return;
    }
    const { stream, name } = await loadYtdl(this.context.player.options.ytdlOptions);
    this._stream = stream;
    this._ytLibName = name;
  }
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [
      import_discord_player2.QueryType.YOUTUBE,
      import_discord_player2.QueryType.YOUTUBE_PLAYLIST,
      import_discord_player2.QueryType.YOUTUBE_SEARCH,
      import_discord_player2.QueryType.YOUTUBE_VIDEO,
      import_discord_player2.QueryType.AUTO,
      import_discord_player2.QueryType.AUTO_SEARCH
    ].some((r) => r === type);
  }
  async handle(query, context) {
    query = query.includes("youtube.com") ? query.replace(/(m(usic)?|gaming)\./, "") : query;
    if (_YoutubeExtractor.validateURL(query))
      context.type = import_discord_player2.QueryType.YOUTUBE_VIDEO;
    switch (context.type) {
      case import_discord_player2.QueryType.YOUTUBE_PLAYLIST: {
        const ytpl = await import_youtube_sr2.YouTube.getPlaylist(query, {
          fetchAll: true,
          requestOptions: context.requestOptions
        }).catch(import_discord_player2.Util.noop);
        if (!ytpl)
          return this.emptyResponse();
        const playlist = new import_discord_player2.Playlist(this.context.player, {
          title: ytpl.title,
          thumbnail: ytpl.thumbnail,
          description: ytpl.title || "",
          type: "playlist",
          source: "youtube",
          author: {
            name: ytpl.channel.name,
            url: ytpl.channel.url
          },
          tracks: [],
          id: ytpl.id,
          url: ytpl.url,
          rawPlaylist: ytpl
        });
        playlist.tracks = ytpl.videos.map((video) => {
          const track = new import_discord_player2.Track(this.context.player, {
            title: video.title,
            description: video.description,
            author: video.channel?.name,
            url: video.url,
            requestedBy: context.requestedBy,
            thumbnail: video.thumbnail.url,
            views: video.views,
            duration: video.durationFormatted,
            raw: video,
            playlist,
            source: "youtube",
            queryType: "youtubeVideo"
          });
          track.extractor = this;
          return track;
        });
        return { playlist, tracks: playlist.tracks };
      }
      case import_discord_player2.QueryType.YOUTUBE_VIDEO: {
        const id = /[a-zA-Z0-9-_]{11}/.exec(query);
        if (!id?.[0])
          return this.emptyResponse();
        const video = await import_youtube_sr2.YouTube.getVideo(`https://www.youtube.com/watch?v=${id}`, context.requestOptions).catch(import_discord_player2.Util.noop);
        if (!video)
          return this.emptyResponse();
        video.source = "youtube";
        const track = new import_discord_player2.Track(this.context.player, {
          title: video.title,
          description: video.description,
          author: video.channel?.name,
          url: video.url,
          requestedBy: context.requestedBy,
          thumbnail: video.thumbnail?.displayThumbnailURL("maxresdefault"),
          views: video.views,
          duration: video.durationFormatted,
          source: "youtube",
          raw: video,
          queryType: context.type
        });
        track.extractor = this;
        return {
          playlist: null,
          tracks: [track]
        };
      }
      default: {
        const tracks = await this._makeYTSearch(query, context);
        return { playlist: null, tracks };
      }
    }
  }
  async _makeYTSearch(query, context) {
    const res = await makeYTSearch(query, context.requestOptions).catch(import_discord_player2.Util.noop);
    if (!res || !res.length)
      return [];
    return res.map((video) => {
      video.source = "youtube";
      const track = new import_discord_player2.Track(this.context.player, {
        title: video.title,
        description: video.description,
        author: video.channel?.name,
        url: video.url,
        requestedBy: context.requestedBy,
        thumbnail: video.thumbnail?.displayThumbnailURL("maxresdefault"),
        views: video.views,
        duration: video.durationFormatted,
        source: "youtube",
        raw: video,
        queryType: context.type
      });
      track.extractor = this;
      return track;
    });
  }
  async getRelatedTracks(track) {
    let info;
    if (_YoutubeExtractor.validateURL(track.url))
      info = await import_youtube_sr2.YouTube.getVideo(track.url).then((x) => x.videos).catch(import_discord_player2.Util.noop);
    if (!info)
      info = await import_youtube_sr2.YouTube.search(track.author || track.title, { limit: 5, type: "video" }).then((x) => x).catch(import_discord_player2.Util.noop);
    if (!info?.length) {
      return this.createResponse();
    }
    const similar = info.map((video) => {
      const t = new import_discord_player2.Track(this.context.player, {
        title: video.title,
        url: `https://www.youtube.com/watch?v=${video.id}`,
        duration: video.durationFormatted || import_discord_player2.Util.buildTimeCode(import_discord_player2.Util.parseMS(video.duration * 1e3)),
        description: video.title,
        thumbnail: typeof video.thumbnail === "string" ? video.thumbnail : video.thumbnail.url,
        views: video.views,
        author: video.channel.name,
        requestedBy: track.requestedBy,
        source: "youtube",
        queryType: "youtubeVideo"
      });
      t.extractor = this;
      return t;
    });
    return this.createResponse(null, similar);
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    if (!this._stream) {
      throw new Error(`Could not find youtube streaming library. Install one of ${YouTubeLibs.join(", ")}`);
    }
    let url = info.url;
    url = url.includes("youtube.com") ? url.replace(/(m(usic)?|gaming)\./, "") : url;
    return this._stream(url);
  }
  static validateURL(link) {
    try {
      _YoutubeExtractor.parseURL(link);
      return true;
    } catch {
      return false;
    }
  }
  static validateId(id) {
    return idRegex.test(id.trim());
  }
  static parseURL(link) {
    const parsed = new URL(link.trim());
    let id = parsed.searchParams.get("v");
    if (validPathDomains.test(link.trim()) && !id) {
      const paths = parsed.pathname.split("/");
      id = parsed.host === "youtu.be" ? paths[1] : paths[2];
    } else if (parsed.hostname && !validQueryDomains.has(parsed.hostname)) {
      throw Error("Not a YouTube domain");
    }
    if (!id) {
      throw Error(`No video id found: "${link}"`);
    }
    id = id.substring(0, 11);
    if (!exports.validateID(id)) {
      throw TypeError(`Video id (${id}) does not match expected format (${idRegex.toString()})`);
    }
    return id;
  }
};
var YoutubeExtractor = _YoutubeExtractor;
__name(YoutubeExtractor, "YoutubeExtractor");
YoutubeExtractor.identifier = "com.discord-player.youtubeextractor";

// src/extractors/LyricsExtractor.ts
var import_genius_lyrics = require("genius-lyrics");
var client;
function lyricsExtractor(apiKey, force) {
  if (!client && !force)
    client = new import_genius_lyrics.Client(apiKey);
  return { search, client };
}
__name(lyricsExtractor, "lyricsExtractor");
function search(query) {
  return new Promise((resolve, reject) => {
    if (typeof query !== "string")
      return reject(new TypeError(`Expected search query to be a string, received "${typeof query}"!`));
    client.songs.search(query).then(async (songs) => {
      const data = {
        title: songs[0].title,
        fullTitle: songs[0].fullTitle,
        id: songs[0].id,
        thumbnail: songs[0].thumbnail,
        image: songs[0].image,
        url: songs[0].url,
        artist: {
          name: songs[0].artist.name,
          id: songs[0].artist.id,
          url: songs[0].artist.url,
          image: songs[0].artist.image
        },
        lyrics: await songs[0].lyrics(false)
      };
      resolve(data);
    }).catch(() => {
      reject(new Error("Could not parse lyrics"));
    });
  });
}
__name(search, "search");

// src/extractors/VimeoExtractor.ts
var import_discord_player3 = require("discord-player");

// src/internal/Vimeo.ts
var import_http = __toESM(require("http"));
var import_https = __toESM(require("https"));
var Vimeo = class {
  constructor() {
    throw new Error(`The ${this.constructor.name} class may not be instantiated!`);
  }
  static download(id) {
    return new Promise(async (resolve) => {
      const info = await Vimeo.getInfo(id);
      if (!info)
        return null;
      const downloader = info.stream.startsWith("https://") ? import_https.default : import_http.default;
      downloader.get(info.stream, (res) => {
        resolve(res);
      });
    });
  }
  static async getInfo(id) {
    if (!id)
      throw new Error("Invalid id");
    const url = `https://player.vimeo.com/video/${id}`;
    try {
      const res = await getFetch(url);
      const data = await res.text();
      const json = JSON.parse(data.split("window.playerConfig =")[1].split(";")[0].trim());
      const obj = {
        id: json.video.id,
        duration: json.video.duration * 1e3,
        title: json.video.title,
        url: json.video.url,
        thumbnail: json.video.thumbs["1280"] || json.video.thumbs.base,
        stream: json.request.files.progressive[0].url,
        author: {
          id: json.video.owner.id,
          name: json.video.owner.name,
          url: json.video.owner.url,
          avatar: json.video.owner.img_2x || json.video.owner.img
        }
      };
      return obj;
    } catch {
      return null;
    }
  }
};
__name(Vimeo, "Vimeo");

// src/extractors/VimeoExtractor.ts
var VimeoExtractor = class extends import_discord_player3.BaseExtractor {
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [import_discord_player3.QueryType.VIMEO].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player3.QueryType.VIMEO: {
        const trackInfo = await Vimeo.getInfo(
          query.split("/").filter((x) => !!x).pop()
        ).catch(import_discord_player3.Util.noop);
        if (!trackInfo)
          return this.emptyResponse();
        const track = new import_discord_player3.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player3.Util.buildTimeCode(import_discord_player3.Util.parseMS(trackInfo.duration || 0)),
          description: `${trackInfo.title} by ${trackInfo.author.name}`,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.author.name,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.stream,
          queryType: context.type
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      default:
        return this.emptyResponse();
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    if (engine) {
      return engine;
    }
    const track = await Vimeo.getInfo(info.url).catch(import_discord_player3.Util.noop);
    if (!track || !track.stream)
      throw new Error("Could not extract stream from this source");
    info.raw.engine = {
      streamURL: track.stream
    };
    return track.stream;
  }
};
__name(VimeoExtractor, "VimeoExtractor");
VimeoExtractor.identifier = "com.discord-player.vimeoextractor";

// src/extractors/ReverbnationExtractor.ts
var import_discord_player4 = require("discord-player");
var import_reverbnation_scraper = __toESM(require("reverbnation-scraper"));
var ReverbnationExtractor = class extends import_discord_player4.BaseExtractor {
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [import_discord_player4.QueryType.REVERBNATION].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player4.QueryType.REVERBNATION: {
        const trackInfo = await import_reverbnation_scraper.default.getInfo(query).catch(import_discord_player4.Util.noop);
        if (!trackInfo)
          return this.emptyResponse();
        const track = new import_discord_player4.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player4.Util.buildTimeCode(import_discord_player4.Util.parseMS(trackInfo.duration)),
          description: trackInfo.lyrics || `${trackInfo.title} by ${trackInfo.artist.name}`,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.artist.name,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.streamURL,
          queryType: context.type
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      default:
        return this.emptyResponse();
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    if (engine) {
      return engine;
    }
    const track = await import_reverbnation_scraper.default.getInfo(info.url).catch(import_discord_player4.Util.noop);
    if (!track || !track.streamURL)
      throw new Error("Could not extract stream from this source");
    info.raw.engine = {
      streamURL: track.streamURL
    };
    return track.streamURL;
  }
};
__name(ReverbnationExtractor, "ReverbnationExtractor");
ReverbnationExtractor.identifier = "com.discord-player.reverbnationextractor";

// src/extractors/AttachmentExtractor.ts
var import_discord_player5 = require("discord-player");
var import_fs = require("fs");

// src/internal/downloader.ts
var import_http2 = __toESM(require("http"));
var import_https2 = __toESM(require("https"));
function downloadStream(url, opts = {}) {
  return new Promise((resolve, reject) => {
    const lib = url.startsWith("http://") ? import_http2.default : import_https2.default;
    lib.get(url, opts, (res) => resolve(res)).once("error", reject);
  });
}
__name(downloadStream, "downloadStream");

// src/extractors/AttachmentExtractor.ts
var fileType = __toESM(require("file-type"));
var import_path = __toESM(require("path"));
var import_promises = require("fs/promises");
var AttachmentExtractor = class extends import_discord_player5.BaseExtractor {
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [import_discord_player5.QueryType.ARBITRARY, import_discord_player5.QueryType.FILE].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player5.QueryType.ARBITRARY: {
        const data = await downloadStream(query, context.requestOptions);
        if (!["audio/", "video/"].some((r) => !!data.headers["content-type"]?.startsWith(r)))
          return this.emptyResponse();
        const trackInfo = {
          title: (query.split("/").filter((x) => x.length).pop() ?? "Attachment").split("?")[0].trim(),
          duration: 0,
          thumbnail: "https://upload.wikimedia.org/wikipedia/commons/2/2a/ITunes_12.2_logo.png",
          engine: query,
          author: data.client?.servername || "Attachment",
          description: data.client?.servername || "Attachment",
          url: data.url || query
        };
        const track = new import_discord_player5.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player5.Util.buildTimeCode(import_discord_player5.Util.parseMS(trackInfo.duration)),
          description: trackInfo.description,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.author,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.url,
          queryType: context.type
        });
        track.extractor = this;
        track.raw.isFile = false;
        return { playlist: null, tracks: [track] };
      }
      case import_discord_player5.QueryType.FILE: {
        if (!(0, import_fs.existsSync)(query))
          return this.emptyResponse();
        const fstat = await (0, import_promises.stat)(query);
        if (!fstat.isFile())
          return this.emptyResponse();
        const mime = await fileType.fromFile(query).catch(() => null);
        if (!mime || !["audio/", "video/"].some((r) => !!mime.mime.startsWith(r)))
          return this.emptyResponse();
        const trackInfo = {
          title: import_path.default.basename(query) || "Attachment",
          duration: 0,
          thumbnail: "https://upload.wikimedia.org/wikipedia/commons/2/2a/ITunes_12.2_logo.png",
          engine: query,
          author: "Attachment",
          description: "Attachment",
          url: query
        };
        const track = new import_discord_player5.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player5.Util.buildTimeCode(import_discord_player5.Util.parseMS(trackInfo.duration)),
          description: trackInfo.description,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.author,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.url,
          queryType: context.type
        });
        track.extractor = this;
        track.raw.isFile = true;
        return { playlist: null, tracks: [track] };
      }
      default:
        return this.emptyResponse();
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    const isFile = info.raw.isFile;
    if (!engine)
      throw new Error("Could not find stream source");
    if (!isFile) {
      return engine;
    }
    return (0, import_fs.createReadStream)(engine);
  }
};
__name(AttachmentExtractor, "AttachmentExtractor");
AttachmentExtractor.identifier = "com.discord-player.attachmentextractor";

// src/extractors/AppleMusicExtractor.ts
var import_discord_player7 = require("discord-player");

// src/internal/index.ts
var internal_exports = {};
__export(internal_exports, {
  AppleMusic: () => AppleMusic,
  SpotifyAPI: () => SpotifyAPI,
  Vimeo: () => Vimeo,
  downloadStream: () => downloadStream
});

// src/internal/AppleMusic.ts
var import_discord_player6 = require("discord-player");
var import_node_html_parser = require("node-html-parser");
function getHTML(link) {
  return getFetch(link, {
    headers: {
      "User-Agent": UA
    }
  }).then((r) => r.text()).then(
    (txt) => (0, import_node_html_parser.parse)(txt),
    () => null
  );
}
__name(getHTML, "getHTML");
function makeImage({ height, url, width, ext = "jpg" }) {
  return url.replace("{w}", `${width}`).replace("{h}", `${height}`).replace("{f}", ext);
}
__name(makeImage, "makeImage");
function parseDuration(d) {
  const r = /* @__PURE__ */ __name((name, unit) => `((?<${name}>-?\\d*[\\.,]?\\d+)${unit})?`, "r");
  const regex = new RegExp(
    [
      "(?<negative>-)?P",
      r("years", "Y"),
      r("months", "M"),
      r("weeks", "W"),
      r("days", "D"),
      "(T",
      r("hours", "H"),
      r("minutes", "M"),
      r("seconds", "S"),
      ")?"
    ].join("")
  );
  const test = regex.exec(d);
  if (!test || !test.groups)
    return "0:00";
  const dur = [test.groups.years, test.groups.months, test.groups.weeks, test.groups.days, test.groups.hours, test.groups.minutes, test.groups.seconds];
  return dur.filter((r2, i, a) => !!r2 || i > a.length - 2).map((m, i) => {
    if (!m)
      m = "0";
    return i < 1 ? m : m.padStart(2, "0");
  }).join(":") || "0:00";
}
__name(parseDuration, "parseDuration");
var AppleMusic = class {
  constructor() {
    return AppleMusic;
  }
  static async search(query) {
    try {
      const url = `https://music.apple.com/us/search?term=${encodeURIComponent(query)}`;
      const node = await getHTML(url);
      if (!node)
        return [];
      const rawData = node.getElementById("serialized-server-data");
      if (!rawData)
        return [];
      const data = JSON.parse(rawData.innerText)[0].data.sections;
      const tracks = data.find((s) => s.itemKind === "trackLockup")?.items;
      if (!tracks)
        return [];
      return tracks.map((track) => ({
        id: track.contentDescriptor.identifiers.storeAdamID,
        duration: track.duration || "0:00",
        title: track.title,
        url: track.contentDescriptor.url,
        thumbnail: track?.artwork?.dictionary ? makeImage({
          url: track.artwork.dictionary.url,
          height: track.artwork.dictionary.height,
          width: track.artwork.dictionary.width
        }) : "https://music.apple.com/assets/favicon/favicon-180.png",
        artist: {
          name: track.subtitleLinks?.[0]?.title ?? "Unknown Artist"
        }
      }));
    } catch {
      return [];
    }
  }
  static async getSongInfoFallback(res, name, id, link) {
    try {
      const metaTags = res.getElementsByTagName("meta");
      if (!metaTags.length)
        return null;
      const title = metaTags.find((r) => r.getAttribute("name") === "apple:title")?.getAttribute("content") || res.querySelector("title")?.innerText || name;
      const contentId = metaTags.find((r) => r.getAttribute("name") === "apple:content_id")?.getAttribute("content") || id;
      const durationRaw = metaTags.find((r) => r.getAttribute("property") === "music:song:duration")?.getAttribute("content");
      const song = {
        id: contentId,
        duration: durationRaw ? parseDuration(durationRaw) : metaTags.find((m) => m.getAttribute("name") === "apple:description")?.textContent.split("Duration: ")?.[1].split('"')?.[0] || "0:00",
        title,
        url: link,
        thumbnail: metaTags.find((r) => ["og:image:secure_url", "og:image"].includes(r.getAttribute("property")))?.getAttribute("content") || "https://music.apple.com/assets/favicon/favicon-180.png",
        artist: {
          name: res.querySelector(".song-subtitles__artists>a")?.textContent?.trim() || "Apple Music"
        }
      };
      return song;
    } catch {
      return null;
    }
  }
  static async getSongInfo(link) {
    if (!import_discord_player6.QueryResolver.regex.appleMusicSongRegex.test(link)) {
      return null;
    }
    const url = new URL(link);
    const id = url.searchParams.get("i");
    const name = url.pathname.split("album/")[1]?.split("/")[0];
    if (!id || !name)
      return null;
    const res = await getHTML(`https://music.apple.com/us/song/${name}/${id}`);
    if (!res)
      return null;
    try {
      const datasrc = res.getElementById("serialized-server-data")?.innerText || res.innerText.split('<script type="application/json" id="serialized-server-data">')?.[1]?.split("<\/script>")?.[0];
      if (!datasrc)
        throw "not found";
      const data = JSON.parse(datasrc)[0].data.seoData;
      const song = data.ogSongs[0]?.attributes;
      return {
        id: data.ogSongs[0]?.id || data.appleContentId || id,
        duration: song?.durationInMillis || "0:00",
        title: song?.name || data.appleTitle,
        url: song?.url || data.url || link,
        thumbnail: song?.artwork ? makeImage({
          url: song.artwork.url,
          height: song.artwork.height,
          width: song.artwork.width
        }) : data.artworkUrl ? makeImage({
          height: data.height,
          width: data.width,
          url: data.artworkUrl,
          ext: data.fileType || "jpg"
        }) : "https://music.apple.com/assets/favicon/favicon-180.png",
        artist: {
          name: song?.artistName || data.socialTitle || "Apple Music"
        }
      };
    } catch {
      return this.getSongInfoFallback(res, name, id, link);
    }
  }
  static async getPlaylistInfo(link) {
    if (!import_discord_player6.QueryResolver.regex.appleMusicPlaylistRegex.test(link)) {
      return null;
    }
    const res = await getHTML(link);
    if (!res)
      return null;
    try {
      const datasrc = res.getElementById("serialized-server-data")?.innerText || res.innerText.split('<script type="application/json" id="serialized-server-data">')?.[1]?.split("<\/script>")?.[0];
      if (!datasrc)
        throw "not found";
      const pl = JSON.parse(datasrc)[0].data.seoData;
      const thumbnail = pl.artworkUrl ? makeImage({
        height: pl.height,
        width: pl.width,
        url: pl.artworkUrl,
        ext: pl.fileType || "jpg"
      }) : "https://music.apple.com/assets/favicon/favicon-180.png";
      return {
        id: pl.appleContentId,
        title: pl.appleTitle,
        thumbnail,
        artist: {
          name: pl.ogSongs?.[0]?.attributes?.artistName || "Apple Music"
        },
        url: pl.url,
        tracks: pl.ogSongs?.map((m) => {
          const song = m.attributes;
          return {
            id: m.id,
            duration: song.durationInMillis || "0:00",
            title: song.name,
            url: song.url,
            thumbnail: song.artwork ? makeImage({
              url: song.artwork.url,
              height: song.artwork.height,
              width: song.artwork.width
            }) : thumbnail,
            artist: {
              name: song.artistName || "Apple Music"
            }
          };
        }) || []
      };
    } catch {
      return null;
    }
  }
  static async getAlbumInfo(link) {
    if (!import_discord_player6.QueryResolver.regex.appleMusicAlbumRegex.test(link)) {
      return null;
    }
    const res = await getHTML(link);
    if (!res)
      return null;
    try {
      const datasrc = res.getElementById("serialized-server-data")?.innerText || res.innerText.split('<script type="application/json" id="serialized-server-data">')?.[1]?.split("<\/script>")?.[0];
      if (!datasrc)
        throw "not found";
      const pl = JSON.parse(datasrc)[0].data.seoData;
      const thumbnail = pl.artworkUrl ? makeImage({
        height: pl.height,
        width: pl.width,
        url: pl.artworkUrl,
        ext: pl.fileType || "jpg"
      }) : "https://music.apple.com/assets/favicon/favicon-180.png";
      return {
        id: pl.appleContentId,
        title: pl.appleTitle,
        thumbnail,
        artist: {
          name: pl.ogSongs?.[0]?.attributes?.artistName || "Apple Music"
        },
        url: pl.url,
        tracks: pl.ogSongs?.map((m) => {
          const song = m.attributes;
          return {
            id: m.id,
            duration: song.durationInMillis || "0:00",
            title: song.name,
            url: song.url,
            thumbnail: song.artwork ? makeImage({
              url: song.artwork.url,
              height: song.artwork.height,
              width: song.artwork.width
            }) : thumbnail,
            artist: {
              name: song.artistName || "Apple Music"
            }
          };
        }) || []
      };
    } catch {
      return null;
    }
  }
};
__name(AppleMusic, "AppleMusic");

// src/internal/Spotify.ts
var SP_ANON_TOKEN_URL = "https://open.spotify.com/get_access_token?reason=transport&productType=embed";
var SP_ACCESS_TOKEN_URL = "https://accounts.spotify.com/api/token?grant_type=client_credentials";
var SP_BASE = "https://api.spotify.com/v1";
var SpotifyAPI = class {
  constructor(credentials = {
    clientId: null,
    clientSecret: null
  }) {
    this.credentials = credentials;
    this.accessToken = null;
  }
  get authorizationKey() {
    if (!this.credentials.clientId || !this.credentials.clientSecret)
      return null;
    return Buffer.from(`${this.credentials.clientId}:${this.credentials.clientSecret}`).toString("base64");
  }
  async requestToken() {
    const key = this.authorizationKey;
    if (!key)
      return await this.requestAnonymousToken();
    try {
      const res = await getFetch(SP_ACCESS_TOKEN_URL, {
        method: "POST",
        headers: {
          "User-Agent": UA,
          Authorization: `Basic ${key}`,
          "Content-Type": "application/json"
        }
      });
      const body = await res.json();
      if (!body.access_token)
        throw "no token";
      const data = {
        token: body.access_token,
        expiresAfter: body.expires_in,
        type: "Bearer"
      };
      return this.accessToken = data;
    } catch {
      return await this.requestAnonymousToken();
    }
  }
  async requestAnonymousToken() {
    try {
      const res = await getFetch(SP_ANON_TOKEN_URL, {
        headers: {
          "User-Agent": UA,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        throw "not_ok";
      const body = await res.json();
      if (!body.accessToken)
        throw "no_access_token";
      const data = {
        token: body.accessToken,
        expiresAfter: body.accessTokenExpirationTimestampMs,
        type: "Bearer"
      };
      return this.accessToken = data;
    } catch {
      return null;
    }
  }
  isTokenExpired() {
    if (!this.accessToken)
      return true;
    return Date.now() > this.accessToken.expiresAfter;
  }
  async search(query) {
    try {
      if (this.isTokenExpired())
        await this.requestToken();
      if (!this.accessToken)
        return null;
      const res = await getFetch(`${SP_BASE}/search/?q=${encodeURIComponent(query)}&type=track&market=US`, {
        headers: {
          "User-Agent": UA,
          Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        return null;
      const data = await res.json();
      return data.tracks.items.map((m) => ({
        title: m.name,
        duration: m.duration_ms,
        artist: m.artists.map((m2) => m2.name).join(", "),
        url: m.external_urls?.spotify || `https://open.spotify.com/track/${m.id}`,
        thumbnail: m.album.images?.[0]?.url || null
      }));
    } catch {
      return null;
    }
  }
  async getPlaylist(id) {
    try {
      if (this.isTokenExpired())
        await this.requestToken();
      if (!this.accessToken)
        return null;
      const res = await getFetch(`${SP_BASE}/playlists/${id}?market=US`, {
        headers: {
          "User-Agent": UA,
          Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        return null;
      const data = await res.json();
      if (!data.tracks.items.length)
        return null;
      const t = data.tracks.items;
      let next = data.tracks.next;
      while (typeof next === "string") {
        try {
          const res2 = await getFetch(next, {
            headers: {
              "User-Agent": UA,
              Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
              "Content-Type": "application/json"
            }
          });
          if (!res2.ok)
            break;
          const nextPage = await res2.json();
          t.push(...nextPage.items);
          next = nextPage.next;
          if (!next)
            break;
        } catch {
          break;
        }
      }
      const tracks = t.map(({ track: m }) => ({
        title: m.name,
        duration: m.duration_ms,
        artist: m.artists.map((m2) => m2.name).join(", "),
        url: m.external_urls?.spotify || `https://open.spotify.com/track/${m.id}`,
        thumbnail: m.album.images?.[0]?.url || null
      }));
      if (!tracks.length)
        return null;
      return {
        name: data.name,
        author: data.owner.display_name,
        thumbnail: data.images?.[0]?.url || null,
        id: data.id,
        url: data.external_urls.spotify || `https://open.spotify.com/playlist/${id}`,
        tracks
      };
    } catch {
      return null;
    }
  }
  async getAlbum(id) {
    try {
      if (this.isTokenExpired())
        await this.requestToken();
      if (!this.accessToken)
        return null;
      const res = await getFetch(`${SP_BASE}/albums/${id}?market=US`, {
        headers: {
          "User-Agent": UA,
          Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        return null;
      const data = await res.json();
      if (!data.tracks.items.length)
        return null;
      const t = data.tracks.items;
      let next = data.tracks.next;
      while (typeof next === "string") {
        try {
          const res2 = await getFetch(next, {
            headers: {
              "User-Agent": UA,
              Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
              "Content-Type": "application/json"
            }
          });
          if (!res2.ok)
            break;
          const nextPage = await res2.json();
          t.push(...nextPage.items);
          next = nextPage.next;
          if (!next)
            break;
        } catch {
          break;
        }
      }
      const tracks = t.map((m) => ({
        title: m.name,
        duration: m.duration_ms,
        artist: m.artists.map((m2) => m2.name).join(", "),
        url: m.external_urls?.spotify || `https://open.spotify.com/track/${m.id}`,
        thumbnail: data.images?.[0]?.url || null
      }));
      if (!tracks.length)
        return null;
      return {
        name: data.name,
        author: data.artists.map((m) => m.name).join(", "),
        thumbnail: data.images?.[0]?.url || null,
        id: data.id,
        url: data.external_urls.spotify || `https://open.spotify.com/album/${id}`,
        tracks
      };
    } catch {
      return null;
    }
  }
};
__name(SpotifyAPI, "SpotifyAPI");

// src/extractors/AppleMusicExtractor.ts
var AppleMusicExtractor = class extends import_discord_player7.BaseExtractor {
  constructor() {
    super(...arguments);
    this._isYtdl = false;
  }
  async activate() {
    const fn = this.options.createStream;
    if (typeof fn === "function") {
      this._isYtdl = false;
      this._stream = (q) => {
        return fn(this, q);
      };
      return;
    }
    const lib = await loadYtdl(this.context.player.options.ytdlOptions);
    this._stream = lib.stream;
    this._isYtdl = true;
  }
  async validate(query, type) {
    return [
      import_discord_player7.QueryType.APPLE_MUSIC_ALBUM,
      import_discord_player7.QueryType.APPLE_MUSIC_PLAYLIST,
      import_discord_player7.QueryType.APPLE_MUSIC_SONG,
      import_discord_player7.QueryType.APPLE_MUSIC_SEARCH,
      import_discord_player7.QueryType.AUTO,
      import_discord_player7.QueryType.AUTO_SEARCH
    ].some((t) => t === type);
  }
  async getRelatedTracks(track) {
    if (track.queryType === import_discord_player7.QueryType.APPLE_MUSIC_SONG)
      return this.handle(track.author || track.title, {
        type: import_discord_player7.QueryType.APPLE_MUSIC_SEARCH,
        requestedBy: track.requestedBy
      });
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player7.QueryType.AUTO:
      case import_discord_player7.QueryType.AUTO_SEARCH:
      case import_discord_player7.QueryType.APPLE_MUSIC_SEARCH: {
        const data = await AppleMusic.search(query);
        if (!data || !data.length)
          return this.createResponse();
        const tracks = data.map(
          (m) => {
            const track = new import_discord_player7.Track(this.context.player, {
              author: m.artist.name,
              description: m.title,
              duration: typeof m.duration === "number" ? import_discord_player7.Util.buildTimeCode(import_discord_player7.Util.parseMS(m.duration)) : m.duration,
              thumbnail: m.thumbnail,
              title: m.title,
              url: m.url,
              views: 0,
              source: "apple_music",
              requestedBy: context.requestedBy,
              queryType: "appleMusicSong"
            });
            track.extractor = this;
            return track;
          }
        );
        return this.createResponse(null, tracks);
      }
      case import_discord_player7.QueryType.APPLE_MUSIC_ALBUM: {
        const info = await AppleMusic.getAlbumInfo(query);
        if (!info)
          return this.createResponse();
        const playlist = new import_discord_player7.Playlist(this.context.player, {
          author: {
            name: info.artist.name,
            url: ""
          },
          description: info.title,
          id: info.id,
          source: "apple_music",
          thumbnail: info.thumbnail,
          title: info.title,
          tracks: [],
          type: "album",
          url: info.url,
          rawPlaylist: info
        });
        playlist.tracks = info.tracks.map(
          (m) => {
            const track = new import_discord_player7.Track(this.context.player, {
              author: m.artist.name,
              description: m.title,
              duration: typeof m.duration === "number" ? import_discord_player7.Util.buildTimeCode(import_discord_player7.Util.parseMS(m.duration)) : m.duration,
              thumbnail: m.thumbnail,
              title: m.title,
              url: m.url,
              views: 0,
              source: "apple_music",
              requestedBy: context.requestedBy,
              queryType: "appleMusicSong"
            });
            track.extractor = this;
            return track;
          }
        );
        return { playlist, tracks: playlist.tracks };
      }
      case import_discord_player7.QueryType.APPLE_MUSIC_PLAYLIST: {
        const info = await AppleMusic.getPlaylistInfo(query);
        if (!info)
          return this.createResponse();
        const playlist = new import_discord_player7.Playlist(this.context.player, {
          author: {
            name: info.artist.name,
            url: ""
          },
          description: info.title,
          id: info.id,
          source: "apple_music",
          thumbnail: info.thumbnail,
          title: info.title,
          tracks: [],
          type: "playlist",
          url: info.url,
          rawPlaylist: info
        });
        playlist.tracks = info.tracks.map(
          (m) => {
            const track = new import_discord_player7.Track(this.context.player, {
              author: m.artist.name,
              description: m.title,
              duration: typeof m.duration === "number" ? import_discord_player7.Util.buildTimeCode(import_discord_player7.Util.parseMS(m.duration)) : m.duration,
              thumbnail: m.thumbnail,
              title: m.title,
              url: m.url,
              views: 0,
              source: "apple_music",
              requestedBy: context.requestedBy,
              queryType: "appleMusicSong"
            });
            track.extractor = this;
            return track;
          }
        );
        return { playlist, tracks: playlist.tracks };
      }
      case import_discord_player7.QueryType.APPLE_MUSIC_SONG: {
        const info = await AppleMusic.getSongInfo(query);
        if (!info)
          return this.createResponse();
        const track = new import_discord_player7.Track(this.context.player, {
          author: info.artist.name,
          description: info.title,
          duration: typeof info.duration === "number" ? import_discord_player7.Util.buildTimeCode(import_discord_player7.Util.parseMS(info.duration)) : info.duration,
          thumbnail: info.thumbnail,
          title: info.title,
          url: info.url,
          views: 0,
          source: "apple_music",
          requestedBy: context.requestedBy,
          queryType: context.type
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      default:
        return { playlist: null, tracks: [] };
    }
  }
  async stream(info) {
    if (!this._stream) {
      throw new Error(`Could not initialize streaming api for '${this.constructor.name}'`);
    }
    let url = info.url;
    if (this._isYtdl) {
      if (YoutubeExtractor.validateURL(info.raw.url))
        url = info.raw.url;
      else {
        const _url = await makeYTSearch(`${info.title} ${info.author}`, "video").then((r) => r[0].url).catch(import_discord_player7.Util.noop);
        if (!_url)
          throw new Error("Failed to fetch resources for ytdl streaming");
        info.raw.url = url = _url;
      }
    }
    return this._stream(url);
  }
};
__name(AppleMusicExtractor, "AppleMusicExtractor");
AppleMusicExtractor.identifier = "com.discord-player.applemusicextractor";

// src/extractors/SpotifyExtractor.ts
var import_discord_player8 = require("discord-player");
var import_spotify_url_info = __toESM(require("spotify-url-info"));
var re = /^(?:https:\/\/open\.spotify\.com\/(?:user\/[A-Za-z0-9]+\/)?|spotify:)(album|playlist|track)(?:[/:])([A-Za-z0-9]+).*$/;
var SpotifyExtractor = class extends import_discord_player8.BaseExtractor {
  constructor() {
    super(...arguments);
    this._isYtdl = false;
    this._credentials = {
      clientId: this.options.clientId || process.env.DP_SPOTIFY_CLIENT_ID || null,
      clientSecret: this.options.clientSecret || process.env.DP_SPOTIFY_CLIENT_SECRET || null
    };
    this.internal = new SpotifyAPI(this._credentials);
  }
  async activate() {
    const fn = this.options.createStream;
    if (typeof fn === "function") {
      this._isYtdl = false;
      this._stream = (q) => {
        return fn(this, q);
      };
      return;
    }
    const lib = await loadYtdl(this.context.player.options.ytdlOptions);
    this._stream = lib.stream;
    this._lib = (0, import_spotify_url_info.default)(getFetch);
    this._isYtdl = true;
    if (this.internal.isTokenExpired())
      await this.internal.requestToken();
  }
  async validate(query, type) {
    return [
      import_discord_player8.QueryType.SPOTIFY_ALBUM,
      import_discord_player8.QueryType.SPOTIFY_PLAYLIST,
      import_discord_player8.QueryType.SPOTIFY_SONG,
      import_discord_player8.QueryType.SPOTIFY_SEARCH,
      import_discord_player8.QueryType.AUTO,
      import_discord_player8.QueryType.AUTO_SEARCH
    ].some((t) => t === type);
  }
  async getRelatedTracks(track) {
    return await this.handle(track.author || track.title, {
      type: import_discord_player8.QueryType.SPOTIFY_SEARCH
    });
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player8.QueryType.AUTO:
      case import_discord_player8.QueryType.AUTO_SEARCH:
      case import_discord_player8.QueryType.SPOTIFY_SEARCH: {
        const data = await this.internal.search(query);
        if (!data)
          return this.createResponse();
        return this.createResponse(
          null,
          data.map((spotifyData) => {
            const track = new import_discord_player8.Track(this.context.player, {
              title: spotifyData.title,
              description: `${spotifyData.title} by ${spotifyData.artist}`,
              author: spotifyData.artist ?? "Unknown Artist",
              url: spotifyData.url,
              thumbnail: spotifyData.thumbnail || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(spotifyData.duration ?? 0)),
              views: 0,
              requestedBy: context.requestedBy,
              source: "spotify",
              queryType: import_discord_player8.QueryType.SPOTIFY_SONG
            });
            track.extractor = this;
            return track;
          })
        );
      }
      case import_discord_player8.QueryType.SPOTIFY_SONG: {
        const spotifyData = await this._lib.getData(query, context.requestOptions).catch(import_discord_player8.Util.noop);
        if (!spotifyData)
          return { playlist: null, tracks: [] };
        const spotifyTrack = new import_discord_player8.Track(this.context.player, {
          title: spotifyData.title,
          description: `${spotifyData.name} by ${spotifyData.artists.map((m) => m.name).join(", ")}`,
          author: spotifyData.artists[0]?.name ?? "Unknown Artist",
          url: spotifyData.id ? `https://open.spotify.com/track/${spotifyData.id}` : query,
          thumbnail: spotifyData.coverArt?.sources?.[0]?.url || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
          duration: import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(spotifyData.duration ?? spotifyData.maxDuration ?? 0)),
          views: 0,
          requestedBy: context.requestedBy,
          source: "spotify",
          queryType: context.type
        });
        spotifyTrack.extractor = this;
        return { playlist: null, tracks: [spotifyTrack] };
      }
      case import_discord_player8.QueryType.SPOTIFY_PLAYLIST: {
        try {
          const { queryType, id } = this.parse(query);
          if (queryType !== "playlist")
            throw "err";
          const spotifyPlaylist = await this.internal.getPlaylist(id);
          if (!spotifyPlaylist)
            throw "err";
          const playlist = new import_discord_player8.Playlist(this.context.player, {
            title: spotifyPlaylist.name,
            description: spotifyPlaylist.name ?? "",
            thumbnail: spotifyPlaylist.thumbnail ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: "playlist",
            source: "spotify",
            author: {
              name: spotifyPlaylist.author ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: spotifyPlaylist.id,
            url: spotifyPlaylist.url || query,
            rawPlaylist: spotifyPlaylist
          });
          playlist.tracks = spotifyPlaylist.tracks.map((spotifyData) => {
            const data = new import_discord_player8.Track(this.context.player, {
              title: spotifyData.title,
              description: `${spotifyData.title} by ${spotifyData.artist}`,
              author: spotifyData.artist ?? "Unknown Artist",
              url: spotifyData.url,
              thumbnail: spotifyData.thumbnail || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(spotifyData.duration ?? 0)),
              views: 0,
              requestedBy: context.requestedBy,
              source: "spotify",
              queryType: import_discord_player8.QueryType.SPOTIFY_SONG
            });
            data.extractor = this;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        } catch {
          const spotifyPlaylist = await this._lib.getData(query, context.requestOptions).catch(import_discord_player8.Util.noop);
          if (!spotifyPlaylist)
            return { playlist: null, tracks: [] };
          const playlist = new import_discord_player8.Playlist(this.context.player, {
            title: spotifyPlaylist.name ?? spotifyPlaylist.title,
            description: spotifyPlaylist.title ?? "",
            thumbnail: spotifyPlaylist.coverArt?.sources?.[0]?.url ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: spotifyPlaylist.type,
            source: "spotify",
            author: {
              name: spotifyPlaylist.subtitle ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: spotifyPlaylist.id,
            url: spotifyPlaylist.id ? `https://open.spotify.com/playlist/${spotifyPlaylist.id}` : query,
            rawPlaylist: spotifyPlaylist
          });
          playlist.tracks = spotifyPlaylist.trackList.map((m) => {
            const data = new import_discord_player8.Track(this.context.player, {
              title: m.title ?? "",
              description: m.title ?? "",
              author: m.subtitle ?? "Unknown Artist",
              url: m.uid ? `https://open.spotify.com/tracks/${m.uid}` : query,
              thumbnail: "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(m.duration)),
              views: 0,
              requestedBy: context.requestedBy,
              playlist,
              source: "spotify",
              queryType: "spotifySong"
            });
            data.extractor = this;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        }
      }
      case import_discord_player8.QueryType.SPOTIFY_ALBUM: {
        try {
          const { queryType, id } = this.parse(query);
          if (queryType !== "album")
            throw "err";
          const spotifyAlbum = await this.internal.getAlbum(id);
          if (!spotifyAlbum)
            throw "err";
          const playlist = new import_discord_player8.Playlist(this.context.player, {
            title: spotifyAlbum.name,
            description: spotifyAlbum.name ?? "",
            thumbnail: spotifyAlbum.thumbnail ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: "album",
            source: "spotify",
            author: {
              name: spotifyAlbum.author ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: spotifyAlbum.id,
            url: spotifyAlbum.url || query,
            rawPlaylist: spotifyAlbum
          });
          playlist.tracks = spotifyAlbum.tracks.map((spotifyData) => {
            const data = new import_discord_player8.Track(this.context.player, {
              title: spotifyData.title,
              description: `${spotifyData.title} by ${spotifyData.artist}`,
              author: spotifyData.artist ?? "Unknown Artist",
              url: spotifyData.url,
              thumbnail: spotifyData.thumbnail || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(spotifyData.duration ?? 0)),
              views: 0,
              requestedBy: context.requestedBy,
              source: "spotify",
              queryType: import_discord_player8.QueryType.SPOTIFY_SONG
            });
            data.extractor = this;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        } catch {
          const album = await this._lib.getData(query, context.requestOptions).catch(import_discord_player8.Util.noop);
          if (!album)
            return { playlist: null, tracks: [] };
          const playlist = new import_discord_player8.Playlist(this.context.player, {
            title: album.name ?? album.title,
            description: album.title ?? "",
            thumbnail: album.coverArt?.sources?.[0]?.url ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: album.type,
            source: "spotify",
            author: {
              name: album.subtitle ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: album.id,
            url: album.id ? `https://open.spotify.com/playlist/${album.id}` : query,
            rawPlaylist: album
          });
          playlist.tracks = album.trackList.map((m) => {
            const data = new import_discord_player8.Track(this.context.player, {
              title: m.title ?? "",
              description: m.title ?? "",
              author: m.subtitle ?? "Unknown Artist",
              url: m.uid ? `https://open.spotify.com/tracks/${m.uid}` : query,
              thumbnail: "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(m.duration)),
              views: 0,
              requestedBy: context.requestedBy,
              playlist,
              source: "spotify",
              queryType: "spotifySong"
            });
            data.extractor = this;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        }
      }
      default:
        return { playlist: null, tracks: [] };
    }
  }
  async stream(info) {
    if (!this._stream) {
      throw new Error(`Could not initialize streaming api for '${this.constructor.name}'`);
    }
    let url = info.url;
    if (this._isYtdl) {
      if (YoutubeExtractor.validateURL(info.raw.url))
        url = info.raw.url;
      else {
        const _url = await makeYTSearch(`${info.title} ${info.author}`, "video").then((r) => r[0].url).catch(import_discord_player8.Util.noop);
        if (!_url)
          throw new Error("Failed to fetch resources for ytdl streaming");
        info.raw.url = url = _url;
      }
    }
    return this._stream(url);
  }
  parse(q) {
    const [, queryType, id] = re.exec(q) || [];
    return { queryType, id };
  }
};
__name(SpotifyExtractor, "SpotifyExtractor");
SpotifyExtractor.identifier = "com.discord-player.spotifyextractor";

// src/index.ts
var version = "4.2.1";
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  AppleMusicExtractor,
  AttachmentExtractor,
  Internal,
  ReverbnationExtractor,
  SoundCloudExtractor,
  SpotifyExtractor,
  UA,
  VimeoExtractor,
  YouTubeExtractor,
  YouTubeLibs,
  YoutubeExtractor,
  createImport,
  getFetch,
  loadYtdl,
  lyricsExtractor,
  makeYTSearch,
  version
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL2luZGV4LnRzIiwgIi4uL3NyYy9leHRyYWN0b3JzL1NvdW5kQ2xvdWRFeHRyYWN0b3IudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvWW91dHViZUV4dHJhY3Rvci50cyIsICIuLi9zcmMvZXh0cmFjdG9ycy9jb21tb24vaGVscGVyLnRzIiwgIi4uL3NyYy9leHRyYWN0b3JzL0x5cmljc0V4dHJhY3Rvci50cyIsICIuLi9zcmMvZXh0cmFjdG9ycy9WaW1lb0V4dHJhY3Rvci50cyIsICIuLi9zcmMvaW50ZXJuYWwvVmltZW8udHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvUmV2ZXJibmF0aW9uRXh0cmFjdG9yLnRzIiwgIi4uL3NyYy9leHRyYWN0b3JzL0F0dGFjaG1lbnRFeHRyYWN0b3IudHMiLCAiLi4vc3JjL2ludGVybmFsL2Rvd25sb2FkZXIudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvQXBwbGVNdXNpY0V4dHJhY3Rvci50cyIsICIuLi9zcmMvaW50ZXJuYWwvaW5kZXgudHMiLCAiLi4vc3JjL2ludGVybmFsL0FwcGxlTXVzaWMudHMiLCAiLi4vc3JjL2ludGVybmFsL1Nwb3RpZnkudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvU3BvdGlmeUV4dHJhY3Rvci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiZXhwb3J0ICogZnJvbSAnLi9leHRyYWN0b3JzJztcbmV4cG9ydCAqIGFzIEludGVybmFsIGZyb20gJy4vaW50ZXJuYWwnO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWluZmVycmFibGUtdHlwZXNcbmV4cG9ydCBjb25zdCB2ZXJzaW9uOiBzdHJpbmcgPSAnNC4yLjEnO1xuIiwgIi8vIHByZXR0aWVyLWlnbm9yZVxuaW1wb3J0IHtcbiAgICBCYXNlRXh0cmFjdG9yLFxuICAgIEV4dHJhY3RvckluZm8sXG4gICAgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCxcbiAgICBQbGF5bGlzdCxcbiAgICBRdWVyeVR5cGUsXG4gICAgU2VhcmNoUXVlcnlUeXBlLFxuICAgIFRyYWNrLFxuICAgIFV0aWxcbn0gZnJvbSAnZGlzY29yZC1wbGF5ZXInO1xuaW1wb3J0IHsgQ2xpZW50LCBTb25nIH0gZnJvbSAnc291bmRjbG91ZC1zY3JhcGVyJztcblxuY29uc3Qgc291bmRjbG91ZCA9IG5ldyBDbGllbnQodW5kZWZpbmVkLCB7XG4gICAgZmV0Y2hBUElLZXk6IHRydWVcbn0pO1xuXG5leHBvcnQgY2xhc3MgU291bmRDbG91ZEV4dHJhY3RvciBleHRlbmRzIEJhc2VFeHRyYWN0b3Ige1xuICAgIHB1YmxpYyBzdGF0aWMgaWRlbnRpZmllciA9ICdjb20uZGlzY29yZC1wbGF5ZXIuc291bmRjbG91ZGV4dHJhY3RvcicgYXMgY29uc3Q7XG5cbiAgICBwdWJsaWMgYXN5bmMgdmFsaWRhdGUocXVlcnk6IHN0cmluZywgdHlwZT86IFNlYXJjaFF1ZXJ5VHlwZSB8IG51bGwgfCB1bmRlZmluZWQpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBxdWVyeSAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZTtcbiAgICAgICAgLy8gcHJldHRpZXItaWdub3JlXG4gICAgICAgIHJldHVybiAoW1xuICAgICAgICAgICAgUXVlcnlUeXBlLlNPVU5EQ0xPVUQsXG4gICAgICAgICAgICBRdWVyeVR5cGUuU09VTkRDTE9VRF9QTEFZTElTVCxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5TT1VORENMT1VEX1NFQVJDSCxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5TT1VORENMT1VEX1RSQUNLLFxuICAgICAgICAgICAgUXVlcnlUeXBlLkFVVE8sXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVVUT19TRUFSQ0hcbiAgICAgICAgXSBhcyBTZWFyY2hRdWVyeVR5cGVbXSkuc29tZSgocikgPT4gciA9PT0gdHlwZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGdldFJlbGF0ZWRUcmFja3ModHJhY2s6IFRyYWNrKSB7XG4gICAgICAgIGlmICh0cmFjay5xdWVyeVR5cGUgPT09IFF1ZXJ5VHlwZS5TT1VORENMT1VEX1RSQUNLKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlKHRyYWNrLmF1dGhvciB8fCB0cmFjay50aXRsZSwge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiB0cmFjay5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICB0eXBlOiBRdWVyeVR5cGUuU09VTkRDTE9VRF9TRUFSQ0hcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBFeHRyYWN0b3JTZWFyY2hDb250ZXh0KTogUHJvbWlzZTxFeHRyYWN0b3JJbmZvPiB7XG4gICAgICAgIHN3aXRjaCAoY29udGV4dC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5TT1VORENMT1VEX1RSQUNLOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tJbmZvID0gYXdhaXQgc291bmRjbG91ZFxuICAgICAgICAgICAgICAgICAgICAuZ2V0U29uZ0luZm8ocXVlcnksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZldGNoQ29tbWVudHM6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2hFbWJlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBmZXRjaFN0cmVhbVVSTDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goVXRpbC5ub29wKTtcblxuICAgICAgICAgICAgICAgIGlmICghdHJhY2tJbmZvKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0cmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0cmFja0luZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdHJhY2tJbmZvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVModHJhY2tJbmZvLmR1cmF0aW9uKSksXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0cmFja0luZm8uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdHJhY2tJbmZvLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHRyYWNrSW5mby5wbGF5Q291bnQsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLmF1dGhvci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc291bmRjbG91ZCcsXG4gICAgICAgICAgICAgICAgICAgIGVuZ2luZTogdHJhY2tJbmZvLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFt0cmFja10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLlNPVU5EQ0xPVURfUExBWUxJU1Q6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgc291bmRjbG91ZFxuICAgICAgICAgICAgICAgICAgICAuZ2V0UGxheWxpc3QocXVlcnksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZldGNoRW1iZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICAgICAgICAgIGlmICghZGF0YSkgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IG5ldyBQbGF5bGlzdCh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLnRodW1ibmFpbCA/PyAnaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS9wd2EtaWNvbi0xOTIucG5nJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYXlsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc291bmRjbG91ZCcsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZGF0YS5hdXRob3I/Lm5hbWUgPz8gZGF0YS5hdXRob3I/LnVzZXJuYW1lID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGRhdGEuYXV0aG9yPy5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgIGlkOiBgJHtkYXRhLmlkfWAsXG4gICAgICAgICAgICAgICAgICAgIHVybDogZGF0YS51cmwsXG4gICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBkYXRhXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHNvbmcgb2YgZGF0YS50cmFja3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNvbmcudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogc29uZy5kZXNjcmlwdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogc29uZy5hdXRob3I/LnVzZXJuYW1lID8/IHNvbmcuYXV0aG9yPy5uYW1lID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNvbmcudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzb25nLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHNvbmcuZHVyYXRpb24pKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiBzb25nLnBsYXlDb3VudCA/PyAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdDogcmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc291bmRjbG91ZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmdpbmU6IHNvbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgcmVzLnRyYWNrcy5wdXNoKHRyYWNrKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogcmVzLCB0cmFja3M6IHJlcy50cmFja3MgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFja3MgPSBhd2FpdCBzb3VuZGNsb3VkLnNlYXJjaChxdWVyeSwgJ3RyYWNrJykuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRyYWNrcyB8fCAhdHJhY2tzLmxlbmd0aCkgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzb2x2ZWRUcmFja3M6IFRyYWNrW10gPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc2VhcmNoZWRUcmFjayBvZiB0cmFja3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2tJbmZvID0gYXdhaXQgc291bmRjbG91ZFxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldFNvbmdJbmZvKHNlYXJjaGVkVHJhY2sudXJsLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2hTdHJlYW1VUkw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2hDb21tZW50czogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2hFbWJlZDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0cmFja0luZm8pIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0cmFja0luZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyh0cmFja0luZm8uZHVyYXRpb24pKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0cmFja0luZm8uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHRyYWNrSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3czogdHJhY2tJbmZvLnBsYXlDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLmF1dGhvci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzb3VuZGNsb3VkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZ2luZTogdHJhY2tJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAnc291bmRjbG91ZFRyYWNrJ1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmVkVHJhY2tzLnB1c2godHJhY2spO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IHJlc29sdmVkVHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZW1wdHlSZXNwb25zZSgpOiBFeHRyYWN0b3JJbmZvIHtcbiAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc3RyZWFtKGluZm86IFRyYWNrKSB7XG4gICAgICAgIGNvbnN0IGVuZ2luZSA9IGluZm8ucmF3LmVuZ2luZSBhcyBTb25nO1xuICAgICAgICBpZiAoZW5naW5lICYmIGVuZ2luZS5zdHJlYW1VUkwpIHtcbiAgICAgICAgICAgIHJldHVybiBlbmdpbmUuc3RyZWFtVVJMO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXJsID0gYXdhaXQgc291bmRjbG91ZC5mZXRjaFN0cmVhbVVSTChpbmZvLnVybCkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgaWYgKCF1cmwpIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGV4dHJhY3Qgc3RyZWFtIGZyb20gdGhpcyB0cmFjayBzb3VyY2UnKTtcblxuICAgICAgICBpZiAoZW5naW5lKSB7XG4gICAgICAgICAgICBlbmdpbmUuc3RyZWFtVVJMID0gdXJsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5mby5yYXcuZW5naW5lID0ge1xuICAgICAgICAgICAgICAgIHN0cmVhbVVSTDogdXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgVmlkZW8sIFlvdVR1YmUgfSBmcm9tICd5b3V0dWJlLXNyJztcblxuLy8gcHJldHRpZXItaWdub3JlXG5pbXBvcnQge1xuICAgIEJhc2VFeHRyYWN0b3IsXG4gICAgRXh0cmFjdG9ySW5mbyxcbiAgICBFeHRyYWN0b3JTZWFyY2hDb250ZXh0LFxuICAgIFBsYXlsaXN0LFxuICAgIFF1ZXJ5VHlwZSxcbiAgICBTZWFyY2hRdWVyeVR5cGUsXG4gICAgVHJhY2ssXG4gICAgVXRpbFxufSBmcm9tICdkaXNjb3JkLXBsYXllcic7XG5cbmltcG9ydCB7IFN0cmVhbUZOLCBZb3VUdWJlTGlicywgbG9hZFl0ZGwsIG1ha2VZVFNlYXJjaCB9IGZyb20gJy4vY29tbW9uL2hlbHBlcic7XG5pbXBvcnQgdHlwZSB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJztcblxuLy8gdGFrZW4gZnJvbSB5dGRsLWNvcmVcbmNvbnN0IHZhbGlkUXVlcnlEb21haW5zID0gbmV3IFNldChbJ3lvdXR1YmUuY29tJywgJ3d3dy55b3V0dWJlLmNvbScsICdtLnlvdXR1YmUuY29tJywgJ211c2ljLnlvdXR1YmUuY29tJywgJ2dhbWluZy55b3V0dWJlLmNvbSddKTtcbmNvbnN0IHZhbGlkUGF0aERvbWFpbnMgPSAvXmh0dHBzPzpcXC9cXC8oeW91dHVcXC5iZVxcL3wod3d3XFwuKT95b3V0dWJlXFwuY29tXFwvKGVtYmVkfHZ8c2hvcnRzKVxcLykvO1xuY29uc3QgaWRSZWdleCA9IC9eW2EtekEtWjAtOS1fXXsxMX0kLztcblxuZXhwb3J0IGludGVyZmFjZSBZb3V0dWJlRXh0cmFjdG9ySW5pdCB7XG4gICAgY3JlYXRlU3RyZWFtPzogKGV4dDogWW91dHViZUV4dHJhY3RvciwgdXJsOiBzdHJpbmcpID0+IFByb21pc2U8UmVhZGFibGUgfCBzdHJpbmc+O1xufVxuXG5leHBvcnQgY2xhc3MgWW91dHViZUV4dHJhY3RvciBleHRlbmRzIEJhc2VFeHRyYWN0b3I8WW91dHViZUV4dHJhY3RvckluaXQ+IHtcbiAgICBwdWJsaWMgc3RhdGljIGlkZW50aWZpZXIgPSAnY29tLmRpc2NvcmQtcGxheWVyLnlvdXR1YmVleHRyYWN0b3InIGFzIGNvbnN0O1xuICAgIHByaXZhdGUgX3N0cmVhbSE6IFN0cmVhbUZOO1xuICAgIHB1YmxpYyBfeXRMaWJOYW1lITogc3RyaW5nO1xuXG4gICAgcHVibGljIGFzeW5jIGFjdGl2YXRlKCkge1xuICAgICAgICBjb25zdCBmbiA9IHRoaXMub3B0aW9ucy5jcmVhdGVTdHJlYW07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5fc3RyZWFtID0gKHE6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbih0aGlzLCBxKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgc3RyZWFtLCBuYW1lIH0gPSBhd2FpdCBsb2FkWXRkbCh0aGlzLmNvbnRleHQucGxheWVyLm9wdGlvbnMueXRkbE9wdGlvbnMpO1xuICAgICAgICB0aGlzLl9zdHJlYW0gPSBzdHJlYW07XG4gICAgICAgIHRoaXMuX3l0TGliTmFtZSA9IG5hbWU7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHZhbGlkYXRlKHF1ZXJ5OiBzdHJpbmcsIHR5cGU/OiBTZWFyY2hRdWVyeVR5cGUgfCBudWxsIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGlmICh0eXBlb2YgcXVlcnkgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgICAgICByZXR1cm4gKFtcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5ZT1VUVUJFLFxuICAgICAgICAgICAgUXVlcnlUeXBlLllPVVRVQkVfUExBWUxJU1QsXG4gICAgICAgICAgICBRdWVyeVR5cGUuWU9VVFVCRV9TRUFSQ0gsXG4gICAgICAgICAgICBRdWVyeVR5cGUuWU9VVFVCRV9WSURFTyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPLFxuICAgICAgICAgICAgUXVlcnlUeXBlLkFVVE9fU0VBUkNIXG4gICAgICAgIF0gYXMgU2VhcmNoUXVlcnlUeXBlW10pLnNvbWUoKHIpID0+IHIgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBoYW5kbGUocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCk6IFByb21pc2U8RXh0cmFjdG9ySW5mbz4ge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmluY2x1ZGVzKCd5b3V0dWJlLmNvbScpID8gcXVlcnkucmVwbGFjZSgvKG0odXNpYyk/fGdhbWluZylcXC4vLCAnJykgOiBxdWVyeTtcbiAgICAgICAgaWYgKFlvdXR1YmVFeHRyYWN0b3IudmFsaWRhdGVVUkwocXVlcnkpKSBjb250ZXh0LnR5cGUgPSBRdWVyeVR5cGUuWU9VVFVCRV9WSURFTztcblxuICAgICAgICBzd2l0Y2ggKGNvbnRleHQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuWU9VVFVCRV9QTEFZTElTVDoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHl0cGwgPSBhd2FpdCBZb3VUdWJlLmdldFBsYXlsaXN0KHF1ZXJ5LCB7XG4gICAgICAgICAgICAgICAgICAgIGZldGNoQWxsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0T3B0aW9uczogY29udGV4dC5yZXF1ZXN0T3B0aW9ucyBhcyB1bmtub3duIGFzIFJlcXVlc3RJbml0XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgICAgICAgICBpZiAoIXl0cGwpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHl0cGwudGl0bGUhLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHl0cGwudGh1bWJuYWlsIGFzIHVua25vd24gYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogeXRwbC50aXRsZSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYXlsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAneW91dHViZScsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogeXRwbC5jaGFubmVsIS5uYW1lIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogeXRwbC5jaGFubmVsIS51cmwgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgIGlkOiB5dHBsLmlkIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB5dHBsLnVybCBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiB5dHBsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSB5dHBsLnZpZGVvcy5tYXAoKHZpZGVvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB2aWRlby50aXRsZSBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdmlkZW8uZGVzY3JpcHRpb24gYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB2aWRlby5jaGFubmVsPy5uYW1lIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdmlkZW8udXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHZpZGVvLnRodW1ibmFpbCEudXJsIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiB2aWRlby52aWV3cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB2aWRlby5kdXJhdGlvbkZvcm1hdHRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdzogdmlkZW8sXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdDogcGxheWxpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICd5b3V0dWJlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogJ3lvdXR1YmVWaWRlbydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3QsIHRyYWNrczogcGxheWxpc3QudHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5ZT1VUVUJFX1ZJREVPOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSAvW2EtekEtWjAtOS1fXXsxMX0vLmV4ZWMocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghaWQ/LlswXSkgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZGVvID0gYXdhaXQgWW91VHViZS5nZXRWaWRlbyhgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke2lkfWAsIGNvbnRleHQucmVxdWVzdE9wdGlvbnMgYXMgdW5rbm93biBhcyBSZXF1ZXN0SW5pdCkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZpZGVvKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICAgICAgICAgICAgdmlkZW8uc291cmNlID0gJ3lvdXR1YmUnO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdmlkZW8udGl0bGUhLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdmlkZW8uZGVzY3JpcHRpb24hLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHZpZGVvLmNoYW5uZWw/Lm5hbWUgYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHZpZGVvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdmlkZW8udGh1bWJuYWlsPy5kaXNwbGF5VGh1bWJuYWlsVVJMKCdtYXhyZXNkZWZhdWx0JykgYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czogdmlkZW8udmlld3MsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB2aWRlby5kdXJhdGlvbkZvcm1hdHRlZCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAneW91dHViZScsXG4gICAgICAgICAgICAgICAgICAgIHJhdzogdmlkZW8sXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGxheWxpc3Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrczogW3RyYWNrXVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tzID0gYXdhaXQgdGhpcy5fbWFrZVlUU2VhcmNoKHF1ZXJ5LCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9tYWtlWVRTZWFyY2gocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCkge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBtYWtlWVRTZWFyY2gocXVlcnksIGNvbnRleHQucmVxdWVzdE9wdGlvbnMpLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgIGlmICghcmVzIHx8ICFyZXMubGVuZ3RoKSByZXR1cm4gW107XG5cbiAgICAgICAgcmV0dXJuIHJlcy5tYXAoKHZpZGVvKSA9PiB7XG4gICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICAgICAgICB2aWRlby5zb3VyY2UgPSAneW91dHViZSc7XG5cbiAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogdmlkZW8udGl0bGUhLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB2aWRlby5kZXNjcmlwdGlvbiEsXG4gICAgICAgICAgICAgICAgYXV0aG9yOiB2aWRlby5jaGFubmVsPy5uYW1lIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICB1cmw6IHZpZGVvLnVybCxcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHZpZGVvLnRodW1ibmFpbD8uZGlzcGxheVRodW1ibmFpbFVSTCgnbWF4cmVzZGVmYXVsdCcpIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICB2aWV3czogdmlkZW8udmlld3MsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IHZpZGVvLmR1cmF0aW9uRm9ybWF0dGVkLFxuICAgICAgICAgICAgICAgIHNvdXJjZTogJ3lvdXR1YmUnLFxuICAgICAgICAgICAgICAgIHJhdzogdmlkZW8sXG4gICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBjb250ZXh0LnR5cGUhXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRyYWNrO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0UmVsYXRlZFRyYWNrcyh0cmFjazogVHJhY2spIHtcbiAgICAgICAgbGV0IGluZm86IFZpZGVvW10gfCB2b2lkO1xuXG4gICAgICAgIGlmIChZb3V0dWJlRXh0cmFjdG9yLnZhbGlkYXRlVVJMKHRyYWNrLnVybCkpXG4gICAgICAgICAgICBpbmZvID0gYXdhaXQgWW91VHViZS5nZXRWaWRlbyh0cmFjay51cmwpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHgpID0+IHgudmlkZW9zKVxuICAgICAgICAgICAgICAgIC5jYXRjaChVdGlsLm5vb3ApO1xuXG4gICAgICAgIC8vIGZhbGxiYWNrXG4gICAgICAgIGlmICghaW5mbylcbiAgICAgICAgICAgIGluZm8gPSBhd2FpdCBZb3VUdWJlLnNlYXJjaCh0cmFjay5hdXRob3IgfHwgdHJhY2sudGl0bGUsIHsgbGltaXQ6IDUsIHR5cGU6ICd2aWRlbycgfSlcbiAgICAgICAgICAgICAgICAudGhlbigoeCkgPT4geClcbiAgICAgICAgICAgICAgICAuY2F0Y2goVXRpbC5ub29wKTtcblxuICAgICAgICBpZiAoIWluZm8/Lmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNpbWlsYXIgPSBpbmZvLm1hcCgodmlkZW8pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiB2aWRlby50aXRsZSEsXG4gICAgICAgICAgICAgICAgdXJsOiBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke3ZpZGVvLmlkfWAsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IHZpZGVvLmR1cmF0aW9uRm9ybWF0dGVkIHx8IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVModmlkZW8uZHVyYXRpb24gKiAxMDAwKSksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHZpZGVvLnRpdGxlISxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHR5cGVvZiB2aWRlby50aHVtYm5haWwgPT09ICdzdHJpbmcnID8gdmlkZW8udGh1bWJuYWlsISA6IHZpZGVvLnRodW1ibmFpbCEudXJsISxcbiAgICAgICAgICAgICAgICB2aWV3czogdmlkZW8udmlld3MsXG4gICAgICAgICAgICAgICAgYXV0aG9yOiB2aWRlby5jaGFubmVsIS5uYW1lISxcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogdHJhY2sucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgc291cmNlOiAneW91dHViZScsXG4gICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAneW91dHViZVZpZGVvJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHQuZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKG51bGwsIHNpbWlsYXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBlbXB0eVJlc3BvbnNlKCk6IEV4dHJhY3RvckluZm8ge1xuICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzdHJlYW0oaW5mbzogVHJhY2spIHtcbiAgICAgICAgaWYgKCF0aGlzLl9zdHJlYW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgeW91dHViZSBzdHJlYW1pbmcgbGlicmFyeS4gSW5zdGFsbCBvbmUgb2YgJHtZb3VUdWJlTGlicy5qb2luKCcsICcpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVybCA9IGluZm8udXJsO1xuICAgICAgICB1cmwgPSB1cmwuaW5jbHVkZXMoJ3lvdXR1YmUuY29tJykgPyB1cmwucmVwbGFjZSgvKG0odXNpYyk/fGdhbWluZylcXC4vLCAnJykgOiB1cmw7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cmVhbSh1cmwpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgdmFsaWRhdGVVUkwobGluazogc3RyaW5nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBZb3V0dWJlRXh0cmFjdG9yLnBhcnNlVVJMKGxpbmspO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyB2YWxpZGF0ZUlkKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGlkUmVnZXgudGVzdChpZC50cmltKCkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgcGFyc2VVUkwobGluazogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IG5ldyBVUkwobGluay50cmltKCkpO1xuICAgICAgICBsZXQgaWQgPSBwYXJzZWQuc2VhcmNoUGFyYW1zLmdldCgndicpO1xuICAgICAgICBpZiAodmFsaWRQYXRoRG9tYWlucy50ZXN0KGxpbmsudHJpbSgpKSAmJiAhaWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhdGhzID0gcGFyc2VkLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICBpZCA9IHBhcnNlZC5ob3N0ID09PSAneW91dHUuYmUnID8gcGF0aHNbMV0gOiBwYXRoc1syXTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXJzZWQuaG9zdG5hbWUgJiYgIXZhbGlkUXVlcnlEb21haW5zLmhhcyhwYXJzZWQuaG9zdG5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignTm90IGEgWW91VHViZSBkb21haW4nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlkKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgTm8gdmlkZW8gaWQgZm91bmQ6IFwiJHtsaW5rfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWQgPSBpZC5zdWJzdHJpbmcoMCwgMTEpO1xuICAgICAgICBpZiAoIWV4cG9ydHMudmFsaWRhdGVJRChpZCkpIHtcbiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcihgVmlkZW8gaWQgKCR7aWR9KSBkb2VzIG5vdCBtYXRjaCBleHBlY3RlZCBgICsgYGZvcm1hdCAoJHtpZFJlZ2V4LnRvU3RyaW5nKCl9KWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpZDtcbiAgICB9XG59XG5cbmV4cG9ydCB7IFlvdXR1YmVFeHRyYWN0b3IgYXMgWW91VHViZUV4dHJhY3RvciB9O1xuIiwgImltcG9ydCB7IFlvdVR1YmUgfSBmcm9tICd5b3V0dWJlLXNyJztcblxubGV0IGZhY3Rvcnk6IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgc3RyZWFtOiBTdHJlYW1GTjtcbiAgICBsaWI6IHN0cmluZztcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVJbXBvcnQgPSAobGliOiBzdHJpbmcpID0+IGltcG9ydChsaWIpLmNhdGNoKCgpID0+IG51bGwpO1xuZXhwb3J0IGNvbnN0IFVBID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDkuMC4wLjAgU2FmYXJpLzUzNy4zNiBFZGcvMTA5LjAuMTUxOC40OSc7XG5cbmV4cG9ydCBjb25zdCBZb3VUdWJlTGlicyA9IFtcbiAgICAneXRkbC1jb3JlJyxcbiAgICAnQGRpc3R1YmUveXRkbC1jb3JlJyxcbiAgICAncGxheS1kbCdcbiAgICAvLyBhZGQgbW9yZSB0byB0aGUgbGlzdCBpZiB5b3UgaGF2ZSBhbnlcbl07XG5cbi8vIGZvcmNlZCBsaWJcbmNvbnN0IGZvcmNlZExpYiA9IHByb2Nlc3MuZW52LkRQX0ZPUkNFX1lURExfTU9EO1xuaWYgKGZvcmNlZExpYikgWW91VHViZUxpYnMudW5zaGlmdChmb3JjZWRMaWIpO1xuXG5leHBvcnQgY29uc3QgZ2V0RmV0Y2ggPVxuICAgIHR5cGVvZiBmZXRjaCAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBmZXRjaFxuICAgICAgICA6IGFzeW5jIChpbmZvOiBSZXF1ZXN0SW5mbywgaW5pdD86IFJlcXVlc3RJbml0KTogUHJvbWlzZTxSZXNwb25zZT4gPT4ge1xuICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgICAgICAgbGV0IGR5OiBhbnk7XG5cbiAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tY29uZC1hc3NpZ24gKi9cbiAgICAgICAgICAgICAgaWYgKChkeSA9IGF3YWl0IGNyZWF0ZUltcG9ydCgndW5kaWNpJykpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gKGR5LmZldGNoIHx8IGR5LmRlZmF1bHQuZmV0Y2gpKGluZm8sIGluaXQpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKChkeSA9IGF3YWl0IGNyZWF0ZUltcG9ydCgnbm9kZS1mZXRjaCcpKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIChkeS5mZXRjaCB8fCBkeS5kZWZhdWx0KShpbmZvLCBpbml0KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZmV0Y2ggbGliIGZvdW5kJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLWNvbmQtYXNzaWduICovXG4gICAgICAgICAgfTtcblxuZXhwb3J0IHR5cGUgU3RyZWFtRk4gPSAocTogc3RyaW5nKSA9PiBQcm9taXNlPGltcG9ydCgnc3RyZWFtJykuUmVhZGFibGUgfCBzdHJpbmc+O1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRZdGRsKG9wdGlvbnM/OiBhbnksIGZvcmNlID0gZmFsc2UpIHtcbiAgICBpZiAoZmFjdG9yeSAmJiAhZm9yY2UpIHJldHVybiBmYWN0b3J5O1xuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBsZXQgbGliOiBhbnksIF95dExpYk5hbWU6IHN0cmluZywgX3N0cmVhbTogU3RyZWFtRk47XG5cbiAgICBmb3IgKGNvbnN0IHl0bGliIG9mIFlvdVR1YmVMaWJzKSB7XG4gICAgICAgIGxpYiA9IGF3YWl0IGltcG9ydCh5dGxpYikudGhlbihcbiAgICAgICAgICAgIChtKSA9PiBtLFxuICAgICAgICAgICAgKCkgPT4gbnVsbFxuICAgICAgICApO1xuICAgICAgICBpZiAoIWxpYikgY29udGludWU7XG4gICAgICAgIGxpYiA9IGxpYi5kZWZhdWx0IHx8IGxpYjtcbiAgICAgICAgX3l0TGliTmFtZSA9IHl0bGliO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAobGliKSB7XG4gICAgICAgIGNvbnN0IGlzWXRkbCA9IFsneXRkbC1jb3JlJywgJ0BkaXN0dWJlL3l0ZGwtY29yZSddLnNvbWUoKGxpYikgPT4gbGliID09PSBfeXRMaWJOYW1lKTtcblxuICAgICAgICBfc3RyZWFtID0gYXN5bmMgKHF1ZXJ5KSA9PiB7XG4gICAgICAgICAgICBpZiAoaXNZdGRsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGwgPSBsaWIgYXMgdHlwZW9mIGltcG9ydCgneXRkbC1jb3JlJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IGRsLmdldEluZm8ocXVlcnksIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0cyA9IGluZm8uZm9ybWF0c1xuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKChmb3JtYXQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbmZvLnZpZGVvRGV0YWlscy5pc0xpdmVDb250ZW50ID8gZm9ybWF0LmlzSExTICYmIGZvcm1hdC5oYXNBdWRpbyA6IGZvcm1hdC5oYXNBdWRpbztcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IE51bWJlcihiLmF1ZGlvQml0cmF0ZSkgLSBOdW1iZXIoYS5hdWRpb0JpdHJhdGUpIHx8IE51bWJlcihhLmJpdHJhdGUpIC0gTnVtYmVyKGIuYml0cmF0ZSkpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZm10ID0gZm9ybWF0cy5maW5kKChmb3JtYXQpID0+ICFmb3JtYXQuaGFzVmlkZW8pIHx8IGZvcm1hdHMuc29ydCgoYSwgYikgPT4gTnVtYmVyKGEuYml0cmF0ZSkgLSBOdW1iZXIoYi5iaXRyYXRlKSlbMF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZtdC51cmw7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIGRsKHF1ZXJ5LCB0aGlzLmNvbnRleHQucGxheWVyLm9wdGlvbnMueXRkbE9wdGlvbnMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkbCA9IGxpYiBhcyB0eXBlb2YgaW1wb3J0KCdwbGF5LWRsJyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBpbmZvID0gYXdhaXQgZGwudmlkZW9faW5mbyhxdWVyeSk7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0cyA9IGluZm8uZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmUgPSAvXFwvbWFuaWZlc3RcXC9obHNfKHZhcmlhbnR8cGxheWxpc3QpXFwvLztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZm9ybWF0LnVybCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8udmlkZW9fZGV0YWlscy5saXZlKSByZXR1cm4gcmUudGVzdChmb3JtYXQudXJsKSAmJiB0eXBlb2YgZm9ybWF0LmJpdHJhdGUgPT09ICdudW1iZXInO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBmb3JtYXQuYml0cmF0ZSA9PT0gJ251bWJlcic7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBOdW1iZXIoYi5iaXRyYXRlKSAtIE51bWJlcihhLmJpdHJhdGUpKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGZtdCA9IGZvcm1hdHMuZmluZCgoZm9ybWF0KSA9PiAhZm9ybWF0LnF1YWxpdHlMYWJlbCkgfHwgZm9ybWF0cy5zb3J0KChhLCBiKSA9PiBOdW1iZXIoYS5iaXRyYXRlKSAtIE51bWJlcihiLmJpdHJhdGUpKVswXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm10LnVybCE7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIChhd2FpdCBkbC5zdHJlYW0ocXVlcnksIHsgZGlzY29yZFBsYXllckNvbXBhdGliaWxpdHk6IHRydWUgfSkpLnN0cmVhbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBsb2FkIHlvdXR1YmUgbGlicmFyeS4gSW5zdGFsbCBvbmUgb2YgJHtZb3VUdWJlTGlicy5tYXAoKGxpYikgPT4gYFwiJHtsaWJ9XCJgKS5qb2luKCcsICcpfWApO1xuICAgIH1cblxuICAgIGZhY3RvcnkgPSB7IG5hbWU6IF95dExpYk5hbWUhLCBzdHJlYW06IF9zdHJlYW0sIGxpYiB9O1xuICAgIHJldHVybiBmYWN0b3J5O1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1ha2VZVFNlYXJjaChxdWVyeTogc3RyaW5nLCBvcHQ6IGFueSkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IFlvdVR1YmUuc2VhcmNoKHF1ZXJ5LCB7XG4gICAgICAgIHR5cGU6ICd2aWRlbycsXG4gICAgICAgIHJlcXVlc3RPcHRpb25zOiBvcHRcbiAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgIC8vXG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzIHx8IFtdO1xufVxuIiwgImltcG9ydCB7IENsaWVudCBhcyBHZW5pdXNDbGllbnQgfSBmcm9tICdnZW5pdXMtbHlyaWNzJztcblxuLy8gbGF6eSBsb2FkIGNsaWVudFxubGV0IGNsaWVudDogR2VuaXVzQ2xpZW50O1xuXG5leHBvcnQgZnVuY3Rpb24gbHlyaWNzRXh0cmFjdG9yKGFwaUtleT86IHN0cmluZywgZm9yY2U/OiBib29sZWFuKSB7XG4gICAgaWYgKCFjbGllbnQgJiYgIWZvcmNlKSBjbGllbnQgPSBuZXcgR2VuaXVzQ2xpZW50KGFwaUtleSk7XG4gICAgcmV0dXJuIHsgc2VhcmNoLCBjbGllbnQgfTtcbn1cblxuZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8THlyaWNzRGF0YSB8IG51bGw+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBxdWVyeSAhPT0gJ3N0cmluZycpIHJldHVybiByZWplY3QobmV3IFR5cGVFcnJvcihgRXhwZWN0ZWQgc2VhcmNoIHF1ZXJ5IHRvIGJlIGEgc3RyaW5nLCByZWNlaXZlZCBcIiR7dHlwZW9mIHF1ZXJ5fVwiIWApKTtcblxuICAgICAgICBjbGllbnQuc29uZ3NcbiAgICAgICAgICAgIC5zZWFyY2gocXVlcnkpXG4gICAgICAgICAgICAudGhlbihhc3luYyAoc29uZ3MpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogc29uZ3NbMF0udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGZ1bGxUaXRsZTogc29uZ3NbMF0uZnVsbFRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBpZDogc29uZ3NbMF0uaWQsXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc29uZ3NbMF0udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICBpbWFnZTogc29uZ3NbMF0uaW1hZ2UsXG4gICAgICAgICAgICAgICAgICAgIHVybDogc29uZ3NbMF0udXJsLFxuICAgICAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNvbmdzWzBdLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNvbmdzWzBdLmFydGlzdC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc29uZ3NbMF0uYXJ0aXN0LnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBzb25nc1swXS5hcnRpc3QuaW1hZ2VcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbHlyaWNzOiBhd2FpdCBzb25nc1swXS5seXJpY3MoZmFsc2UpXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UgbHlyaWNzJykpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTHlyaWNzRGF0YSB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBmdWxsVGl0bGU6IHN0cmluZztcbiAgICBpZDogbnVtYmVyO1xuICAgIHRodW1ibmFpbDogc3RyaW5nO1xuICAgIGltYWdlOiBzdHJpbmc7XG4gICAgdXJsOiBzdHJpbmc7XG4gICAgYXJ0aXN0OiB7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgICAgaWQ6IG51bWJlcjtcbiAgICAgICAgdXJsOiBzdHJpbmc7XG4gICAgICAgIGltYWdlOiBzdHJpbmc7XG4gICAgfTtcbiAgICBseXJpY3M6IHN0cmluZztcbn1cbiIsICIvLyBwcmV0dGllci1pZ25vcmVcbmltcG9ydCB7XG4gICAgQmFzZUV4dHJhY3RvcixcbiAgICBFeHRyYWN0b3JJbmZvLFxuICAgIEV4dHJhY3RvclNlYXJjaENvbnRleHQsXG4gICAgUXVlcnlUeXBlLFxuICAgIFNlYXJjaFF1ZXJ5VHlwZSxcbiAgICBUcmFjayxcbiAgICBVdGlsXG59IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB7IFZpbWVvIH0gZnJvbSAnLi4vaW50ZXJuYWwvVmltZW8nO1xuXG5leHBvcnQgY2xhc3MgVmltZW9FeHRyYWN0b3IgZXh0ZW5kcyBCYXNlRXh0cmFjdG9yIHtcbiAgICBwdWJsaWMgc3RhdGljIGlkZW50aWZpZXIgPSAnY29tLmRpc2NvcmQtcGxheWVyLnZpbWVvZXh0cmFjdG9yJyBhcyBjb25zdDtcblxuICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZShxdWVyeTogc3RyaW5nLCB0eXBlPzogU2VhcmNoUXVlcnlUeXBlIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKFtRdWVyeVR5cGUuVklNRU9dIGFzIFNlYXJjaFF1ZXJ5VHlwZVtdKS5zb21lKChyKSA9PiByID09PSB0eXBlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0UmVsYXRlZFRyYWNrcyh0cmFjazogVHJhY2spIHtcbiAgICAgICAgdm9pZCB0cmFjaztcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgaGFuZGxlKHF1ZXJ5OiBzdHJpbmcsIGNvbnRleHQ6IEV4dHJhY3RvclNlYXJjaENvbnRleHQpOiBQcm9taXNlPEV4dHJhY3RvckluZm8+IHtcbiAgICAgICAgc3dpdGNoIChjb250ZXh0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLlZJTUVPOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tJbmZvID0gYXdhaXQgVmltZW8uZ2V0SW5mbyhcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnLycpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh4KSA9PiAhIXgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9wKCkhXG4gICAgICAgICAgICAgICAgKS5jYXRjaChVdGlsLm5vb3ApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0cmFja0luZm8pIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRyYWNrSW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0cmFja0luZm8udXJsLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyh0cmFja0luZm8uZHVyYXRpb24gfHwgMCkpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7dHJhY2tJbmZvLnRpdGxlfSBieSAke3RyYWNrSW5mby5hdXRob3IubmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHRyYWNrSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHRyYWNrSW5mby5hdXRob3IubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ2FyYml0cmFyeScsXG4gICAgICAgICAgICAgICAgICAgIGVuZ2luZTogdHJhY2tJbmZvLnN0cmVhbSxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBjb250ZXh0LnR5cGVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbdHJhY2tdIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBlbXB0eVJlc3BvbnNlKCk6IEV4dHJhY3RvckluZm8ge1xuICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzdHJlYW0oaW5mbzogVHJhY2spIHtcbiAgICAgICAgY29uc3QgZW5naW5lID0gaW5mby5yYXcuZW5naW5lIGFzIHN0cmluZztcbiAgICAgICAgaWYgKGVuZ2luZSkge1xuICAgICAgICAgICAgcmV0dXJuIGVuZ2luZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRyYWNrID0gYXdhaXQgVmltZW8uZ2V0SW5mbyhpbmZvLnVybCkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgaWYgKCF0cmFjayB8fCAhdHJhY2suc3RyZWFtKSB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBleHRyYWN0IHN0cmVhbSBmcm9tIHRoaXMgc291cmNlJyk7XG5cbiAgICAgICAgaW5mby5yYXcuZW5naW5lID0ge1xuICAgICAgICAgICAgc3RyZWFtVVJMOiB0cmFjay5zdHJlYW1cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdHJhY2suc3RyZWFtO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJztcbmltcG9ydCBodHRwcyBmcm9tICdodHRwcyc7XG5pbXBvcnQgeyBnZXRGZXRjaCB9IGZyb20gJy4uL2V4dHJhY3RvcnMvY29tbW9uL2hlbHBlcic7XG5cbmNsYXNzIFZpbWVvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9IGNsYXNzIG1heSBub3QgYmUgaW5zdGFudGlhdGVkIWApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEB0eXBlZGVmIHtSZWFkYWJsZX0gUmVhZGFibGVcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIERvd25sb2FkcyBmcm9tIHZpbWVvXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGlkIFZpbWVvIHZpZGVvIGlkXG4gICAgICogQHJldHVybnMge1Byb21pc2U8UmVhZGFibGU+fVxuICAgICAqL1xuICAgIHN0YXRpYyBkb3dubG9hZChpZDogbnVtYmVyIHwgc3RyaW5nKTogUHJvbWlzZTxSZWFkYWJsZT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBWaW1lby5nZXRJbmZvKGlkKTtcbiAgICAgICAgICAgIGlmICghaW5mbykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IGRvd25sb2FkZXIgPSBpbmZvLnN0cmVhbS5zdGFydHNXaXRoKCdodHRwczovLycpID8gaHR0cHMgOiBodHRwO1xuXG4gICAgICAgICAgICBkb3dubG9hZGVyLmdldChpbmZvLnN0cmVhbSwgKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHZpZGVvIGluZm9cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaWQgVmlkZW8gaWRcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZ2V0SW5mbyhpZDogbnVtYmVyIHwgc3RyaW5nKTogUHJvbWlzZTxWaW1lb0luZm8gfCBudWxsPiB7XG4gICAgICAgIGlmICghaWQpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpZCcpO1xuICAgICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL3ZpZGVvLyR7aWR9YDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0RmV0Y2godXJsKTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMudGV4dCgpO1xuICAgICAgICAgICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UoZGF0YS5zcGxpdCgnd2luZG93LnBsYXllckNvbmZpZyA9JylbMV0uc3BsaXQoJzsnKVswXS50cmltKCkpO1xuXG4gICAgICAgICAgICBjb25zdCBvYmogPSB7XG4gICAgICAgICAgICAgICAgaWQ6IGpzb24udmlkZW8uaWQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGpzb24udmlkZW8uZHVyYXRpb24gKiAxMDAwLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBqc29uLnZpZGVvLnRpdGxlLFxuICAgICAgICAgICAgICAgIHVybDoganNvbi52aWRlby51cmwsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBqc29uLnZpZGVvLnRodW1ic1snMTI4MCddIHx8IGpzb24udmlkZW8udGh1bWJzLmJhc2UsXG4gICAgICAgICAgICAgICAgc3RyZWFtOiBqc29uLnJlcXVlc3QuZmlsZXMucHJvZ3Jlc3NpdmVbMF0udXJsLFxuICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICBpZDoganNvbi52aWRlby5vd25lci5pZCxcbiAgICAgICAgICAgICAgICAgICAgbmFtZToganNvbi52aWRlby5vd25lci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IGpzb24udmlkZW8ub3duZXIudXJsLFxuICAgICAgICAgICAgICAgICAgICBhdmF0YXI6IGpzb24udmlkZW8ub3duZXIuaW1nXzJ4IHx8IGpzb24udmlkZW8ub3duZXIuaW1nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBWaW1lb0luZm8ge1xuICAgIGlkOiBudW1iZXI7XG4gICAgZHVyYXRpb246IG51bWJlcjtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHVybDogc3RyaW5nO1xuICAgIHRodW1ibmFpbDogc3RyaW5nO1xuICAgIHN0cmVhbTogc3RyaW5nO1xuICAgIGF1dGhvcjoge1xuICAgICAgICBpZDogbnVtYmVyO1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIHVybDogc3RyaW5nO1xuICAgICAgICBhdmF0YXI6IHN0cmluZztcbiAgICB9O1xufVxuXG5leHBvcnQgeyBWaW1lbyB9O1xuIiwgIi8vIHByZXR0aWVyLWlnbm9yZVxuaW1wb3J0IHtcbiAgICBCYXNlRXh0cmFjdG9yLFxuICAgIEV4dHJhY3RvckluZm8sXG4gICAgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCxcbiAgICBRdWVyeVR5cGUsXG4gICAgU2VhcmNoUXVlcnlUeXBlLFxuICAgIFRyYWNrLFxuICAgIFV0aWxcbn0gZnJvbSAnZGlzY29yZC1wbGF5ZXInO1xuaW1wb3J0IHJldmVyYm5hdGlvbiBmcm9tICdyZXZlcmJuYXRpb24tc2NyYXBlcic7XG5cbmV4cG9ydCBjbGFzcyBSZXZlcmJuYXRpb25FeHRyYWN0b3IgZXh0ZW5kcyBCYXNlRXh0cmFjdG9yIHtcbiAgICBwdWJsaWMgc3RhdGljIGlkZW50aWZpZXIgPSAnY29tLmRpc2NvcmQtcGxheWVyLnJldmVyYm5hdGlvbmV4dHJhY3RvcicgYXMgY29uc3Q7XG5cbiAgICBwdWJsaWMgYXN5bmMgdmFsaWRhdGUocXVlcnk6IHN0cmluZywgdHlwZT86IFNlYXJjaFF1ZXJ5VHlwZSB8IG51bGwgfCB1bmRlZmluZWQpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBxdWVyeSAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIChbUXVlcnlUeXBlLlJFVkVSQk5BVElPTl0gYXMgU2VhcmNoUXVlcnlUeXBlW10pLnNvbWUoKHIpID0+IHIgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkVHJhY2tzKHRyYWNrOiBUcmFjaykge1xuICAgICAgICB2b2lkIHRyYWNrO1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBoYW5kbGUocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCk6IFByb21pc2U8RXh0cmFjdG9ySW5mbz4ge1xuICAgICAgICBzd2l0Y2ggKGNvbnRleHQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuUkVWRVJCTkFUSU9OOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tJbmZvID0gYXdhaXQgcmV2ZXJibmF0aW9uLmdldEluZm8ocXVlcnkpLmNhdGNoKFV0aWwubm9vcCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRyYWNrSW5mbykgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdHJhY2tJbmZvLmx5cmljcyB8fCBgJHt0cmFja0luZm8udGl0bGV9IGJ5ICR7dHJhY2tJbmZvLmFydGlzdC5uYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdHJhY2tJbmZvLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXJiaXRyYXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgZW5naW5lOiB0cmFja0luZm8uc3RyZWFtVVJMLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFt0cmFja10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGVtcHR5UmVzcG9uc2UoKTogRXh0cmFjdG9ySW5mbyB7XG4gICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFtdIH07XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHN0cmVhbShpbmZvOiBUcmFjaykge1xuICAgICAgICBjb25zdCBlbmdpbmUgPSBpbmZvLnJhdy5lbmdpbmUgYXMgc3RyaW5nO1xuICAgICAgICBpZiAoZW5naW5lKSB7XG4gICAgICAgICAgICByZXR1cm4gZW5naW5lO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdHJhY2sgPSBhd2FpdCByZXZlcmJuYXRpb24uZ2V0SW5mbyhpbmZvLnVybCkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgaWYgKCF0cmFjayB8fCAhdHJhY2suc3RyZWFtVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBleHRyYWN0IHN0cmVhbSBmcm9tIHRoaXMgc291cmNlJyk7XG5cbiAgICAgICAgaW5mby5yYXcuZW5naW5lID0ge1xuICAgICAgICAgICAgc3RyZWFtVVJMOiB0cmFjay5zdHJlYW1VUkxcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdHJhY2suc3RyZWFtVVJMO1xuICAgIH1cbn1cbiIsICIvLyBwcmV0dGllci1pZ25vcmVcbmltcG9ydCB7XG4gICAgQmFzZUV4dHJhY3RvcixcbiAgICBFeHRyYWN0b3JJbmZvLFxuICAgIEV4dHJhY3RvclNlYXJjaENvbnRleHQsXG4gICAgUXVlcnlUeXBlLFxuICAgIFNlYXJjaFF1ZXJ5VHlwZSxcbiAgICBUcmFjayxcbiAgICBVdGlsXG59IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB0eXBlIHsgSW5jb21pbmdNZXNzYWdlIH0gZnJvbSAnaHR0cCc7XG5pbXBvcnQgeyBjcmVhdGVSZWFkU3RyZWFtLCBleGlzdHNTeW5jIH0gZnJvbSAnZnMnO1xuaW1wb3J0IHsgZG93bmxvYWRTdHJlYW0gfSBmcm9tICcuLi9pbnRlcm5hbC9kb3dubG9hZGVyJztcbmltcG9ydCAqIGFzIGZpbGVUeXBlIGZyb20gJ2ZpbGUtdHlwZSc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IHN0YXQgfSBmcm9tICdmcy9wcm9taXNlcyc7XG5cbmV4cG9ydCBjbGFzcyBBdHRhY2htZW50RXh0cmFjdG9yIGV4dGVuZHMgQmFzZUV4dHJhY3RvciB7XG4gICAgcHVibGljIHN0YXRpYyBpZGVudGlmaWVyID0gJ2NvbS5kaXNjb3JkLXBsYXllci5hdHRhY2htZW50ZXh0cmFjdG9yJyBhcyBjb25zdDtcblxuICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZShxdWVyeTogc3RyaW5nLCB0eXBlPzogU2VhcmNoUXVlcnlUeXBlIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKFtRdWVyeVR5cGUuQVJCSVRSQVJZLCBRdWVyeVR5cGUuRklMRV0gYXMgU2VhcmNoUXVlcnlUeXBlW10pLnNvbWUoKHIpID0+IHIgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkVHJhY2tzKHRyYWNrOiBUcmFjaykge1xuICAgICAgICB2b2lkIHRyYWNrO1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBoYW5kbGUocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCk6IFByb21pc2U8RXh0cmFjdG9ySW5mbz4ge1xuICAgICAgICBzd2l0Y2ggKGNvbnRleHQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVJCSVRSQVJZOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IChhd2FpdCBkb3dubG9hZFN0cmVhbShxdWVyeSwgY29udGV4dC5yZXF1ZXN0T3B0aW9ucykpIGFzIEluY29taW5nTWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoIVsnYXVkaW8vJywgJ3ZpZGVvLyddLnNvbWUoKHIpID0+ICEhZGF0YS5oZWFkZXJzWydjb250ZW50LXR5cGUnXT8uc3RhcnRzV2l0aChyKSkpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFja0luZm8gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnLycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoeCkgPT4geC5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvcCgpID8/ICdBdHRhY2htZW50J1xuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJz8nKVswXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRyaW0oKSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogJ2h0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvMi8yYS9JVHVuZXNfMTIuMl9sb2dvLnBuZycsXG4gICAgICAgICAgICAgICAgICAgIGVuZ2luZTogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6ICgoZGF0YSBhcyBhbnkpLmNsaWVudD8uc2VydmVybmFtZSBhcyBzdHJpbmcpIHx8ICdBdHRhY2htZW50JyxcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAoKGRhdGEgYXMgYW55KS5jbGllbnQ/LnNlcnZlcm5hbWUgYXMgc3RyaW5nKSB8fCAnQXR0YWNobWVudCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogZGF0YS51cmwgfHwgcXVlcnlcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdHJhY2tJbmZvLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHRyYWNrSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHRyYWNrSW5mby5hdXRob3IsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcmJpdHJhcnknLFxuICAgICAgICAgICAgICAgICAgICBlbmdpbmU6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICAgICAgICAgIHRyYWNrLnJhdy5pc0ZpbGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFt0cmFja10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLkZJTEU6IHtcbiAgICAgICAgICAgICAgICBpZiAoIWV4aXN0c1N5bmMocXVlcnkpKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZnN0YXQgPSBhd2FpdCBzdGF0KHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICBpZiAoIWZzdGF0LmlzRmlsZSgpKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWltZSA9IGF3YWl0IGZpbGVUeXBlLmZyb21GaWxlKHF1ZXJ5KS5jYXRjaCgoKSA9PiBudWxsKTtcbiAgICAgICAgICAgICAgICBpZiAoIW1pbWUgfHwgIVsnYXVkaW8vJywgJ3ZpZGVvLyddLnNvbWUoKHIpID0+ICEhbWltZS5taW1lLnN0YXJ0c1dpdGgocikpKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tJbmZvID0ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogcGF0aC5iYXNlbmFtZShxdWVyeSkgfHwgJ0F0dGFjaG1lbnQnLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiAnaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy8yLzJhL0lUdW5lc18xMi4yX2xvZ28ucG5nJyxcbiAgICAgICAgICAgICAgICAgICAgZW5naW5lOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiAnQXR0YWNobWVudCcsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQXR0YWNobWVudCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogcXVlcnlcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdHJhY2tJbmZvLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHRyYWNrSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHRyYWNrSW5mby5hdXRob3IsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcmJpdHJhcnknLFxuICAgICAgICAgICAgICAgICAgICBlbmdpbmU6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICAgICAgICAgIHRyYWNrLnJhdy5pc0ZpbGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW3RyYWNrXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZW1wdHlSZXNwb25zZSgpOiBFeHRyYWN0b3JJbmZvIHtcbiAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc3RyZWFtKGluZm86IFRyYWNrKSB7XG4gICAgICAgIGNvbnN0IGVuZ2luZSA9IGluZm8ucmF3LmVuZ2luZSBhcyBzdHJpbmc7XG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgICAgY29uc3QgaXNGaWxlID0gaW5mby5yYXcuaXNGaWxlIGFzIGJvb2xlYW47XG5cbiAgICAgICAgaWYgKCFlbmdpbmUpIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgc3RyZWFtIHNvdXJjZScpO1xuXG4gICAgICAgIGlmICghaXNGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gZW5naW5lO1xuICAgICAgICAgICAgLy8gcmV0dXJuIGF3YWl0IGRvd25sb2FkU3RyZWFtKGVuZ2luZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY3JlYXRlUmVhZFN0cmVhbShlbmdpbmUpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgaHR0cCwgeyBSZXF1ZXN0T3B0aW9ucyB9IGZyb20gJ2h0dHAnO1xuaW1wb3J0IGh0dHBzIGZyb20gJ2h0dHBzJztcbmltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJztcblxuZXhwb3J0IGZ1bmN0aW9uIGRvd25sb2FkU3RyZWFtKHVybDogc3RyaW5nLCBvcHRzOiBSZXF1ZXN0T3B0aW9ucyA9IHt9KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPFJlYWRhYmxlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IGxpYiA9IHVybC5zdGFydHNXaXRoKCdodHRwOi8vJykgPyBodHRwIDogaHR0cHM7XG5cbiAgICAgICAgbGliLmdldCh1cmwsIG9wdHMsIChyZXMpID0+IHJlc29sdmUocmVzKSkub25jZSgnZXJyb3InLCByZWplY3QpO1xuICAgIH0pO1xufVxuIiwgImltcG9ydCB7IEJhc2VFeHRyYWN0b3IsIEV4dHJhY3RvckluZm8sIEV4dHJhY3RvclNlYXJjaENvbnRleHQsIFBsYXlsaXN0LCBRdWVyeVR5cGUsIFNlYXJjaFF1ZXJ5VHlwZSwgVHJhY2ssIFV0aWwgfSBmcm9tICdkaXNjb3JkLXBsYXllcic7XG5pbXBvcnQgeyBBcHBsZU11c2ljIH0gZnJvbSAnLi4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgUmVhZGFibGUgfSBmcm9tICdzdHJlYW0nO1xuaW1wb3J0IHsgWW91dHViZUV4dHJhY3RvciB9IGZyb20gJy4vWW91dHViZUV4dHJhY3Rvcic7XG5pbXBvcnQgeyBTdHJlYW1GTiwgbG9hZFl0ZGwsIG1ha2VZVFNlYXJjaCB9IGZyb20gJy4vY29tbW9uL2hlbHBlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXBwbGVNdXNpY0V4dHJhY3RvckluaXQge1xuICAgIGNyZWF0ZVN0cmVhbT86IChleHQ6IEFwcGxlTXVzaWNFeHRyYWN0b3IsIHVybDogc3RyaW5nKSA9PiBQcm9taXNlPFJlYWRhYmxlIHwgc3RyaW5nPjtcbn1cblxuZXhwb3J0IGNsYXNzIEFwcGxlTXVzaWNFeHRyYWN0b3IgZXh0ZW5kcyBCYXNlRXh0cmFjdG9yPEFwcGxlTXVzaWNFeHRyYWN0b3JJbml0PiB7XG4gICAgcHVibGljIHN0YXRpYyBpZGVudGlmaWVyID0gJ2NvbS5kaXNjb3JkLXBsYXllci5hcHBsZW11c2ljZXh0cmFjdG9yJyBhcyBjb25zdDtcbiAgICBwcml2YXRlIF9zdHJlYW0hOiBTdHJlYW1GTjtcbiAgICBwcml2YXRlIF9pc1l0ZGwgPSBmYWxzZTtcblxuICAgIHB1YmxpYyBhc3luYyBhY3RpdmF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZm4gPSB0aGlzLm9wdGlvbnMuY3JlYXRlU3RyZWFtO1xuXG4gICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuX2lzWXRkbCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fc3RyZWFtID0gKHE6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbih0aGlzLCBxKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxpYiA9IGF3YWl0IGxvYWRZdGRsKHRoaXMuY29udGV4dC5wbGF5ZXIub3B0aW9ucy55dGRsT3B0aW9ucyk7XG4gICAgICAgIHRoaXMuX3N0cmVhbSA9IGxpYi5zdHJlYW07XG4gICAgICAgIHRoaXMuX2lzWXRkbCA9IHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHZhbGlkYXRlKHF1ZXJ5OiBzdHJpbmcsIHR5cGU/OiBTZWFyY2hRdWVyeVR5cGUgfCBudWxsIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgICAgICByZXR1cm4gKDxTZWFyY2hRdWVyeVR5cGVbXT5bXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfQUxCVU0sXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfUExBWUxJU1QsXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfU09ORyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19TRUFSQ0gsXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVVUTyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPX1NFQVJDSFxuICAgICAgICBdKS5zb21lKCh0KSA9PiB0ID09PSB0eXBlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0UmVsYXRlZFRyYWNrcyh0cmFjazogVHJhY2spIHtcbiAgICAgICAgaWYgKHRyYWNrLnF1ZXJ5VHlwZSA9PT0gUXVlcnlUeXBlLkFQUExFX01VU0lDX1NPTkcpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGUodHJhY2suYXV0aG9yIHx8IHRyYWNrLnRpdGxlLCB7XG4gICAgICAgICAgICAgICAgdHlwZTogUXVlcnlUeXBlLkFQUExFX01VU0lDX1NFQVJDSCxcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogdHJhY2sucmVxdWVzdGVkQnlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBFeHRyYWN0b3JTZWFyY2hDb250ZXh0KTogUHJvbWlzZTxFeHRyYWN0b3JJbmZvPiB7XG4gICAgICAgIHN3aXRjaCAoY29udGV4dC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BVVRPOlxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVVUT19TRUFSQ0g6XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19TRUFSQ0g6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgQXBwbGVNdXNpYy5zZWFyY2gocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghZGF0YSB8fCAhZGF0YS5sZW5ndGgpIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tzID0gZGF0YS5tYXAoXG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgIChtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IG0uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG0udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHR5cGVvZiBtLmR1cmF0aW9uID09PSAnbnVtYmVyJyA/IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMobS5kdXJhdGlvbikpIDogbS5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IG0udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbS51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXBwbGVfbXVzaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogJ2FwcGxlTXVzaWNTb25nJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFjaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZShudWxsLCB0cmFja3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfQUxCVU06IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmZvID0gYXdhaXQgQXBwbGVNdXNpYy5nZXRBbGJ1bUluZm8ocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghaW5mbykgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZm8uaWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ2FwcGxlX211c2ljJyxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBpbmZvLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGluZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhbGJ1bScsXG4gICAgICAgICAgICAgICAgICAgIHVybDogaW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBpbmZvXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSBpbmZvLnRyYWNrcy5tYXAoXG4gICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgIG06IGFueSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICAgICAgICAgICkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogbS5hcnRpc3QubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogdHlwZW9mIG0uZHVyYXRpb24gPT09ICdudW1iZXInID8gVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhtLmR1cmF0aW9uKSkgOiBtLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogbS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG0udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBtLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3czogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcHBsZV9tdXNpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAnYXBwbGVNdXNpY1NvbmcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2s7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3QsIHRyYWNrczogcGxheWxpc3QudHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19QTEFZTElTVDoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBBcHBsZU11c2ljLmdldFBsYXlsaXN0SW5mbyhxdWVyeSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpbmZvKSByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcGxheWxpc3QgPSBuZXcgUGxheWxpc3QodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGluZm8uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBpbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBpZDogaW5mby5pZCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXBwbGVfbXVzaWMnLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGluZm8udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogaW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYXlsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBpbmZvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgcmF3UGxheWxpc3Q6IGluZm9cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHBsYXlsaXN0LnRyYWNrcyA9IGluZm8udHJhY2tzLm1hcChcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbTogYW55IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgICAgICAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBtLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB0eXBlb2YgbS5kdXJhdGlvbiA9PT0gJ251bWJlcicgPyBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKG0uZHVyYXRpb24pKSA6IG0uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBtLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG0udXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ2FwcGxlX211c2ljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6ICdhcHBsZU11c2ljU29uZydcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2s7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3QsIHRyYWNrczogcGxheWxpc3QudHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19TT05HOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IEFwcGxlTXVzaWMuZ2V0U29uZ0luZm8ocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghaW5mbykgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBpbmZvLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHR5cGVvZiBpbmZvLmR1cmF0aW9uID09PSAnbnVtYmVyJyA/IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMoaW5mby5kdXJhdGlvbikpIDogaW5mby5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBpbmZvLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGluZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogaW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcHBsZV9tdXNpYycsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFt0cmFja10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzdHJlYW0oaW5mbzogVHJhY2spOiBQcm9taXNlPHN0cmluZyB8IFJlYWRhYmxlPiB7XG4gICAgICAgIGlmICghdGhpcy5fc3RyZWFtKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBpbml0aWFsaXplIHN0cmVhbWluZyBhcGkgZm9yICcke3RoaXMuY29uc3RydWN0b3IubmFtZX0nYCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXJsID0gaW5mby51cmw7XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzWXRkbCkge1xuICAgICAgICAgICAgaWYgKFlvdXR1YmVFeHRyYWN0b3IudmFsaWRhdGVVUkwoaW5mby5yYXcudXJsKSkgdXJsID0gaW5mby5yYXcudXJsO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgX3VybCA9IGF3YWl0IG1ha2VZVFNlYXJjaChgJHtpbmZvLnRpdGxlfSAke2luZm8uYXV0aG9yfWAsICd2aWRlbycpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyKSA9PiByWzBdLnVybClcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgICAgICAgICAgaWYgKCFfdXJsKSB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCByZXNvdXJjZXMgZm9yIHl0ZGwgc3RyZWFtaW5nJyk7XG4gICAgICAgICAgICAgICAgaW5mby5yYXcudXJsID0gdXJsID0gX3VybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW0odXJsKTtcbiAgICB9XG59XG4iLCAiZXhwb3J0ICogZnJvbSAnLi9BcHBsZU11c2ljJztcbmV4cG9ydCAqIGZyb20gJy4vVmltZW8nO1xuZXhwb3J0ICogZnJvbSAnLi9kb3dubG9hZGVyJztcbmV4cG9ydCAqIGZyb20gJy4vU3BvdGlmeSc7XG4iLCAiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuaW1wb3J0IHsgUXVlcnlSZXNvbHZlciB9IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB7IHBhcnNlLCBIVE1MRWxlbWVudCB9IGZyb20gJ25vZGUtaHRtbC1wYXJzZXInO1xuaW1wb3J0IHsgVUEsIGdldEZldGNoIH0gZnJvbSAnLi4vZXh0cmFjdG9ycy9jb21tb24vaGVscGVyJztcblxuZnVuY3Rpb24gZ2V0SFRNTChsaW5rOiBzdHJpbmcpOiBQcm9taXNlPEhUTUxFbGVtZW50IHwgbnVsbD4ge1xuICAgIHJldHVybiBnZXRGZXRjaChsaW5rLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdVc2VyLUFnZW50JzogVUFcbiAgICAgICAgfVxuICAgIH0pXG4gICAgICAgIC50aGVuKChyKSA9PiByLnRleHQoKSlcbiAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAodHh0KSA9PiBwYXJzZSh0eHQpLFxuICAgICAgICAgICAgKCkgPT4gbnVsbFxuICAgICAgICApO1xufVxuXG5mdW5jdGlvbiBtYWtlSW1hZ2UoeyBoZWlnaHQsIHVybCwgd2lkdGgsIGV4dCA9ICdqcGcnIH06IHsgdXJsOiBzdHJpbmc7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyOyBleHQ/OiBzdHJpbmcgfSkge1xuICAgIHJldHVybiB1cmwucmVwbGFjZSgne3d9JywgYCR7d2lkdGh9YCkucmVwbGFjZSgne2h9JywgYCR7aGVpZ2h0fWApLnJlcGxhY2UoJ3tmfScsIGV4dCk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlRHVyYXRpb24oZDogc3RyaW5nKSB7XG4gICAgY29uc3QgciA9IChuYW1lOiBzdHJpbmcsIHVuaXQ6IHN0cmluZykgPT4gYCgoPzwke25hbWV9Pi0/XFxcXGQqW1xcXFwuLF0/XFxcXGQrKSR7dW5pdH0pP2A7XG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFxuICAgICAgICBbXG4gICAgICAgICAgICAnKD88bmVnYXRpdmU+LSk/UCcsXG4gICAgICAgICAgICByKCd5ZWFycycsICdZJyksXG4gICAgICAgICAgICByKCdtb250aHMnLCAnTScpLFxuICAgICAgICAgICAgcignd2Vla3MnLCAnVycpLFxuICAgICAgICAgICAgcignZGF5cycsICdEJyksXG4gICAgICAgICAgICAnKFQnLFxuICAgICAgICAgICAgcignaG91cnMnLCAnSCcpLFxuICAgICAgICAgICAgcignbWludXRlcycsICdNJyksXG4gICAgICAgICAgICByKCdzZWNvbmRzJywgJ1MnKSxcbiAgICAgICAgICAgICcpPycgLy8gZW5kIG9wdGlvbmFsIHRpbWVcbiAgICAgICAgXS5qb2luKCcnKVxuICAgICk7XG4gICAgY29uc3QgdGVzdCA9IHJlZ2V4LmV4ZWMoZCk7XG4gICAgaWYgKCF0ZXN0IHx8ICF0ZXN0Lmdyb3VwcykgcmV0dXJuICcwOjAwJztcblxuICAgIGNvbnN0IGR1ciA9IFt0ZXN0Lmdyb3Vwcy55ZWFycywgdGVzdC5ncm91cHMubW9udGhzLCB0ZXN0Lmdyb3Vwcy53ZWVrcywgdGVzdC5ncm91cHMuZGF5cywgdGVzdC5ncm91cHMuaG91cnMsIHRlc3QuZ3JvdXBzLm1pbnV0ZXMsIHRlc3QuZ3JvdXBzLnNlY29uZHNdO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgZHVyXG4gICAgICAgICAgICAuZmlsdGVyKChyLCBpLCBhKSA9PiAhIXIgfHwgaSA+IGEubGVuZ3RoIC0gMilcbiAgICAgICAgICAgIC5tYXAoKG0sIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIW0pIG0gPSAnMCc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgPCAxID8gbSA6IG0ucGFkU3RhcnQoMiwgJzAnKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuam9pbignOicpIHx8ICcwOjAwJ1xuICAgICk7XG59XG5cbmV4cG9ydCBjbGFzcyBBcHBsZU11c2ljIHtcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybiBBcHBsZU11c2ljO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgc2VhcmNoKHF1ZXJ5OiBzdHJpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL211c2ljLmFwcGxlLmNvbS91cy9zZWFyY2g/dGVybT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YDtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBhd2FpdCBnZXRIVE1MKHVybCk7XG4gICAgICAgICAgICBpZiAoIW5vZGUpIHJldHVybiBbXTtcblxuICAgICAgICAgICAgY29uc3QgcmF3RGF0YSA9IG5vZGUuZ2V0RWxlbWVudEJ5SWQoJ3NlcmlhbGl6ZWQtc2VydmVyLWRhdGEnKTtcbiAgICAgICAgICAgIGlmICghcmF3RGF0YSkgcmV0dXJuIFtdO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyYXdEYXRhLmlubmVyVGV4dClbMF0uZGF0YS5zZWN0aW9ucztcbiAgICAgICAgICAgIGNvbnN0IHRyYWNrcyA9IGRhdGEuZmluZCgoczogYW55KSA9PiBzLml0ZW1LaW5kID09PSAndHJhY2tMb2NrdXAnKT8uaXRlbXM7XG4gICAgICAgICAgICBpZiAoIXRyYWNrcykgcmV0dXJuIFtdO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJhY2tzLm1hcCgodHJhY2s6IGFueSkgPT4gKHtcbiAgICAgICAgICAgICAgICBpZDogdHJhY2suY29udGVudERlc2NyaXB0b3IuaWRlbnRpZmllcnMuc3RvcmVBZGFtSUQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IHRyYWNrLmR1cmF0aW9uIHx8ICcwOjAwJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2sudGl0bGUsXG4gICAgICAgICAgICAgICAgdXJsOiB0cmFjay5jb250ZW50RGVzY3JpcHRvci51cmwsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiB0cmFjaz8uYXJ0d29yaz8uZGljdGlvbmFyeVxuICAgICAgICAgICAgICAgICAgICA/IG1ha2VJbWFnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdHJhY2suYXJ0d29yay5kaWN0aW9uYXJ5LnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB0cmFjay5hcnR3b3JrLmRpY3Rpb25hcnkuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdHJhY2suYXJ0d29yay5kaWN0aW9uYXJ5LndpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgOiAnaHR0cHM6Ly9tdXNpYy5hcHBsZS5jb20vYXNzZXRzL2Zhdmljb24vZmF2aWNvbi0xODAucG5nJyxcbiAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdHJhY2suc3VidGl0bGVMaW5rcz8uWzBdPy50aXRsZSA/PyAnVW5rbm93biBBcnRpc3QnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgZ2V0U29uZ0luZm9GYWxsYmFjayhyZXM6IEhUTUxFbGVtZW50LCBuYW1lOiBzdHJpbmcsIGlkOiBzdHJpbmcsIGxpbms6IHN0cmluZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbWV0YVRhZ3MgPSByZXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21ldGEnKTtcbiAgICAgICAgICAgIGlmICghbWV0YVRhZ3MubGVuZ3RoKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBtZXRhVGFncy5maW5kKChyKSA9PiByLmdldEF0dHJpYnV0ZSgnbmFtZScpID09PSAnYXBwbGU6dGl0bGUnKT8uZ2V0QXR0cmlidXRlKCdjb250ZW50JykgfHwgcmVzLnF1ZXJ5U2VsZWN0b3IoJ3RpdGxlJyk/LmlubmVyVGV4dCB8fCBuYW1lO1xuICAgICAgICAgICAgY29uc3QgY29udGVudElkID0gbWV0YVRhZ3MuZmluZCgocikgPT4gci5nZXRBdHRyaWJ1dGUoJ25hbWUnKSA9PT0gJ2FwcGxlOmNvbnRlbnRfaWQnKT8uZ2V0QXR0cmlidXRlKCdjb250ZW50JykgfHwgaWQ7XG4gICAgICAgICAgICBjb25zdCBkdXJhdGlvblJhdyA9IG1ldGFUYWdzLmZpbmQoKHIpID0+IHIuZ2V0QXR0cmlidXRlKCdwcm9wZXJ0eScpID09PSAnbXVzaWM6c29uZzpkdXJhdGlvbicpPy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcblxuICAgICAgICAgICAgY29uc3Qgc29uZyA9IHtcbiAgICAgICAgICAgICAgICBpZDogY29udGVudElkLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvblJhd1xuICAgICAgICAgICAgICAgICAgICA/IHBhcnNlRHVyYXRpb24oZHVyYXRpb25SYXcpXG4gICAgICAgICAgICAgICAgICAgIDogbWV0YVRhZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoKG0pID0+IG0uZ2V0QXR0cmlidXRlKCduYW1lJykgPT09ICdhcHBsZTpkZXNjcmlwdGlvbicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8udGV4dENvbnRlbnQuc3BsaXQoJ0R1cmF0aW9uOiAnKT8uWzFdXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnXCInKT8uWzBdIHx8ICcwOjAwJyxcbiAgICAgICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgICAgICB1cmw6IGxpbmssXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOlxuICAgICAgICAgICAgICAgICAgICBtZXRhVGFncy5maW5kKChyKSA9PiBbJ29nOmltYWdlOnNlY3VyZV91cmwnLCAnb2c6aW1hZ2UnXS5pbmNsdWRlcyhyLmdldEF0dHJpYnV0ZSgncHJvcGVydHknKSEpKT8uZ2V0QXR0cmlidXRlKCdjb250ZW50JykgfHxcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHBzOi8vbXVzaWMuYXBwbGUuY29tL2Fzc2V0cy9mYXZpY29uL2Zhdmljb24tMTgwLnBuZycsXG4gICAgICAgICAgICAgICAgYXJ0aXN0OiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlcy5xdWVyeVNlbGVjdG9yKCcuc29uZy1zdWJ0aXRsZXNfX2FydGlzdHM+YScpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICdBcHBsZSBNdXNpYydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gc29uZztcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgZ2V0U29uZ0luZm8obGluazogc3RyaW5nKSB7XG4gICAgICAgIGlmICghUXVlcnlSZXNvbHZlci5yZWdleC5hcHBsZU11c2ljU29uZ1JlZ2V4LnRlc3QobGluaykpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChsaW5rKTtcbiAgICAgICAgY29uc3QgaWQgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnaScpO1xuICAgICAgICBjb25zdCBuYW1lID0gdXJsLnBhdGhuYW1lLnNwbGl0KCdhbGJ1bS8nKVsxXT8uc3BsaXQoJy8nKVswXTtcblxuICAgICAgICBpZiAoIWlkIHx8ICFuYW1lKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRIVE1MKGBodHRwczovL211c2ljLmFwcGxlLmNvbS91cy9zb25nLyR7bmFtZX0vJHtpZH1gKTtcbiAgICAgICAgaWYgKCFyZXMpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhc3JjID1cbiAgICAgICAgICAgICAgICByZXMuZ2V0RWxlbWVudEJ5SWQoJ3NlcmlhbGl6ZWQtc2VydmVyLWRhdGEnKT8uaW5uZXJUZXh0IHx8IHJlcy5pbm5lclRleHQuc3BsaXQoJzxzY3JpcHQgdHlwZT1cImFwcGxpY2F0aW9uL2pzb25cIiBpZD1cInNlcmlhbGl6ZWQtc2VydmVyLWRhdGFcIj4nKT8uWzFdPy5zcGxpdCgnPC9zY3JpcHQ+Jyk/LlswXTtcbiAgICAgICAgICAgIGlmICghZGF0YXNyYykgdGhyb3cgJ25vdCBmb3VuZCc7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShkYXRhc3JjKVswXS5kYXRhLnNlb0RhdGE7XG4gICAgICAgICAgICBjb25zdCBzb25nID0gZGF0YS5vZ1NvbmdzWzBdPy5hdHRyaWJ1dGVzO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlkOiBkYXRhLm9nU29uZ3NbMF0/LmlkIHx8IGRhdGEuYXBwbGVDb250ZW50SWQgfHwgaWQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IHNvbmc/LmR1cmF0aW9uSW5NaWxsaXMgfHwgJzA6MDAnLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBzb25nPy5uYW1lIHx8IGRhdGEuYXBwbGVUaXRsZSxcbiAgICAgICAgICAgICAgICB1cmw6IHNvbmc/LnVybCB8fCBkYXRhLnVybCB8fCBsaW5rLFxuICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc29uZz8uYXJ0d29ya1xuICAgICAgICAgICAgICAgICAgICA/IG1ha2VJbWFnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc29uZy5hcnR3b3JrLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBzb25nLmFydHdvcmsuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogc29uZy5hcnR3b3JrLndpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgOiBkYXRhLmFydHdvcmtVcmxcbiAgICAgICAgICAgICAgICAgICAgPyBtYWtlSW1hZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGRhdGEuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogZGF0YS53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBkYXRhLmFydHdvcmtVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGV4dDogZGF0YS5maWxlVHlwZSB8fCAnanBnJ1xuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIDogJ2h0dHBzOi8vbXVzaWMuYXBwbGUuY29tL2Fzc2V0cy9mYXZpY29uL2Zhdmljb24tMTgwLnBuZycsXG4gICAgICAgICAgICAgICAgYXJ0aXN0OiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHNvbmc/LmFydGlzdE5hbWUgfHwgZGF0YS5zb2NpYWxUaXRsZSB8fCAnQXBwbGUgTXVzaWMnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTb25nSW5mb0ZhbGxiYWNrKHJlcywgbmFtZSwgaWQsIGxpbmspO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRQbGF5bGlzdEluZm8obGluazogc3RyaW5nKSB7XG4gICAgICAgIGlmICghUXVlcnlSZXNvbHZlci5yZWdleC5hcHBsZU11c2ljUGxheWxpc3RSZWdleC50ZXN0KGxpbmspKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEhUTUwobGluayk7XG4gICAgICAgIGlmICghcmVzKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YXNyYyA9XG4gICAgICAgICAgICAgICAgcmVzLmdldEVsZW1lbnRCeUlkKCdzZXJpYWxpemVkLXNlcnZlci1kYXRhJyk/LmlubmVyVGV4dCB8fCByZXMuaW5uZXJUZXh0LnNwbGl0KCc8c2NyaXB0IHR5cGU9XCJhcHBsaWNhdGlvbi9qc29uXCIgaWQ9XCJzZXJpYWxpemVkLXNlcnZlci1kYXRhXCI+Jyk/LlsxXT8uc3BsaXQoJzwvc2NyaXB0PicpPy5bMF07XG4gICAgICAgICAgICBpZiAoIWRhdGFzcmMpIHRocm93ICdub3QgZm91bmQnO1xuICAgICAgICAgICAgY29uc3QgcGwgPSBKU09OLnBhcnNlKGRhdGFzcmMpWzBdLmRhdGEuc2VvRGF0YTtcbiAgICAgICAgICAgIGNvbnN0IHRodW1ibmFpbCA9IHBsLmFydHdvcmtVcmxcbiAgICAgICAgICAgICAgICA/IG1ha2VJbWFnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBwbC5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBsLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgIHVybDogcGwuYXJ0d29ya1VybCxcbiAgICAgICAgICAgICAgICAgICAgICBleHQ6IHBsLmZpbGVUeXBlIHx8ICdqcGcnXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIDogJ2h0dHBzOi8vbXVzaWMuYXBwbGUuY29tL2Fzc2V0cy9mYXZpY29uL2Zhdmljb24tMTgwLnBuZyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlkOiBwbC5hcHBsZUNvbnRlbnRJZCxcbiAgICAgICAgICAgICAgICB0aXRsZTogcGwuYXBwbGVUaXRsZSxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgYXJ0aXN0OiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHBsLm9nU29uZ3M/LlswXT8uYXR0cmlidXRlcz8uYXJ0aXN0TmFtZSB8fCAnQXBwbGUgTXVzaWMnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cmw6IHBsLnVybCxcbiAgICAgICAgICAgICAgICB0cmFja3M6XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICAgICAgICAgICAgICBwbC5vZ1NvbmdzPy5tYXAoKG06IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29uZyA9IG0uYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHNvbmcuZHVyYXRpb25Jbk1pbGxpcyB8fCAnMDowMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNvbmcubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNvbmcudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc29uZy5hcnR3b3JrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbWFrZUltYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nLmFydHdvcmsudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHNvbmcuYXJ0d29yay5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzb25nLmFydHdvcmsud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc29uZy5hcnRpc3ROYW1lIHx8ICdBcHBsZSBNdXNpYydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KSB8fCBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgZ2V0QWxidW1JbmZvKGxpbms6IHN0cmluZykge1xuICAgICAgICBpZiAoIVF1ZXJ5UmVzb2x2ZXIucmVnZXguYXBwbGVNdXNpY0FsYnVtUmVnZXgudGVzdChsaW5rKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRIVE1MKGxpbmspO1xuICAgICAgICBpZiAoIXJlcykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFzcmMgPVxuICAgICAgICAgICAgICAgIHJlcy5nZXRFbGVtZW50QnlJZCgnc2VyaWFsaXplZC1zZXJ2ZXItZGF0YScpPy5pbm5lclRleHQgfHwgcmVzLmlubmVyVGV4dC5zcGxpdCgnPHNjcmlwdCB0eXBlPVwiYXBwbGljYXRpb24vanNvblwiIGlkPVwic2VyaWFsaXplZC1zZXJ2ZXItZGF0YVwiPicpPy5bMV0/LnNwbGl0KCc8L3NjcmlwdD4nKT8uWzBdO1xuICAgICAgICAgICAgaWYgKCFkYXRhc3JjKSB0aHJvdyAnbm90IGZvdW5kJztcbiAgICAgICAgICAgIGNvbnN0IHBsID0gSlNPTi5wYXJzZShkYXRhc3JjKVswXS5kYXRhLnNlb0RhdGE7XG4gICAgICAgICAgICBjb25zdCB0aHVtYm5haWwgPSBwbC5hcnR3b3JrVXJsXG4gICAgICAgICAgICAgICAgPyBtYWtlSW1hZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogcGwuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBwbC53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IHBsLmFydHdvcmtVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgZXh0OiBwbC5maWxlVHlwZSB8fCAnanBnJ1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICA6ICdodHRwczovL211c2ljLmFwcGxlLmNvbS9hc3NldHMvZmF2aWNvbi9mYXZpY29uLTE4MC5wbmcnO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpZDogcGwuYXBwbGVDb250ZW50SWQsXG4gICAgICAgICAgICAgICAgdGl0bGU6IHBsLmFwcGxlVGl0bGUsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgIGFydGlzdDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBwbC5vZ1NvbmdzPy5bMF0/LmF0dHJpYnV0ZXM/LmFydGlzdE5hbWUgfHwgJ0FwcGxlIE11c2ljJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdXJsOiBwbC51cmwsXG4gICAgICAgICAgICAgICAgdHJhY2tzOlxuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgICAgICAgICAgICAgcGwub2dTb25ncz8ubWFwKChtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvbmcgPSBtLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBzb25nLmR1cmF0aW9uSW5NaWxsaXMgfHwgJzA6MDAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzb25nLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHNvbmcuYXJ0d29ya1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG1ha2VJbWFnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc29uZy5hcnR3b3JrLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBzb25nLmFydHdvcmsuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogc29uZy5hcnR3b3JrLndpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJ0aXN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNvbmcuYXJ0aXN0TmFtZSB8fCAnQXBwbGUgTXVzaWMnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSkgfHwgW11cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgVUEsIGdldEZldGNoIH0gZnJvbSAnLi4vZXh0cmFjdG9ycyc7XG5cbmNvbnN0IFNQX0FOT05fVE9LRU5fVVJMID0gJ2h0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS9nZXRfYWNjZXNzX3Rva2VuP3JlYXNvbj10cmFuc3BvcnQmcHJvZHVjdFR5cGU9ZW1iZWQnO1xuY29uc3QgU1BfQUNDRVNTX1RPS0VOX1VSTCA9ICdodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2FwaS90b2tlbj9ncmFudF90eXBlPWNsaWVudF9jcmVkZW50aWFscyc7XG5jb25zdCBTUF9CQVNFID0gJ2h0dHBzOi8vYXBpLnNwb3RpZnkuY29tL3YxJztcblxuaW50ZXJmYWNlIFNQX0FDQ0VTU19UT0tFTiB7XG4gICAgdG9rZW46IHN0cmluZztcbiAgICBleHBpcmVzQWZ0ZXI6IG51bWJlcjtcbiAgICB0eXBlOiAnQmVhcmVyJztcbn1cblxuZXhwb3J0IGNsYXNzIFNwb3RpZnlBUEkge1xuICAgIHB1YmxpYyBhY2Nlc3NUb2tlbjogU1BfQUNDRVNTX1RPS0VOIHwgbnVsbCA9IG51bGw7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBjcmVkZW50aWFsczogeyBjbGllbnRJZDogc3RyaW5nIHwgbnVsbDsgY2xpZW50U2VjcmV0OiBzdHJpbmcgfCBudWxsIH0gPSB7XG4gICAgICAgICAgICBjbGllbnRJZDogbnVsbCxcbiAgICAgICAgICAgIGNsaWVudFNlY3JldDogbnVsbFxuICAgICAgICB9XG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldCBhdXRob3JpemF0aW9uS2V5KCkge1xuICAgICAgICBpZiAoIXRoaXMuY3JlZGVudGlhbHMuY2xpZW50SWQgfHwgIXRoaXMuY3JlZGVudGlhbHMuY2xpZW50U2VjcmV0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGAke3RoaXMuY3JlZGVudGlhbHMuY2xpZW50SWR9OiR7dGhpcy5jcmVkZW50aWFscy5jbGllbnRTZWNyZXR9YCkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyByZXF1ZXN0VG9rZW4oKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMuYXV0aG9yaXphdGlvbktleTtcblxuICAgICAgICBpZiAoIWtleSkgcmV0dXJuIGF3YWl0IHRoaXMucmVxdWVzdEFub255bW91c1Rva2VuKCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEZldGNoKFNQX0FDQ0VTU19UT0tFTl9VUkwsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogVUEsXG4gICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke2tleX1gLFxuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXMuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoIWJvZHkuYWNjZXNzX3Rva2VuKSB0aHJvdyAnbm8gdG9rZW4nO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHRva2VuOiBib2R5LmFjY2Vzc190b2tlbiBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZXhwaXJlc0FmdGVyOiBib2R5LmV4cGlyZXNfaW4gYXMgbnVtYmVyLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdCZWFyZXInIGFzIGNvbnN0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuYWNjZXNzVG9rZW4gPSBkYXRhKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yZXF1ZXN0QW5vbnltb3VzVG9rZW4oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyByZXF1ZXN0QW5vbnltb3VzVG9rZW4oKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRGZXRjaChTUF9BTk9OX1RPS0VOX1VSTCwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiBVQSxcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgJ25vdF9vayc7XG5cbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXMuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoIWJvZHkuYWNjZXNzVG9rZW4pIHRocm93ICdub19hY2Nlc3NfdG9rZW4nO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHRva2VuOiBib2R5LmFjY2Vzc1Rva2VuIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICBleHBpcmVzQWZ0ZXI6IGJvZHkuYWNjZXNzVG9rZW5FeHBpcmF0aW9uVGltZXN0YW1wTXMgYXMgbnVtYmVyLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdCZWFyZXInIGFzIGNvbnN0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuYWNjZXNzVG9rZW4gPSBkYXRhKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBpc1Rva2VuRXhwaXJlZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmFjY2Vzc1Rva2VuKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIERhdGUubm93KCkgPiB0aGlzLmFjY2Vzc1Rva2VuLmV4cGlyZXNBZnRlcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc2VhcmNoKHF1ZXJ5OiBzdHJpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIHJlcVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNUb2tlbkV4cGlyZWQoKSkgYXdhaXQgdGhpcy5yZXF1ZXN0VG9rZW4oKTtcbiAgICAgICAgICAgIC8vIGZhaWxlZFxuICAgICAgICAgICAgaWYgKCF0aGlzLmFjY2Vzc1Rva2VuKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0RmV0Y2goYCR7U1BfQkFTRX0vc2VhcmNoLz9xPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX0mdHlwZT10cmFjayZtYXJrZXQ9VVNgLCB7XG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IFVBLFxuICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgJHt0aGlzLmFjY2Vzc1Rva2VuLnR5cGV9ICR7dGhpcy5hY2Nlc3NUb2tlbi50b2tlbn1gLFxuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzLm9rKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgZGF0YTogeyB0cmFja3M6IHsgaXRlbXM6IFNwb3RpZnlUcmFja1tdIH0gfSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBkYXRhLnRyYWNrcy5pdGVtcy5tYXAoKG0pID0+ICh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IG0ubmFtZSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogbS5kdXJhdGlvbl9tcyxcbiAgICAgICAgICAgICAgICBhcnRpc3Q6IG0uYXJ0aXN0cy5tYXAoKG0pID0+IG0ubmFtZSkuam9pbignLCAnKSxcbiAgICAgICAgICAgICAgICB1cmw6IG0uZXh0ZXJuYWxfdXJscz8uc3BvdGlmeSB8fCBgaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL3RyYWNrLyR7bS5pZH1gLFxuICAgICAgICAgICAgICAgIHRodW1ibmFpbDogbS5hbGJ1bS5pbWFnZXM/LlswXT8udXJsIHx8IG51bGxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRQbGF5bGlzdChpZDogc3RyaW5nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyByZXFcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVG9rZW5FeHBpcmVkKCkpIGF3YWl0IHRoaXMucmVxdWVzdFRva2VuKCk7XG4gICAgICAgICAgICAvLyBmYWlsZWRcbiAgICAgICAgICAgIGlmICghdGhpcy5hY2Nlc3NUb2tlbikgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEZldGNoKGAke1NQX0JBU0V9L3BsYXlsaXN0cy8ke2lkfT9tYXJrZXQ9VVNgLCB7XG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IFVBLFxuICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgJHt0aGlzLmFjY2Vzc1Rva2VuLnR5cGV9ICR7dGhpcy5hY2Nlc3NUb2tlbi50b2tlbn1gLFxuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIXJlcy5vaykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGE6IHtcbiAgICAgICAgICAgICAgICBleHRlcm5hbF91cmxzOiB7IHNwb3RpZnk6IHN0cmluZyB9O1xuICAgICAgICAgICAgICAgIG93bmVyOiB7IGRpc3BsYXlfbmFtZTogc3RyaW5nIH07XG4gICAgICAgICAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgaW1hZ2VzOiB7IHVybDogc3RyaW5nIH1bXTtcbiAgICAgICAgICAgICAgICB0cmFja3M6IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHsgdHJhY2s6IFNwb3RpZnlUcmFjayB9W107XG4gICAgICAgICAgICAgICAgICAgIG5leHQ/OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gPSBhd2FpdCByZXMuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoIWRhdGEudHJhY2tzLml0ZW1zLmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IHQ6IHsgdHJhY2s6IFNwb3RpZnlUcmFjayB9W10gPSBkYXRhLnRyYWNrcy5pdGVtcztcblxuICAgICAgICAgICAgbGV0IG5leHQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGRhdGEudHJhY2tzLm5leHQ7XG5cbiAgICAgICAgICAgIHdoaWxlICh0eXBlb2YgbmV4dCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRGZXRjaChuZXh0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiBVQSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgJHt0aGlzLmFjY2Vzc1Rva2VuLnR5cGV9ICR7dGhpcy5hY2Nlc3NUb2tlbi50b2tlbn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzLm9rKSBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFBhZ2U6IHsgaXRlbXM6IHsgdHJhY2s6IFNwb3RpZnlUcmFjayB9W107IG5leHQ/OiBzdHJpbmcgfSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdC5wdXNoKC4uLm5leHRQYWdlLml0ZW1zKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dCA9IG5leHRQYWdlLm5leHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXh0KSBicmVhaztcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB0cmFja3MgPSB0Lm1hcCgoeyB0cmFjazogbSB9KSA9PiAoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBtLm5hbWUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IG0uZHVyYXRpb25fbXMsXG4gICAgICAgICAgICAgICAgYXJ0aXN0OiBtLmFydGlzdHMubWFwKChtKSA9PiBtLm5hbWUpLmpvaW4oJywgJyksXG4gICAgICAgICAgICAgICAgdXJsOiBtLmV4dGVybmFsX3VybHM/LnNwb3RpZnkgfHwgYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS90cmFjay8ke20uaWR9YCxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IG0uYWxidW0uaW1hZ2VzPy5bMF0/LnVybCB8fCBudWxsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGlmICghdHJhY2tzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBhdXRob3I6IGRhdGEub3duZXIuZGlzcGxheV9uYW1lLFxuICAgICAgICAgICAgICAgIHRodW1ibmFpbDogZGF0YS5pbWFnZXM/LlswXT8udXJsIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgaWQ6IGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgdXJsOiBkYXRhLmV4dGVybmFsX3VybHMuc3BvdGlmeSB8fCBgaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL3BsYXlsaXN0LyR7aWR9YCxcbiAgICAgICAgICAgICAgICB0cmFja3NcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0QWxidW0oaWQ6IHN0cmluZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gcmVxXG4gICAgICAgICAgICBpZiAodGhpcy5pc1Rva2VuRXhwaXJlZCgpKSBhd2FpdCB0aGlzLnJlcXVlc3RUb2tlbigpO1xuICAgICAgICAgICAgLy8gZmFpbGVkXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWNjZXNzVG9rZW4pIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRGZXRjaChgJHtTUF9CQVNFfS9hbGJ1bXMvJHtpZH0/bWFya2V0PVVTYCwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiBVQSxcbiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYCR7dGhpcy5hY2Nlc3NUb2tlbi50eXBlfSAke3RoaXMuYWNjZXNzVG9rZW4udG9rZW59YCxcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCFyZXMub2spIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhOiB7XG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfdXJsczogeyBzcG90aWZ5OiBzdHJpbmcgfTtcbiAgICAgICAgICAgICAgICBhcnRpc3RzOiB7IG5hbWU6IHN0cmluZyB9W107XG4gICAgICAgICAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgaW1hZ2VzOiB7IHVybDogc3RyaW5nIH1bXTtcbiAgICAgICAgICAgICAgICB0cmFja3M6IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFNwb3RpZnlUcmFja1tdO1xuICAgICAgICAgICAgICAgICAgICBuZXh0Pzogc3RyaW5nO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9ID0gYXdhaXQgcmVzLmpzb24oKTtcblxuICAgICAgICAgICAgaWYgKCFkYXRhLnRyYWNrcy5pdGVtcy5sZW5ndGgpIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCB0OiBTcG90aWZ5VHJhY2tbXSA9IGRhdGEudHJhY2tzLml0ZW1zO1xuXG4gICAgICAgICAgICBsZXQgbmV4dDogc3RyaW5nIHwgdW5kZWZpbmVkID0gZGF0YS50cmFja3MubmV4dDtcblxuICAgICAgICAgICAgd2hpbGUgKHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEZldGNoKG5leHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IFVBLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGAke3RoaXMuYWNjZXNzVG9rZW4udHlwZX0gJHt0aGlzLmFjY2Vzc1Rva2VuLnRva2VufWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXMub2spIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0UGFnZTogeyBpdGVtczogU3BvdGlmeVRyYWNrW107IG5leHQ/OiBzdHJpbmcgfSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdC5wdXNoKC4uLm5leHRQYWdlLml0ZW1zKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dCA9IG5leHRQYWdlLm5leHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXh0KSBicmVhaztcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB0cmFja3MgPSB0Lm1hcCgobSkgPT4gKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogbS5uYW1lLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBtLmR1cmF0aW9uX21zLFxuICAgICAgICAgICAgICAgIGFydGlzdDogbS5hcnRpc3RzLm1hcCgobSkgPT4gbS5uYW1lKS5qb2luKCcsICcpLFxuICAgICAgICAgICAgICAgIHVybDogbS5leHRlcm5hbF91cmxzPy5zcG90aWZ5IHx8IGBodHRwczovL29wZW4uc3BvdGlmeS5jb20vdHJhY2svJHttLmlkfWAsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLmltYWdlcz8uWzBdPy51cmwgfHwgbnVsbFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBpZiAoIXRyYWNrcy5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgYXV0aG9yOiBkYXRhLmFydGlzdHMubWFwKChtKSA9PiBtLm5hbWUpLmpvaW4oJywgJyksXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLmltYWdlcz8uWzBdPy51cmwgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBpZDogZGF0YS5pZCxcbiAgICAgICAgICAgICAgICB1cmw6IGRhdGEuZXh0ZXJuYWxfdXJscy5zcG90aWZ5IHx8IGBodHRwczovL29wZW4uc3BvdGlmeS5jb20vYWxidW0vJHtpZH1gLFxuICAgICAgICAgICAgICAgIHRyYWNrc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTcG90aWZ5VHJhY2sge1xuICAgIGFsYnVtOiB7XG4gICAgICAgIGltYWdlczoge1xuICAgICAgICAgICAgaGVpZ2h0OiBudW1iZXI7XG4gICAgICAgICAgICB1cmw6IHN0cmluZztcbiAgICAgICAgICAgIHdpZHRoOiBudW1iZXI7XG4gICAgICAgIH1bXTtcbiAgICB9O1xuICAgIGFydGlzdHM6IHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgbmFtZTogc3RyaW5nO1xuICAgIH1bXTtcbiAgICBkdXJhdGlvbl9tczogbnVtYmVyO1xuICAgIGV4cGxpY2l0OiBib29sZWFuO1xuICAgIGV4dGVybmFsX3VybHM6IHsgc3BvdGlmeTogc3RyaW5nIH07XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG59XG4iLCAiaW1wb3J0IHsgQmFzZUV4dHJhY3RvciwgRXh0cmFjdG9ySW5mbywgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCwgUGxheWxpc3QsIFF1ZXJ5VHlwZSwgU2VhcmNoUXVlcnlUeXBlLCBUcmFjaywgVXRpbCB9IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB0eXBlIHsgUmVhZGFibGUgfSBmcm9tICdzdHJlYW0nO1xuaW1wb3J0IHsgWW91dHViZUV4dHJhY3RvciB9IGZyb20gJy4vWW91dHViZUV4dHJhY3Rvcic7XG5pbXBvcnQgeyBTdHJlYW1GTiwgZ2V0RmV0Y2gsIGxvYWRZdGRsLCBtYWtlWVRTZWFyY2ggfSBmcm9tICcuL2NvbW1vbi9oZWxwZXInO1xuaW1wb3J0IHNwb3RpZnksIHsgU3BvdGlmeSwgU3BvdGlmeUFsYnVtLCBTcG90aWZ5UGxheWxpc3QsIFNwb3RpZnlTb25nIH0gZnJvbSAnc3BvdGlmeS11cmwtaW5mbyc7XG5pbXBvcnQgeyBTcG90aWZ5QVBJIH0gZnJvbSAnLi4vaW50ZXJuYWwnO1xuXG5jb25zdCByZSA9IC9eKD86aHR0cHM6XFwvXFwvb3BlblxcLnNwb3RpZnlcXC5jb21cXC8oPzp1c2VyXFwvW0EtWmEtejAtOV0rXFwvKT98c3BvdGlmeTopKGFsYnVtfHBsYXlsaXN0fHRyYWNrKSg/OlsvOl0pKFtBLVphLXowLTldKykuKiQvO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNwb3RpZnlFeHRyYWN0b3JJbml0IHtcbiAgICBjbGllbnRJZD86IHN0cmluZyB8IG51bGw7XG4gICAgY2xpZW50U2VjcmV0Pzogc3RyaW5nIHwgbnVsbDtcbiAgICBjcmVhdGVTdHJlYW0/OiAoZXh0OiBTcG90aWZ5RXh0cmFjdG9yLCB1cmw6IHN0cmluZykgPT4gUHJvbWlzZTxSZWFkYWJsZSB8IHN0cmluZz47XG59XG5cbmV4cG9ydCBjbGFzcyBTcG90aWZ5RXh0cmFjdG9yIGV4dGVuZHMgQmFzZUV4dHJhY3RvcjxTcG90aWZ5RXh0cmFjdG9ySW5pdD4ge1xuICAgIHB1YmxpYyBzdGF0aWMgaWRlbnRpZmllciA9ICdjb20uZGlzY29yZC1wbGF5ZXIuc3BvdGlmeWV4dHJhY3RvcicgYXMgY29uc3Q7XG4gICAgcHJpdmF0ZSBfc3RyZWFtITogU3RyZWFtRk47XG4gICAgcHJpdmF0ZSBfaXNZdGRsID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBfbGliITogU3BvdGlmeTtcbiAgICBwcml2YXRlIF9jcmVkZW50aWFscyA9IHtcbiAgICAgICAgY2xpZW50SWQ6IHRoaXMub3B0aW9ucy5jbGllbnRJZCB8fCBwcm9jZXNzLmVudi5EUF9TUE9USUZZX0NMSUVOVF9JRCB8fCBudWxsLFxuICAgICAgICBjbGllbnRTZWNyZXQ6IHRoaXMub3B0aW9ucy5jbGllbnRTZWNyZXQgfHwgcHJvY2Vzcy5lbnYuRFBfU1BPVElGWV9DTElFTlRfU0VDUkVUIHx8IG51bGxcbiAgICB9O1xuICAgIHB1YmxpYyBpbnRlcm5hbCA9IG5ldyBTcG90aWZ5QVBJKHRoaXMuX2NyZWRlbnRpYWxzKTtcblxuICAgIHB1YmxpYyBhc3luYyBhY3RpdmF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZm4gPSB0aGlzLm9wdGlvbnMuY3JlYXRlU3RyZWFtO1xuXG4gICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuX2lzWXRkbCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fc3RyZWFtID0gKHE6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbih0aGlzLCBxKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxpYiA9IGF3YWl0IGxvYWRZdGRsKHRoaXMuY29udGV4dC5wbGF5ZXIub3B0aW9ucy55dGRsT3B0aW9ucyk7XG4gICAgICAgIHRoaXMuX3N0cmVhbSA9IGxpYi5zdHJlYW07XG4gICAgICAgIHRoaXMuX2xpYiA9IHNwb3RpZnkoZ2V0RmV0Y2gpO1xuICAgICAgICB0aGlzLl9pc1l0ZGwgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5pbnRlcm5hbC5pc1Rva2VuRXhwaXJlZCgpKSBhd2FpdCB0aGlzLmludGVybmFsLnJlcXVlc3RUb2tlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZShxdWVyeTogc3RyaW5nLCB0eXBlPzogU2VhcmNoUXVlcnlUeXBlIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICAvLyBwcmV0dGllci1pZ25vcmVcbiAgICAgICAgcmV0dXJuICg8U2VhcmNoUXVlcnlUeXBlW10+W1xuICAgICAgICAgICAgUXVlcnlUeXBlLlNQT1RJRllfQUxCVU0sXG4gICAgICAgICAgICBRdWVyeVR5cGUuU1BPVElGWV9QTEFZTElTVCxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5TUE9USUZZX1NPTkcsXG4gICAgICAgICAgICBRdWVyeVR5cGUuU1BPVElGWV9TRUFSQ0gsXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVVUTyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPX1NFQVJDSFxuICAgICAgICBdKS5zb21lKCh0KSA9PiB0ID09PSB0eXBlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0UmVsYXRlZFRyYWNrcyh0cmFjazogVHJhY2spIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlKHRyYWNrLmF1dGhvciB8fCB0cmFjay50aXRsZSwge1xuICAgICAgICAgICAgdHlwZTogUXVlcnlUeXBlLlNQT1RJRllfU0VBUkNIXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBoYW5kbGUocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCk6IFByb21pc2U8RXh0cmFjdG9ySW5mbz4ge1xuICAgICAgICBzd2l0Y2ggKGNvbnRleHQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVVUTzpcbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLkFVVE9fU0VBUkNIOlxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuU1BPVElGWV9TRUFSQ0g6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5pbnRlcm5hbC5zZWFyY2gocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghZGF0YSkgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKFxuICAgICAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm1hcCgoc3BvdGlmeURhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogc3BvdGlmeURhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGAke3Nwb3RpZnlEYXRhLnRpdGxlfSBieSAke3Nwb3RpZnlEYXRhLmFydGlzdH1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogc3BvdGlmeURhdGEuYXJ0aXN0ID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzcG90aWZ5RGF0YS51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzcG90aWZ5RGF0YS50aHVtYm5haWwgfHwgJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMoc3BvdGlmeURhdGEuZHVyYXRpb24gPz8gMCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Nwb3RpZnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogUXVlcnlUeXBlLlNQT1RJRllfU09OR1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFjaztcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuU1BPVElGWV9TT05HOiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BvdGlmeURhdGE6IFNwb3RpZnlTb25nIHwgdm9pZCA9IGF3YWl0IHRoaXMuX2xpYi5nZXREYXRhKHF1ZXJ5LCBjb250ZXh0LnJlcXVlc3RPcHRpb25zIGFzIHVua25vd24gYXMgUmVxdWVzdEluaXQpLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzcG90aWZ5RGF0YSkgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICAgICAgICAgICAgICBjb25zdCBzcG90aWZ5VHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogc3BvdGlmeURhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtzcG90aWZ5RGF0YS5uYW1lfSBieSAke3Nwb3RpZnlEYXRhLmFydGlzdHMubWFwKChtKSA9PiBtLm5hbWUpLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBzcG90aWZ5RGF0YS5hcnRpc3RzWzBdPy5uYW1lID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogc3BvdGlmeURhdGEuaWQgPyBgaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL3RyYWNrLyR7c3BvdGlmeURhdGEuaWR9YCA6IHF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHNwb3RpZnlEYXRhLmNvdmVyQXJ0Py5zb3VyY2VzPy5bMF0/LnVybCB8fCAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMoc3BvdGlmeURhdGEuZHVyYXRpb24gPz8gc3BvdGlmeURhdGEubWF4RHVyYXRpb24gPz8gMCkpLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czogMCxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Nwb3RpZnknLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc3BvdGlmeVRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbc3BvdGlmeVRyYWNrXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuU1BPVElGWV9QTEFZTElTVDoge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgcXVlcnlUeXBlLCBpZCB9ID0gdGhpcy5wYXJzZShxdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWVyeVR5cGUgIT09ICdwbGF5bGlzdCcpIHRocm93ICdlcnInO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwb3RpZnlQbGF5bGlzdCA9IGF3YWl0IHRoaXMuaW50ZXJuYWwuZ2V0UGxheWxpc3QoaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNwb3RpZnlQbGF5bGlzdCkgdGhyb3cgJ2Vycic7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxheWxpc3QgPSBuZXcgUGxheWxpc3QodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNwb3RpZnlQbGF5bGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHNwb3RpZnlQbGF5bGlzdC5uYW1lID8/ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzcG90aWZ5UGxheWxpc3QudGh1bWJuYWlsID8/ICdodHRwczovL3d3dy5zY2RuLmNvL2kvX2dsb2JhbC90d2l0dGVyX2NhcmQtZGVmYXVsdC5qcGcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYXlsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Nwb3RpZnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc3BvdGlmeVBsYXlsaXN0LmF1dGhvciA/PyAnVW5rbm93biBBcnRpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbnVsbCBhcyB1bmtub3duIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogc3BvdGlmeVBsYXlsaXN0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzcG90aWZ5UGxheWxpc3QudXJsIHx8IHF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmF3UGxheWxpc3Q6IHNwb3RpZnlQbGF5bGlzdFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSBzcG90aWZ5UGxheWxpc3QudHJhY2tzLm1hcCgoc3BvdGlmeURhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzcG90aWZ5RGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7c3BvdGlmeURhdGEudGl0bGV9IGJ5ICR7c3BvdGlmeURhdGEuYXJ0aXN0fWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBzcG90aWZ5RGF0YS5hcnRpc3QgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNwb3RpZnlEYXRhLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHNwb3RpZnlEYXRhLnRodW1ibmFpbCB8fCAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhzcG90aWZ5RGF0YS5kdXJhdGlvbiA/PyAwKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBRdWVyeVR5cGUuU1BPVElGWV9TT05HXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9KSBhcyBUcmFja1tdO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0LCB0cmFja3M6IHBsYXlsaXN0LnRyYWNrcyB9O1xuICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcG90aWZ5UGxheWxpc3Q6IFNwb3RpZnlQbGF5bGlzdCB8IHZvaWQgPSBhd2FpdCB0aGlzLl9saWIuZ2V0RGF0YShxdWVyeSwgY29udGV4dC5yZXF1ZXN0T3B0aW9ucyBhcyB1bmtub3duIGFzIFJlcXVlc3RJbml0KS5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNwb3RpZnlQbGF5bGlzdCkgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwbGF5bGlzdCA9IG5ldyBQbGF5bGlzdCh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogc3BvdGlmeVBsYXlsaXN0Lm5hbWUgPz8gc3BvdGlmeVBsYXlsaXN0LnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHNwb3RpZnlQbGF5bGlzdC50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc3BvdGlmeVBsYXlsaXN0LmNvdmVyQXJ0Py5zb3VyY2VzPy5bMF0/LnVybCA/PyAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHNwb3RpZnlQbGF5bGlzdC50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBzcG90aWZ5UGxheWxpc3Quc3VidGl0bGUgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG51bGwgYXMgdW5rbm93biBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFja3M6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNwb3RpZnlQbGF5bGlzdC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc3BvdGlmeVBsYXlsaXN0LmlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS9wbGF5bGlzdC8ke3Nwb3RpZnlQbGF5bGlzdC5pZH1gIDogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICByYXdQbGF5bGlzdDogc3BvdGlmeVBsYXlsaXN0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHBsYXlsaXN0LnRyYWNrcyA9IHNwb3RpZnlQbGF5bGlzdC50cmFja0xpc3QubWFwKChtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbS50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbS50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IG0uc3VidGl0bGUgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG0udWlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS90cmFja3MvJHttLnVpZH1gIDogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhtLmR1cmF0aW9uKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWxpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAnc3BvdGlmeVNvbmcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9KSBhcyBUcmFja1tdO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0LCB0cmFja3M6IHBsYXlsaXN0LnRyYWNrcyB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLlNQT1RJRllfQUxCVU06IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHF1ZXJ5VHlwZSwgaWQgfSA9IHRoaXMucGFyc2UocXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlUeXBlICE9PSAnYWxidW0nKSB0aHJvdyAnZXJyJztcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcG90aWZ5QWxidW0gPSBhd2FpdCB0aGlzLmludGVybmFsLmdldEFsYnVtKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzcG90aWZ5QWxidW0pIHRocm93ICdlcnInO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzcG90aWZ5QWxidW0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzcG90aWZ5QWxidW0ubmFtZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc3BvdGlmeUFsYnVtLnRodW1ibmFpbCA/PyAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhbGJ1bScsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzcG90aWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNwb3RpZnlBbGJ1bS5hdXRob3IgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG51bGwgYXMgdW5rbm93biBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFja3M6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNwb3RpZnlBbGJ1bS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc3BvdGlmeUFsYnVtLnVybCB8fCBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBzcG90aWZ5QWxidW1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcGxheWxpc3QudHJhY2tzID0gc3BvdGlmeUFsYnVtLnRyYWNrcy5tYXAoKHNwb3RpZnlEYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogc3BvdGlmeURhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGAke3Nwb3RpZnlEYXRhLnRpdGxlfSBieSAke3Nwb3RpZnlEYXRhLmFydGlzdH1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogc3BvdGlmeURhdGEuYXJ0aXN0ID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzcG90aWZ5RGF0YS51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzcG90aWZ5RGF0YS50aHVtYm5haWwgfHwgJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMoc3BvdGlmeURhdGEuZHVyYXRpb24gPz8gMCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Nwb3RpZnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogUXVlcnlUeXBlLlNQT1RJRllfU09OR1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmV4dHJhY3RvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfSkgYXMgVHJhY2tbXTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdCwgdHJhY2tzOiBwbGF5bGlzdC50cmFja3MgfTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxidW06IFNwb3RpZnlBbGJ1bSB8IHZvaWQgPSBhd2FpdCB0aGlzLl9saWIuZ2V0RGF0YShxdWVyeSwgY29udGV4dC5yZXF1ZXN0T3B0aW9ucyBhcyB1bmtub3duIGFzIFJlcXVlc3RJbml0KS5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFsYnVtKSByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBhbGJ1bS5uYW1lID8/IGFsYnVtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGFsYnVtLnRpdGxlID8/ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBhbGJ1bS5jb3ZlckFydD8uc291cmNlcz8uWzBdPy51cmwgPz8gJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBhbGJ1bS50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBhbGJ1bS5zdWJ0aXRsZSA/PyAnVW5rbm93biBBcnRpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbnVsbCBhcyB1bmtub3duIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogYWxidW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGFsYnVtLmlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS9wbGF5bGlzdC8ke2FsYnVtLmlkfWAgOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBhbGJ1bVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSBhbGJ1bS50cmFja0xpc3QubWFwKChtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbS50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbS50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IG0uc3VidGl0bGUgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG0udWlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS90cmFja3MvJHttLnVpZH1gIDogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhtLmR1cmF0aW9uKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWxpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAnc3BvdGlmeVNvbmcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9KSBhcyBUcmFja1tdO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0LCB0cmFja3M6IHBsYXlsaXN0LnRyYWNrcyB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzdHJlYW0oaW5mbzogVHJhY2spOiBQcm9taXNlPHN0cmluZyB8IFJlYWRhYmxlPiB7XG4gICAgICAgIGlmICghdGhpcy5fc3RyZWFtKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBpbml0aWFsaXplIHN0cmVhbWluZyBhcGkgZm9yICcke3RoaXMuY29uc3RydWN0b3IubmFtZX0nYCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXJsID0gaW5mby51cmw7XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzWXRkbCkge1xuICAgICAgICAgICAgaWYgKFlvdXR1YmVFeHRyYWN0b3IudmFsaWRhdGVVUkwoaW5mby5yYXcudXJsKSkgdXJsID0gaW5mby5yYXcudXJsO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgX3VybCA9IGF3YWl0IG1ha2VZVFNlYXJjaChgJHtpbmZvLnRpdGxlfSAke2luZm8uYXV0aG9yfWAsICd2aWRlbycpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyKSA9PiByWzBdLnVybClcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgICAgICAgICAgaWYgKCFfdXJsKSB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCByZXNvdXJjZXMgZm9yIHl0ZGwgc3RyZWFtaW5nJyk7XG4gICAgICAgICAgICAgICAgaW5mby5yYXcudXJsID0gdXJsID0gX3VybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW0odXJsKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcGFyc2UocTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IFssIHF1ZXJ5VHlwZSwgaWRdID0gcmUuZXhlYyhxKSB8fCBbXTtcblxuICAgICAgICByZXR1cm4geyBxdWVyeVR5cGUsIGlkIH07XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7QUNDQSw0QkFTTztBQUNQLGdDQUE2QjtBQUU3QixJQUFNLGFBQWEsSUFBSSxpQ0FBTyxRQUFXO0FBQUEsRUFDckMsYUFBYTtBQUNqQixDQUFDO0FBRU0sSUFBTSxzQkFBTixjQUFrQyxvQ0FBYztBQUFBLEVBR25ELE1BQWEsU0FBUyxPQUFlLE1BQTZEO0FBQzlGLFFBQUksT0FBTyxVQUFVO0FBQVUsYUFBTztBQUV0QyxXQUFRO0FBQUEsTUFDSixnQ0FBVTtBQUFBLE1BQ1YsZ0NBQVU7QUFBQSxNQUNWLGdDQUFVO0FBQUEsTUFDVixnQ0FBVTtBQUFBLE1BQ1YsZ0NBQVU7QUFBQSxNQUNWLGdDQUFVO0FBQUEsSUFDZCxFQUF3QixLQUFLLENBQUMsTUFBTSxNQUFNLElBQUk7QUFBQSxFQUNsRDtBQUFBLEVBRUEsTUFBYSxpQkFBaUIsT0FBYztBQUN4QyxRQUFJLE1BQU0sY0FBYyxnQ0FBVTtBQUM5QixhQUFPLEtBQUssT0FBTyxNQUFNLFVBQVUsTUFBTSxPQUFPO0FBQUEsUUFDNUMsYUFBYSxNQUFNO0FBQUEsUUFDbkIsTUFBTSxnQ0FBVTtBQUFBLE1BQ3BCLENBQUM7QUFFTCxXQUFPLEtBQUssZUFBZTtBQUFBLEVBQy9CO0FBQUEsRUFFQSxNQUFhLE9BQU8sT0FBZSxTQUF5RDtBQUN4RixZQUFRLFFBQVEsTUFBTTtBQUFBLE1BQ2xCLEtBQUssZ0NBQVUsa0JBQWtCO0FBQzdCLGNBQU0sWUFBWSxNQUFNLFdBQ25CLFlBQVksT0FBTztBQUFBLFVBQ2hCLGVBQWU7QUFBQSxVQUNmLFlBQVk7QUFBQSxVQUNaLGdCQUFnQjtBQUFBLFFBQ3BCLENBQUMsRUFDQSxNQUFNLDJCQUFLLElBQUk7QUFFcEIsWUFBSSxDQUFDO0FBQVcsaUJBQU8sS0FBSyxjQUFjO0FBRTFDLGNBQU0sUUFBUSxJQUFJLDRCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsVUFDekMsT0FBTyxVQUFVO0FBQUEsVUFDakIsS0FBSyxVQUFVO0FBQUEsVUFDZixVQUFVLDJCQUFLLGNBQWMsMkJBQUssUUFBUSxVQUFVLFFBQVEsQ0FBQztBQUFBLFVBQzdELGFBQWEsVUFBVTtBQUFBLFVBQ3ZCLFdBQVcsVUFBVTtBQUFBLFVBQ3JCLE9BQU8sVUFBVTtBQUFBLFVBQ2pCLFFBQVEsVUFBVSxPQUFPO0FBQUEsVUFDekIsYUFBYSxRQUFRO0FBQUEsVUFDckIsUUFBUTtBQUFBLFVBQ1IsUUFBUTtBQUFBLFVBQ1IsV0FBVyxRQUFRO0FBQUEsUUFDdkIsQ0FBQztBQUVELGNBQU0sWUFBWTtBQUVsQixlQUFPLEVBQUUsVUFBVSxNQUFNLFFBQVEsQ0FBQyxLQUFLLEVBQUU7QUFBQSxNQUM3QztBQUFBLE1BQ0EsS0FBSyxnQ0FBVSxxQkFBcUI7QUFDaEMsY0FBTSxPQUFPLE1BQU0sV0FDZCxZQUFZLE9BQU87QUFBQSxVQUNoQixZQUFZO0FBQUEsUUFDaEIsQ0FBQyxFQUNBLE1BQU0sMkJBQUssSUFBSTtBQUNwQixZQUFJLENBQUM7QUFBTSxpQkFBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLENBQUMsRUFBRTtBQUUvQyxjQUFNLE1BQU0sSUFBSSwrQkFBUyxLQUFLLFFBQVEsUUFBUTtBQUFBLFVBQzFDLE9BQU8sS0FBSztBQUFBLFVBQ1osYUFBYSxLQUFLLGVBQWU7QUFBQSxVQUNqQyxXQUFXLEtBQUssYUFBYTtBQUFBLFVBQzdCLE1BQU07QUFBQSxVQUNOLFFBQVE7QUFBQSxVQUNSLFFBQVE7QUFBQSxZQUNKLE1BQU0sS0FBSyxRQUFRLFFBQVEsS0FBSyxRQUFRLFlBQVk7QUFBQSxZQUNwRCxLQUFLLEtBQUssUUFBUTtBQUFBLFVBQ3RCO0FBQUEsVUFDQSxRQUFRLENBQUM7QUFBQSxVQUNULElBQUksR0FBRyxLQUFLO0FBQUEsVUFDWixLQUFLLEtBQUs7QUFBQSxVQUNWLGFBQWE7QUFBQSxRQUNqQixDQUFDO0FBRUQsbUJBQVcsUUFBUSxLQUFLLFFBQVE7QUFDNUIsZ0JBQU0sUUFBUSxJQUFJLDRCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsWUFDekMsT0FBTyxLQUFLO0FBQUEsWUFDWixhQUFhLEtBQUssZUFBZTtBQUFBLFlBQ2pDLFFBQVEsS0FBSyxRQUFRLFlBQVksS0FBSyxRQUFRLFFBQVE7QUFBQSxZQUN0RCxLQUFLLEtBQUs7QUFBQSxZQUNWLFdBQVcsS0FBSztBQUFBLFlBQ2hCLFVBQVUsMkJBQUssY0FBYywyQkFBSyxRQUFRLEtBQUssUUFBUSxDQUFDO0FBQUEsWUFDeEQsT0FBTyxLQUFLLGFBQWE7QUFBQSxZQUN6QixhQUFhLFFBQVE7QUFBQSxZQUNyQixVQUFVO0FBQUEsWUFDVixRQUFRO0FBQUEsWUFDUixRQUFRO0FBQUEsWUFDUixXQUFXLFFBQVE7QUFBQSxVQUN2QixDQUFDO0FBQ0QsZ0JBQU0sWUFBWTtBQUNsQixjQUFJLE9BQU8sS0FBSyxLQUFLO0FBQUEsUUFDekI7QUFFQSxlQUFPLEVBQUUsVUFBVSxLQUFLLFFBQVEsSUFBSSxPQUFPO0FBQUEsTUFDL0M7QUFBQSxNQUNBLFNBQVM7QUFDTCxjQUFNLFNBQVMsTUFBTSxXQUFXLE9BQU8sT0FBTyxPQUFPLEVBQUUsTUFBTSwyQkFBSyxJQUFJO0FBQ3RFLFlBQUksQ0FBQyxVQUFVLENBQUMsT0FBTztBQUFRLGlCQUFPLEtBQUssY0FBYztBQUV6RCxjQUFNLGlCQUEwQixDQUFDO0FBRWpDLG1CQUFXLGlCQUFpQixRQUFRO0FBQ2hDLGdCQUFNLFlBQVksTUFBTSxXQUNuQixZQUFZLGNBQWMsS0FBSztBQUFBLFlBQzVCLGdCQUFnQjtBQUFBLFlBQ2hCLGVBQWU7QUFBQSxZQUNmLFlBQVk7QUFBQSxVQUNoQixDQUFDLEVBQ0EsTUFBTSwyQkFBSyxJQUFJO0FBQ3BCLGNBQUksQ0FBQztBQUFXO0FBRWhCLGdCQUFNLFFBQVEsSUFBSSw0QkFBTSxLQUFLLFFBQVEsUUFBUTtBQUFBLFlBQ3pDLE9BQU8sVUFBVTtBQUFBLFlBQ2pCLEtBQUssVUFBVTtBQUFBLFlBQ2YsVUFBVSwyQkFBSyxjQUFjLDJCQUFLLFFBQVEsVUFBVSxRQUFRLENBQUM7QUFBQSxZQUM3RCxhQUFhLFVBQVU7QUFBQSxZQUN2QixXQUFXLFVBQVU7QUFBQSxZQUNyQixPQUFPLFVBQVU7QUFBQSxZQUNqQixRQUFRLFVBQVUsT0FBTztBQUFBLFlBQ3pCLGFBQWEsUUFBUTtBQUFBLFlBQ3JCLFFBQVE7QUFBQSxZQUNSLFFBQVE7QUFBQSxZQUNSLFdBQVc7QUFBQSxVQUNmLENBQUM7QUFFRCxnQkFBTSxZQUFZO0FBRWxCLHlCQUFlLEtBQUssS0FBSztBQUFBLFFBQzdCO0FBRUEsZUFBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLGVBQWU7QUFBQSxNQUNwRDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFTyxnQkFBK0I7QUFDbEMsV0FBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLENBQUMsRUFBRTtBQUFBLEVBQ3hDO0FBQUEsRUFFQSxNQUFhLE9BQU8sTUFBYTtBQUM3QixVQUFNLFNBQVMsS0FBSyxJQUFJO0FBQ3hCLFFBQUksVUFBVSxPQUFPLFdBQVc7QUFDNUIsYUFBTyxPQUFPO0FBQUEsSUFDbEI7QUFFQSxVQUFNLE1BQU0sTUFBTSxXQUFXLGVBQWUsS0FBSyxHQUFHLEVBQUUsTUFBTSwyQkFBSyxJQUFJO0FBQ3JFLFFBQUksQ0FBQztBQUFLLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUUzRSxRQUFJLFFBQVE7QUFDUixhQUFPLFlBQVk7QUFBQSxJQUN2QixPQUFPO0FBQ0gsV0FBSyxJQUFJLFNBQVM7QUFBQSxRQUNkLFdBQVc7QUFBQSxNQUNmO0FBQUEsSUFDSjtBQUVBLFdBQU87QUFBQSxFQUNYO0FBQ0o7QUFyS2E7QUFBQSxvQkFDSyxhQUFhOzs7QUNsQi9CLElBQUFBLHFCQUErQjtBQUcvQixJQUFBQyx5QkFTTzs7O0FDWlAsd0JBQXdCO0FBRXhCLElBQUk7QUFNRyxJQUFNLGVBQWUsd0JBQUMsUUFBZ0IsT0FBTyxLQUFLLE1BQU0sTUFBTSxJQUFJLEdBQTdDO0FBQ3JCLElBQU0sS0FBSztBQUVYLElBQU0sY0FBYztBQUFBLEVBQ3ZCO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFFSjtBQUdBLElBQU0sWUFBWSxRQUFRLElBQUk7QUFDOUIsSUFBSTtBQUFXLGNBQVksUUFBUSxTQUFTO0FBRXJDLElBQU0sV0FDVCxPQUFPLFVBQVUsY0FDWCxRQUNBLE9BQU8sTUFBbUIsU0FBMEM7QUFFaEUsTUFBSTtBQUdKLE1BQUssS0FBSyxNQUFNLGFBQWEsUUFBUSxHQUFJO0FBQ3JDLFlBQVEsR0FBRyxTQUFTLEdBQUcsUUFBUSxPQUFPLE1BQU0sSUFBSTtBQUFBLEVBQ3BELFdBQVksS0FBSyxNQUFNLGFBQWEsWUFBWSxHQUFJO0FBQ2hELFlBQVEsR0FBRyxTQUFTLEdBQUcsU0FBUyxNQUFNLElBQUk7QUFBQSxFQUM5QyxPQUFPO0FBQ0gsVUFBTSxJQUFJLE1BQU0sb0JBQW9CO0FBQUEsRUFDeEM7QUFHSjtBQUtWLGVBQXNCLFNBQVMsU0FBZSxRQUFRLE9BQU87QUFDekQsTUFBSSxXQUFXLENBQUM7QUFBTyxXQUFPO0FBRzlCLE1BQUksS0FBVSxZQUFvQjtBQUVsQyxhQUFXLFNBQVMsYUFBYTtBQUM3QixVQUFNLE1BQU0sT0FBTyxPQUFPO0FBQUEsTUFDdEIsQ0FBQyxNQUFNO0FBQUEsTUFDUCxNQUFNO0FBQUEsSUFDVjtBQUNBLFFBQUksQ0FBQztBQUFLO0FBQ1YsVUFBTSxJQUFJLFdBQVc7QUFDckIsaUJBQWE7QUFDYjtBQUFBLEVBQ0o7QUFFQSxNQUFJLEtBQUs7QUFDTCxVQUFNLFNBQVMsQ0FBQyxhQUFhLG9CQUFvQixFQUFFLEtBQUssQ0FBQ0MsU0FBUUEsU0FBUSxVQUFVO0FBRW5GLGNBQVUsOEJBQU8sVUFBVTtBQUN2QixVQUFJLFFBQVE7QUFDUixjQUFNLEtBQUs7QUFDWCxjQUFNLE9BQU8sTUFBTSxHQUFHLFFBQVEsT0FBTyxPQUFPO0FBRTVDLGNBQU0sVUFBVSxLQUFLLFFBQ2hCLE9BQU8sQ0FBQyxXQUFXO0FBQ2hCLGlCQUFPLEtBQUssYUFBYSxnQkFBZ0IsT0FBTyxTQUFTLE9BQU8sV0FBVyxPQUFPO0FBQUEsUUFDdEYsQ0FBQyxFQUNBLEtBQUssQ0FBQyxHQUFHLE1BQU0sT0FBTyxFQUFFLFlBQVksSUFBSSxPQUFPLEVBQUUsWUFBWSxLQUFLLE9BQU8sRUFBRSxPQUFPLElBQUksT0FBTyxFQUFFLE9BQU8sQ0FBQztBQUU1RyxjQUFNLE1BQU0sUUFBUSxLQUFLLENBQUMsV0FBVyxDQUFDLE9BQU8sUUFBUSxLQUFLLFFBQVEsS0FBSyxDQUFDLEdBQUcsTUFBTSxPQUFPLEVBQUUsT0FBTyxJQUFJLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRTtBQUN4SCxlQUFPLElBQUk7QUFBQSxNQUVmLE9BQU87QUFDSCxjQUFNLEtBQUs7QUFFWCxjQUFNLE9BQU8sTUFBTSxHQUFHLFdBQVcsS0FBSztBQUN0QyxjQUFNLFVBQVUsS0FBSyxPQUNoQixPQUFPLENBQUMsV0FBVztBQUNoQixnQkFBTUMsTUFBSztBQUNYLGNBQUksQ0FBQyxPQUFPO0FBQUssbUJBQU87QUFDeEIsY0FBSSxLQUFLLGNBQWM7QUFBTSxtQkFBT0EsSUFBRyxLQUFLLE9BQU8sR0FBRyxLQUFLLE9BQU8sT0FBTyxZQUFZO0FBQ3JGLGlCQUFPLE9BQU8sT0FBTyxZQUFZO0FBQUEsUUFDckMsQ0FBQyxFQUNBLEtBQUssQ0FBQyxHQUFHLE1BQU0sT0FBTyxFQUFFLE9BQU8sSUFBSSxPQUFPLEVBQUUsT0FBTyxDQUFDO0FBRXpELGNBQU0sTUFBTSxRQUFRLEtBQUssQ0FBQyxXQUFXLENBQUMsT0FBTyxZQUFZLEtBQUssUUFBUSxLQUFLLENBQUMsR0FBRyxNQUFNLE9BQU8sRUFBRSxPQUFPLElBQUksT0FBTyxFQUFFLE9BQU8sQ0FBQyxFQUFFO0FBQzVILGVBQU8sSUFBSTtBQUFBLE1BRWY7QUFBQSxJQUNKLEdBL0JVO0FBQUEsRUFnQ2QsT0FBTztBQUNILFVBQU0sSUFBSSxNQUFNLGtEQUFrRCxZQUFZLElBQUksQ0FBQ0QsU0FBUSxJQUFJQSxPQUFNLEVBQUUsS0FBSyxJQUFJLEdBQUc7QUFBQSxFQUN2SDtBQUVBLFlBQVUsRUFBRSxNQUFNLFlBQWEsUUFBUSxTQUFTLElBQUk7QUFDcEQsU0FBTztBQUNYO0FBMURzQjtBQTZEdEIsZUFBc0IsYUFBYSxPQUFlLEtBQVU7QUFDeEQsUUFBTSxNQUFNLE1BQU0sMEJBQVEsT0FBTyxPQUFPO0FBQUEsSUFDcEMsTUFBTTtBQUFBLElBQ04sZ0JBQWdCO0FBQUEsRUFDcEIsQ0FBQyxFQUFFLE1BQU0sTUFBTTtBQUFBLEVBRWYsQ0FBQztBQUVELFNBQU8sT0FBTyxDQUFDO0FBQ25CO0FBVHNCOzs7QUR2RnRCLElBQU0sb0JBQW9CLG9CQUFJLElBQUksQ0FBQyxlQUFlLG1CQUFtQixpQkFBaUIscUJBQXFCLG9CQUFvQixDQUFDO0FBQ2hJLElBQU0sbUJBQW1CO0FBQ3pCLElBQU0sVUFBVTtBQU1ULElBQU0sb0JBQU4sY0FBK0IscUNBQW9DO0FBQUEsRUFLdEUsTUFBYSxXQUFXO0FBQ3BCLFVBQU0sS0FBSyxLQUFLLFFBQVE7QUFFeEIsUUFBSSxPQUFPLE9BQU8sWUFBWTtBQUMxQixXQUFLLFVBQVUsQ0FBQyxNQUFjO0FBQzFCLGVBQU8sR0FBRyxNQUFNLENBQUM7QUFBQSxNQUNyQjtBQUVBO0FBQUEsSUFDSjtBQUVBLFVBQU0sRUFBRSxRQUFRLEtBQUssSUFBSSxNQUFNLFNBQVMsS0FBSyxRQUFRLE9BQU8sUUFBUSxXQUFXO0FBQy9FLFNBQUssVUFBVTtBQUNmLFNBQUssYUFBYTtBQUFBLEVBQ3RCO0FBQUEsRUFFQSxNQUFhLFNBQVMsT0FBZSxNQUE2RDtBQUM5RixRQUFJLE9BQU8sVUFBVTtBQUFVLGFBQU87QUFFdEMsV0FBUTtBQUFBLE1BQ0osaUNBQVU7QUFBQSxNQUNWLGlDQUFVO0FBQUEsTUFDVixpQ0FBVTtBQUFBLE1BQ1YsaUNBQVU7QUFBQSxNQUNWLGlDQUFVO0FBQUEsTUFDVixpQ0FBVTtBQUFBLElBQ2QsRUFBd0IsS0FBSyxDQUFDLE1BQU0sTUFBTSxJQUFJO0FBQUEsRUFDbEQ7QUFBQSxFQUVBLE1BQWEsT0FBTyxPQUFlLFNBQXlEO0FBQ3hGLFlBQVEsTUFBTSxTQUFTLGFBQWEsSUFBSSxNQUFNLFFBQVEsdUJBQXVCLEVBQUUsSUFBSTtBQUNuRixRQUFJLGtCQUFpQixZQUFZLEtBQUs7QUFBRyxjQUFRLE9BQU8saUNBQVU7QUFFbEUsWUFBUSxRQUFRLE1BQU07QUFBQSxNQUNsQixLQUFLLGlDQUFVLGtCQUFrQjtBQUM3QixjQUFNLE9BQU8sTUFBTSwyQkFBUSxZQUFZLE9BQU87QUFBQSxVQUMxQyxVQUFVO0FBQUEsVUFDVixnQkFBZ0IsUUFBUTtBQUFBLFFBQzVCLENBQUMsRUFBRSxNQUFNLDRCQUFLLElBQUk7QUFDbEIsWUFBSSxDQUFDO0FBQU0saUJBQU8sS0FBSyxjQUFjO0FBRXJDLGNBQU0sV0FBVyxJQUFJLGdDQUFTLEtBQUssUUFBUSxRQUFRO0FBQUEsVUFDL0MsT0FBTyxLQUFLO0FBQUEsVUFDWixXQUFXLEtBQUs7QUFBQSxVQUNoQixhQUFhLEtBQUssU0FBUztBQUFBLFVBQzNCLE1BQU07QUFBQSxVQUNOLFFBQVE7QUFBQSxVQUNSLFFBQVE7QUFBQSxZQUNKLE1BQU0sS0FBSyxRQUFTO0FBQUEsWUFDcEIsS0FBSyxLQUFLLFFBQVM7QUFBQSxVQUN2QjtBQUFBLFVBQ0EsUUFBUSxDQUFDO0FBQUEsVUFDVCxJQUFJLEtBQUs7QUFBQSxVQUNULEtBQUssS0FBSztBQUFBLFVBQ1YsYUFBYTtBQUFBLFFBQ2pCLENBQUM7QUFFRCxpQkFBUyxTQUFTLEtBQUssT0FBTyxJQUFJLENBQUMsVUFBVTtBQUN6QyxnQkFBTSxRQUFRLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxZQUN6QyxPQUFPLE1BQU07QUFBQSxZQUNiLGFBQWEsTUFBTTtBQUFBLFlBQ25CLFFBQVEsTUFBTSxTQUFTO0FBQUEsWUFDdkIsS0FBSyxNQUFNO0FBQUEsWUFDWCxhQUFhLFFBQVE7QUFBQSxZQUNyQixXQUFXLE1BQU0sVUFBVztBQUFBLFlBQzVCLE9BQU8sTUFBTTtBQUFBLFlBQ2IsVUFBVSxNQUFNO0FBQUEsWUFDaEIsS0FBSztBQUFBLFlBQ0w7QUFBQSxZQUNBLFFBQVE7QUFBQSxZQUNSLFdBQVc7QUFBQSxVQUNmLENBQUM7QUFFRCxnQkFBTSxZQUFZO0FBQ2xCLGlCQUFPO0FBQUEsUUFDWCxDQUFDO0FBRUQsZUFBTyxFQUFFLFVBQVUsUUFBUSxTQUFTLE9BQU87QUFBQSxNQUMvQztBQUFBLE1BQ0EsS0FBSyxpQ0FBVSxlQUFlO0FBQzFCLGNBQU0sS0FBSyxvQkFBb0IsS0FBSyxLQUFLO0FBQ3pDLFlBQUksQ0FBQyxLQUFLO0FBQUksaUJBQU8sS0FBSyxjQUFjO0FBQ3hDLGNBQU0sUUFBUSxNQUFNLDJCQUFRLFNBQVMsbUNBQW1DLE1BQU0sUUFBUSxjQUF3QyxFQUFFLE1BQU0sNEJBQUssSUFBSTtBQUMvSSxZQUFJLENBQUM7QUFBTyxpQkFBTyxLQUFLLGNBQWM7QUFHdEMsY0FBTSxTQUFTO0FBRWYsY0FBTSxRQUFRLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxVQUN6QyxPQUFPLE1BQU07QUFBQSxVQUNiLGFBQWEsTUFBTTtBQUFBLFVBQ25CLFFBQVEsTUFBTSxTQUFTO0FBQUEsVUFDdkIsS0FBSyxNQUFNO0FBQUEsVUFDWCxhQUFhLFFBQVE7QUFBQSxVQUNyQixXQUFXLE1BQU0sV0FBVyxvQkFBb0IsZUFBZTtBQUFBLFVBQy9ELE9BQU8sTUFBTTtBQUFBLFVBQ2IsVUFBVSxNQUFNO0FBQUEsVUFDaEIsUUFBUTtBQUFBLFVBQ1IsS0FBSztBQUFBLFVBQ0wsV0FBVyxRQUFRO0FBQUEsUUFDdkIsQ0FBQztBQUVELGNBQU0sWUFBWTtBQUVsQixlQUFPO0FBQUEsVUFDSCxVQUFVO0FBQUEsVUFDVixRQUFRLENBQUMsS0FBSztBQUFBLFFBQ2xCO0FBQUEsTUFDSjtBQUFBLE1BQ0EsU0FBUztBQUNMLGNBQU0sU0FBUyxNQUFNLEtBQUssY0FBYyxPQUFPLE9BQU87QUFDdEQsZUFBTyxFQUFFLFVBQVUsTUFBTSxPQUFPO0FBQUEsTUFDcEM7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyxjQUFjLE9BQWUsU0FBaUM7QUFDeEUsVUFBTSxNQUFNLE1BQU0sYUFBYSxPQUFPLFFBQVEsY0FBYyxFQUFFLE1BQU0sNEJBQUssSUFBSTtBQUM3RSxRQUFJLENBQUMsT0FBTyxDQUFDLElBQUk7QUFBUSxhQUFPLENBQUM7QUFFakMsV0FBTyxJQUFJLElBQUksQ0FBQyxVQUFVO0FBRXRCLFlBQU0sU0FBUztBQUVmLFlBQU0sUUFBUSxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsUUFDekMsT0FBTyxNQUFNO0FBQUEsUUFDYixhQUFhLE1BQU07QUFBQSxRQUNuQixRQUFRLE1BQU0sU0FBUztBQUFBLFFBQ3ZCLEtBQUssTUFBTTtBQUFBLFFBQ1gsYUFBYSxRQUFRO0FBQUEsUUFDckIsV0FBVyxNQUFNLFdBQVcsb0JBQW9CLGVBQWU7QUFBQSxRQUMvRCxPQUFPLE1BQU07QUFBQSxRQUNiLFVBQVUsTUFBTTtBQUFBLFFBQ2hCLFFBQVE7QUFBQSxRQUNSLEtBQUs7QUFBQSxRQUNMLFdBQVcsUUFBUTtBQUFBLE1BQ3ZCLENBQUM7QUFFRCxZQUFNLFlBQVk7QUFFbEIsYUFBTztBQUFBLElBQ1gsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLE1BQWEsaUJBQWlCLE9BQWM7QUFDeEMsUUFBSTtBQUVKLFFBQUksa0JBQWlCLFlBQVksTUFBTSxHQUFHO0FBQ3RDLGFBQU8sTUFBTSwyQkFBUSxTQUFTLE1BQU0sR0FBRyxFQUNsQyxLQUFLLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFDcEIsTUFBTSw0QkFBSyxJQUFJO0FBR3hCLFFBQUksQ0FBQztBQUNELGFBQU8sTUFBTSwyQkFBUSxPQUFPLE1BQU0sVUFBVSxNQUFNLE9BQU8sRUFBRSxPQUFPLEdBQUcsTUFBTSxRQUFRLENBQUMsRUFDL0UsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUNiLE1BQU0sNEJBQUssSUFBSTtBQUV4QixRQUFJLENBQUMsTUFBTSxRQUFRO0FBQ2YsYUFBTyxLQUFLLGVBQWU7QUFBQSxJQUMvQjtBQUVBLFVBQU0sVUFBVSxLQUFLLElBQUksQ0FBQyxVQUFVO0FBQ2hDLFlBQU0sSUFBSSxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsUUFDckMsT0FBTyxNQUFNO0FBQUEsUUFDYixLQUFLLG1DQUFtQyxNQUFNO0FBQUEsUUFDOUMsVUFBVSxNQUFNLHFCQUFxQiw0QkFBSyxjQUFjLDRCQUFLLFFBQVEsTUFBTSxXQUFXLEdBQUksQ0FBQztBQUFBLFFBQzNGLGFBQWEsTUFBTTtBQUFBLFFBQ25CLFdBQVcsT0FBTyxNQUFNLGNBQWMsV0FBVyxNQUFNLFlBQWEsTUFBTSxVQUFXO0FBQUEsUUFDckYsT0FBTyxNQUFNO0FBQUEsUUFDYixRQUFRLE1BQU0sUUFBUztBQUFBLFFBQ3ZCLGFBQWEsTUFBTTtBQUFBLFFBQ25CLFFBQVE7QUFBQSxRQUNSLFdBQVc7QUFBQSxNQUNmLENBQUM7QUFFRCxRQUFFLFlBQVk7QUFFZCxhQUFPO0FBQUEsSUFDWCxDQUFDO0FBRUQsV0FBTyxLQUFLLGVBQWUsTUFBTSxPQUFPO0FBQUEsRUFDNUM7QUFBQSxFQUVPLGdCQUErQjtBQUNsQyxXQUFPLEVBQUUsVUFBVSxNQUFNLFFBQVEsQ0FBQyxFQUFFO0FBQUEsRUFDeEM7QUFBQSxFQUVBLE1BQWEsT0FBTyxNQUFhO0FBQzdCLFFBQUksQ0FBQyxLQUFLLFNBQVM7QUFDZixZQUFNLElBQUksTUFBTSw0REFBNEQsWUFBWSxLQUFLLElBQUksR0FBRztBQUFBLElBQ3hHO0FBRUEsUUFBSSxNQUFNLEtBQUs7QUFDZixVQUFNLElBQUksU0FBUyxhQUFhLElBQUksSUFBSSxRQUFRLHVCQUF1QixFQUFFLElBQUk7QUFFN0UsV0FBTyxLQUFLLFFBQVEsR0FBRztBQUFBLEVBQzNCO0FBQUEsRUFFQSxPQUFjLFlBQVksTUFBYztBQUNwQyxRQUFJO0FBQ0Esd0JBQWlCLFNBQVMsSUFBSTtBQUM5QixhQUFPO0FBQUEsSUFDWCxRQUFFO0FBQ0UsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFQSxPQUFjLFdBQVcsSUFBWTtBQUNqQyxXQUFPLFFBQVEsS0FBSyxHQUFHLEtBQUssQ0FBQztBQUFBLEVBQ2pDO0FBQUEsRUFFQSxPQUFjLFNBQVMsTUFBYztBQUNqQyxVQUFNLFNBQVMsSUFBSSxJQUFJLEtBQUssS0FBSyxDQUFDO0FBQ2xDLFFBQUksS0FBSyxPQUFPLGFBQWEsSUFBSSxHQUFHO0FBQ3BDLFFBQUksaUJBQWlCLEtBQUssS0FBSyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUk7QUFDM0MsWUFBTSxRQUFRLE9BQU8sU0FBUyxNQUFNLEdBQUc7QUFDdkMsV0FBSyxPQUFPLFNBQVMsYUFBYSxNQUFNLEtBQUssTUFBTTtBQUFBLElBQ3ZELFdBQVcsT0FBTyxZQUFZLENBQUMsa0JBQWtCLElBQUksT0FBTyxRQUFRLEdBQUc7QUFDbkUsWUFBTSxNQUFNLHNCQUFzQjtBQUFBLElBQ3RDO0FBQ0EsUUFBSSxDQUFDLElBQUk7QUFDTCxZQUFNLE1BQU0sdUJBQXVCLE9BQU87QUFBQSxJQUM5QztBQUNBLFNBQUssR0FBRyxVQUFVLEdBQUcsRUFBRTtBQUN2QixRQUFJLENBQUMsUUFBUSxXQUFXLEVBQUUsR0FBRztBQUN6QixZQUFNLFVBQVUsYUFBYSx1Q0FBNEMsUUFBUSxTQUFTLElBQUk7QUFBQSxJQUNsRztBQUNBLFdBQU87QUFBQSxFQUNYO0FBQ0o7QUEzT08sSUFBTSxtQkFBTjtBQUFNO0FBQUEsaUJBQ0ssYUFBYTs7O0FFM0IvQiwyQkFBdUM7QUFHdkMsSUFBSTtBQUVHLFNBQVMsZ0JBQWdCLFFBQWlCLE9BQWlCO0FBQzlELE1BQUksQ0FBQyxVQUFVLENBQUM7QUFBTyxhQUFTLElBQUkscUJBQUFFLE9BQWEsTUFBTTtBQUN2RCxTQUFPLEVBQUUsUUFBUSxPQUFPO0FBQzVCO0FBSGdCO0FBS2hCLFNBQVMsT0FBTyxPQUFlO0FBQzNCLFNBQU8sSUFBSSxRQUEyQixDQUFDLFNBQVMsV0FBVztBQUN2RCxRQUFJLE9BQU8sVUFBVTtBQUFVLGFBQU8sT0FBTyxJQUFJLFVBQVUsbURBQW1ELE9BQU8sU0FBUyxDQUFDO0FBRS9ILFdBQU8sTUFDRixPQUFPLEtBQUssRUFDWixLQUFLLE9BQU8sVUFBVTtBQUNuQixZQUFNLE9BQU87QUFBQSxRQUNULE9BQU8sTUFBTSxHQUFHO0FBQUEsUUFDaEIsV0FBVyxNQUFNLEdBQUc7QUFBQSxRQUNwQixJQUFJLE1BQU0sR0FBRztBQUFBLFFBQ2IsV0FBVyxNQUFNLEdBQUc7QUFBQSxRQUNwQixPQUFPLE1BQU0sR0FBRztBQUFBLFFBQ2hCLEtBQUssTUFBTSxHQUFHO0FBQUEsUUFDZCxRQUFRO0FBQUEsVUFDSixNQUFNLE1BQU0sR0FBRyxPQUFPO0FBQUEsVUFDdEIsSUFBSSxNQUFNLEdBQUcsT0FBTztBQUFBLFVBQ3BCLEtBQUssTUFBTSxHQUFHLE9BQU87QUFBQSxVQUNyQixPQUFPLE1BQU0sR0FBRyxPQUFPO0FBQUEsUUFDM0I7QUFBQSxRQUNBLFFBQVEsTUFBTSxNQUFNLEdBQUcsT0FBTyxLQUFLO0FBQUEsTUFDdkM7QUFFQSxjQUFRLElBQUk7QUFBQSxJQUNoQixDQUFDLEVBQ0EsTUFBTSxNQUFNO0FBQ1QsYUFBTyxJQUFJLE1BQU0sd0JBQXdCLENBQUM7QUFBQSxJQUM5QyxDQUFDO0FBQUEsRUFDVCxDQUFDO0FBQ0w7QUE3QlM7OztBQ1RULElBQUFDLHlCQVFPOzs7QUNSUCxrQkFBaUI7QUFDakIsbUJBQWtCO0FBR2xCLElBQU0sUUFBTixNQUFZO0FBQUEsRUFDUixjQUFjO0FBQ1YsVUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLLFlBQVkscUNBQXFDO0FBQUEsRUFDakY7QUFBQSxFQVdBLE9BQU8sU0FBUyxJQUF3QztBQUNwRCxXQUFPLElBQUksUUFBUSxPQUFPLFlBQVk7QUFDbEMsWUFBTSxPQUFPLE1BQU0sTUFBTSxRQUFRLEVBQUU7QUFDbkMsVUFBSSxDQUFDO0FBQU0sZUFBTztBQUVsQixZQUFNLGFBQWEsS0FBSyxPQUFPLFdBQVcsVUFBVSxJQUFJLGFBQUFDLFVBQVEsWUFBQUM7QUFFaEUsaUJBQVcsSUFBSSxLQUFLLFFBQVEsQ0FBQyxRQUFRO0FBQ2pDLGdCQUFRLEdBQUc7QUFBQSxNQUNmLENBQUM7QUFBQSxJQUNMLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFNQSxhQUFhLFFBQVEsSUFBZ0Q7QUFDakUsUUFBSSxDQUFDO0FBQUksWUFBTSxJQUFJLE1BQU0sWUFBWTtBQUNyQyxVQUFNLE1BQU0sa0NBQWtDO0FBRTlDLFFBQUk7QUFDQSxZQUFNLE1BQU0sTUFBTSxTQUFTLEdBQUc7QUFDOUIsWUFBTSxPQUFPLE1BQU0sSUFBSSxLQUFLO0FBQzVCLFlBQU0sT0FBTyxLQUFLLE1BQU0sS0FBSyxNQUFNLHVCQUF1QixFQUFFLEdBQUcsTUFBTSxHQUFHLEVBQUUsR0FBRyxLQUFLLENBQUM7QUFFbkYsWUFBTSxNQUFNO0FBQUEsUUFDUixJQUFJLEtBQUssTUFBTTtBQUFBLFFBQ2YsVUFBVSxLQUFLLE1BQU0sV0FBVztBQUFBLFFBQ2hDLE9BQU8sS0FBSyxNQUFNO0FBQUEsUUFDbEIsS0FBSyxLQUFLLE1BQU07QUFBQSxRQUNoQixXQUFXLEtBQUssTUFBTSxPQUFPLFdBQVcsS0FBSyxNQUFNLE9BQU87QUFBQSxRQUMxRCxRQUFRLEtBQUssUUFBUSxNQUFNLFlBQVksR0FBRztBQUFBLFFBQzFDLFFBQVE7QUFBQSxVQUNKLElBQUksS0FBSyxNQUFNLE1BQU07QUFBQSxVQUNyQixNQUFNLEtBQUssTUFBTSxNQUFNO0FBQUEsVUFDdkIsS0FBSyxLQUFLLE1BQU0sTUFBTTtBQUFBLFVBQ3RCLFFBQVEsS0FBSyxNQUFNLE1BQU0sVUFBVSxLQUFLLE1BQU0sTUFBTTtBQUFBLFFBQ3hEO0FBQUEsTUFDSjtBQUVBLGFBQU87QUFBQSxJQUNYLFFBQUU7QUFDRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFDSjtBQTVETTs7O0FET0MsSUFBTSxpQkFBTixjQUE2QixxQ0FBYztBQUFBLEVBRzlDLE1BQWEsU0FBUyxPQUFlLE1BQTZEO0FBQzlGLFFBQUksT0FBTyxVQUFVO0FBQVUsYUFBTztBQUN0QyxXQUFRLENBQUMsaUNBQVUsS0FBSyxFQUF3QixLQUFLLENBQUMsTUFBTSxNQUFNLElBQUk7QUFBQSxFQUMxRTtBQUFBLEVBRUEsTUFBYSxpQkFBaUIsT0FBYztBQUV4QyxXQUFPLEtBQUssZUFBZTtBQUFBLEVBQy9CO0FBQUEsRUFFQSxNQUFhLE9BQU8sT0FBZSxTQUF5RDtBQUN4RixZQUFRLFFBQVEsTUFBTTtBQUFBLE1BQ2xCLEtBQUssaUNBQVUsT0FBTztBQUNsQixjQUFNLFlBQVksTUFBTSxNQUFNO0FBQUEsVUFDMUIsTUFDSyxNQUFNLEdBQUcsRUFDVCxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUNqQixJQUFJO0FBQUEsUUFDYixFQUFFLE1BQU0sNEJBQUssSUFBSTtBQUVqQixZQUFJLENBQUM7QUFBVyxpQkFBTyxLQUFLLGNBQWM7QUFFMUMsY0FBTSxRQUFRLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxVQUN6QyxPQUFPLFVBQVU7QUFBQSxVQUNqQixLQUFLLFVBQVU7QUFBQSxVQUNmLFVBQVUsNEJBQUssY0FBYyw0QkFBSyxRQUFRLFVBQVUsWUFBWSxDQUFDLENBQUM7QUFBQSxVQUNsRSxhQUFhLEdBQUcsVUFBVSxZQUFZLFVBQVUsT0FBTztBQUFBLFVBQ3ZELFdBQVcsVUFBVTtBQUFBLFVBQ3JCLE9BQU87QUFBQSxVQUNQLFFBQVEsVUFBVSxPQUFPO0FBQUEsVUFDekIsYUFBYSxRQUFRO0FBQUEsVUFDckIsUUFBUTtBQUFBLFVBQ1IsUUFBUSxVQUFVO0FBQUEsVUFDbEIsV0FBVyxRQUFRO0FBQUEsUUFDdkIsQ0FBQztBQUVELGNBQU0sWUFBWTtBQUVsQixlQUFPLEVBQUUsVUFBVSxNQUFNLFFBQVEsQ0FBQyxLQUFLLEVBQUU7QUFBQSxNQUM3QztBQUFBLE1BQ0E7QUFDSSxlQUFPLEtBQUssY0FBYztBQUFBLElBQ2xDO0FBQUEsRUFDSjtBQUFBLEVBRU8sZ0JBQStCO0FBQ2xDLFdBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEVBQUU7QUFBQSxFQUN4QztBQUFBLEVBRUEsTUFBYSxPQUFPLE1BQWE7QUFDN0IsVUFBTSxTQUFTLEtBQUssSUFBSTtBQUN4QixRQUFJLFFBQVE7QUFDUixhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sUUFBUSxNQUFNLE1BQU0sUUFBUSxLQUFLLEdBQUcsRUFBRSxNQUFNLDRCQUFLLElBQUk7QUFDM0QsUUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNO0FBQVEsWUFBTSxJQUFJLE1BQU0sMkNBQTJDO0FBRXhGLFNBQUssSUFBSSxTQUFTO0FBQUEsTUFDZCxXQUFXLE1BQU07QUFBQSxJQUNyQjtBQUVBLFdBQU8sTUFBTTtBQUFBLEVBQ2pCO0FBQ0o7QUFuRWE7QUFBQSxlQUNLLGFBQWE7OztBRVovQixJQUFBQyx5QkFRTztBQUNQLGtDQUF5QjtBQUVsQixJQUFNLHdCQUFOLGNBQW9DLHFDQUFjO0FBQUEsRUFHckQsTUFBYSxTQUFTLE9BQWUsTUFBNkQ7QUFDOUYsUUFBSSxPQUFPLFVBQVU7QUFBVSxhQUFPO0FBQ3RDLFdBQVEsQ0FBQyxpQ0FBVSxZQUFZLEVBQXdCLEtBQUssQ0FBQyxNQUFNLE1BQU0sSUFBSTtBQUFBLEVBQ2pGO0FBQUEsRUFFQSxNQUFhLGlCQUFpQixPQUFjO0FBRXhDLFdBQU8sS0FBSyxlQUFlO0FBQUEsRUFDL0I7QUFBQSxFQUVBLE1BQWEsT0FBTyxPQUFlLFNBQXlEO0FBQ3hGLFlBQVEsUUFBUSxNQUFNO0FBQUEsTUFDbEIsS0FBSyxpQ0FBVSxjQUFjO0FBQ3pCLGNBQU0sWUFBWSxNQUFNLDRCQUFBQyxRQUFhLFFBQVEsS0FBSyxFQUFFLE1BQU0sNEJBQUssSUFBSTtBQUVuRSxZQUFJLENBQUM7QUFBVyxpQkFBTyxLQUFLLGNBQWM7QUFFMUMsY0FBTSxRQUFRLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxVQUN6QyxPQUFPLFVBQVU7QUFBQSxVQUNqQixLQUFLLFVBQVU7QUFBQSxVQUNmLFVBQVUsNEJBQUssY0FBYyw0QkFBSyxRQUFRLFVBQVUsUUFBUSxDQUFDO0FBQUEsVUFDN0QsYUFBYSxVQUFVLFVBQVUsR0FBRyxVQUFVLFlBQVksVUFBVSxPQUFPO0FBQUEsVUFDM0UsV0FBVyxVQUFVO0FBQUEsVUFDckIsT0FBTztBQUFBLFVBQ1AsUUFBUSxVQUFVLE9BQU87QUFBQSxVQUN6QixhQUFhLFFBQVE7QUFBQSxVQUNyQixRQUFRO0FBQUEsVUFDUixRQUFRLFVBQVU7QUFBQSxVQUNsQixXQUFXLFFBQVE7QUFBQSxRQUN2QixDQUFDO0FBRUQsY0FBTSxZQUFZO0FBRWxCLGVBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEtBQUssRUFBRTtBQUFBLE1BQzdDO0FBQUEsTUFDQTtBQUNJLGVBQU8sS0FBSyxjQUFjO0FBQUEsSUFDbEM7QUFBQSxFQUNKO0FBQUEsRUFFTyxnQkFBK0I7QUFDbEMsV0FBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLENBQUMsRUFBRTtBQUFBLEVBQ3hDO0FBQUEsRUFFQSxNQUFhLE9BQU8sTUFBYTtBQUM3QixVQUFNLFNBQVMsS0FBSyxJQUFJO0FBQ3hCLFFBQUksUUFBUTtBQUNSLGFBQU87QUFBQSxJQUNYO0FBRUEsVUFBTSxRQUFRLE1BQU0sNEJBQUFBLFFBQWEsUUFBUSxLQUFLLEdBQUcsRUFBRSxNQUFNLDRCQUFLLElBQUk7QUFDbEUsUUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNO0FBQVcsWUFBTSxJQUFJLE1BQU0sMkNBQTJDO0FBRTNGLFNBQUssSUFBSSxTQUFTO0FBQUEsTUFDZCxXQUFXLE1BQU07QUFBQSxJQUNyQjtBQUVBLFdBQU8sTUFBTTtBQUFBLEVBQ2pCO0FBQ0o7QUE5RGE7QUFBQSxzQkFDSyxhQUFhOzs7QUNaL0IsSUFBQUMseUJBUU87QUFFUCxnQkFBNkM7OztBQ1g3QyxJQUFBQyxlQUFxQztBQUNyQyxJQUFBQyxnQkFBa0I7QUFHWCxTQUFTLGVBQWUsS0FBYSxPQUF1QixDQUFDLEdBQUc7QUFDbkUsU0FBTyxJQUFJLFFBQWtCLENBQUMsU0FBUyxXQUFXO0FBQzlDLFVBQU0sTUFBTSxJQUFJLFdBQVcsU0FBUyxJQUFJLGFBQUFDLFVBQU8sY0FBQUM7QUFFL0MsUUFBSSxJQUFJLEtBQUssTUFBTSxDQUFDLFFBQVEsUUFBUSxHQUFHLENBQUMsRUFBRSxLQUFLLFNBQVMsTUFBTTtBQUFBLEVBQ2xFLENBQUM7QUFDTDtBQU5nQjs7O0FEU2hCLGVBQTBCO0FBQzFCLGtCQUFpQjtBQUNqQixzQkFBcUI7QUFFZCxJQUFNLHNCQUFOLGNBQWtDLHFDQUFjO0FBQUEsRUFHbkQsTUFBYSxTQUFTLE9BQWUsTUFBNkQ7QUFDOUYsUUFBSSxPQUFPLFVBQVU7QUFBVSxhQUFPO0FBQ3RDLFdBQVEsQ0FBQyxpQ0FBVSxXQUFXLGlDQUFVLElBQUksRUFBd0IsS0FBSyxDQUFDLE1BQU0sTUFBTSxJQUFJO0FBQUEsRUFDOUY7QUFBQSxFQUVBLE1BQWEsaUJBQWlCLE9BQWM7QUFFeEMsV0FBTyxLQUFLLGVBQWU7QUFBQSxFQUMvQjtBQUFBLEVBRUEsTUFBYSxPQUFPLE9BQWUsU0FBeUQ7QUFDeEYsWUFBUSxRQUFRLE1BQU07QUFBQSxNQUNsQixLQUFLLGlDQUFVLFdBQVc7QUFDdEIsY0FBTSxPQUFRLE1BQU0sZUFBZSxPQUFPLFFBQVEsY0FBYztBQUNoRSxZQUFJLENBQUMsQ0FBQyxVQUFVLFFBQVEsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxRQUFRLGlCQUFpQixXQUFXLENBQUMsQ0FBQztBQUFHLGlCQUFPLEtBQUssY0FBYztBQUNoSCxjQUFNLFlBQVk7QUFBQSxVQUNkLFFBQ0ksTUFDSyxNQUFNLEdBQUcsRUFDVCxPQUFPLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFDdEIsSUFBSSxLQUFLLGNBRWIsTUFBTSxHQUFHLEVBQUUsR0FDWCxLQUFLO0FBQUEsVUFDVixVQUFVO0FBQUEsVUFDVixXQUFXO0FBQUEsVUFDWCxRQUFRO0FBQUEsVUFFUixRQUFVLEtBQWEsUUFBUSxjQUF5QjtBQUFBLFVBRXhELGFBQWUsS0FBYSxRQUFRLGNBQXlCO0FBQUEsVUFDN0QsS0FBSyxLQUFLLE9BQU87QUFBQSxRQUNyQjtBQUVBLGNBQU0sUUFBUSxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsVUFDekMsT0FBTyxVQUFVO0FBQUEsVUFDakIsS0FBSyxVQUFVO0FBQUEsVUFDZixVQUFVLDRCQUFLLGNBQWMsNEJBQUssUUFBUSxVQUFVLFFBQVEsQ0FBQztBQUFBLFVBQzdELGFBQWEsVUFBVTtBQUFBLFVBQ3ZCLFdBQVcsVUFBVTtBQUFBLFVBQ3JCLE9BQU87QUFBQSxVQUNQLFFBQVEsVUFBVTtBQUFBLFVBQ2xCLGFBQWEsUUFBUTtBQUFBLFVBQ3JCLFFBQVE7QUFBQSxVQUNSLFFBQVEsVUFBVTtBQUFBLFVBQ2xCLFdBQVcsUUFBUTtBQUFBLFFBQ3ZCLENBQUM7QUFFRCxjQUFNLFlBQVk7QUFHbEIsY0FBTSxJQUFJLFNBQVM7QUFFbkIsZUFBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLENBQUMsS0FBSyxFQUFFO0FBQUEsTUFDN0M7QUFBQSxNQUNBLEtBQUssaUNBQVUsTUFBTTtBQUNqQixZQUFJLEtBQUMsc0JBQVcsS0FBSztBQUFHLGlCQUFPLEtBQUssY0FBYztBQUNsRCxjQUFNLFFBQVEsVUFBTSxzQkFBSyxLQUFLO0FBQzlCLFlBQUksQ0FBQyxNQUFNLE9BQU87QUFBRyxpQkFBTyxLQUFLLGNBQWM7QUFDL0MsY0FBTSxPQUFPLE1BQWUsa0JBQVMsS0FBSyxFQUFFLE1BQU0sTUFBTSxJQUFJO0FBQzVELFlBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLFFBQVEsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxLQUFLLFdBQVcsQ0FBQyxDQUFDO0FBQUcsaUJBQU8sS0FBSyxjQUFjO0FBQ3JHLGNBQU0sWUFBWTtBQUFBLFVBQ2QsT0FBTyxZQUFBQyxRQUFLLFNBQVMsS0FBSyxLQUFLO0FBQUEsVUFDL0IsVUFBVTtBQUFBLFVBQ1YsV0FBVztBQUFBLFVBQ1gsUUFBUTtBQUFBLFVBQ1IsUUFBUTtBQUFBLFVBQ1IsYUFBYTtBQUFBLFVBQ2IsS0FBSztBQUFBLFFBQ1Q7QUFFQSxjQUFNLFFBQVEsSUFBSSw2QkFBTSxLQUFLLFFBQVEsUUFBUTtBQUFBLFVBQ3pDLE9BQU8sVUFBVTtBQUFBLFVBQ2pCLEtBQUssVUFBVTtBQUFBLFVBQ2YsVUFBVSw0QkFBSyxjQUFjLDRCQUFLLFFBQVEsVUFBVSxRQUFRLENBQUM7QUFBQSxVQUM3RCxhQUFhLFVBQVU7QUFBQSxVQUN2QixXQUFXLFVBQVU7QUFBQSxVQUNyQixPQUFPO0FBQUEsVUFDUCxRQUFRLFVBQVU7QUFBQSxVQUNsQixhQUFhLFFBQVE7QUFBQSxVQUNyQixRQUFRO0FBQUEsVUFDUixRQUFRLFVBQVU7QUFBQSxVQUNsQixXQUFXLFFBQVE7QUFBQSxRQUN2QixDQUFDO0FBRUQsY0FBTSxZQUFZO0FBR2xCLGNBQU0sSUFBSSxTQUFTO0FBRW5CLGVBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEtBQUssRUFBRTtBQUFBLE1BQzdDO0FBQUEsTUFDQTtBQUNJLGVBQU8sS0FBSyxjQUFjO0FBQUEsSUFDbEM7QUFBQSxFQUNKO0FBQUEsRUFFTyxnQkFBK0I7QUFDbEMsV0FBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLENBQUMsRUFBRTtBQUFBLEVBQ3hDO0FBQUEsRUFFQSxNQUFhLE9BQU8sTUFBYTtBQUM3QixVQUFNLFNBQVMsS0FBSyxJQUFJO0FBRXhCLFVBQU0sU0FBUyxLQUFLLElBQUk7QUFFeEIsUUFBSSxDQUFDO0FBQVEsWUFBTSxJQUFJLE1BQU0sOEJBQThCO0FBRTNELFFBQUksQ0FBQyxRQUFRO0FBQ1QsYUFBTztBQUFBLElBRVg7QUFFQSxlQUFPLDRCQUFpQixNQUFNO0FBQUEsRUFDbEM7QUFDSjtBQXRIYTtBQUFBLG9CQUNLLGFBQWE7OztBRWxCL0IsSUFBQUMseUJBQXdIOzs7QUNBeEg7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7OztBQ0NBLElBQUFDLHlCQUE4QjtBQUM5Qiw4QkFBbUM7QUFHbkMsU0FBUyxRQUFRLE1BQTJDO0FBQ3hELFNBQU8sU0FBUyxNQUFNO0FBQUEsSUFDbEIsU0FBUztBQUFBLE1BQ0wsY0FBYztBQUFBLElBQ2xCO0FBQUEsRUFDSixDQUFDLEVBQ0ksS0FBSyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsRUFDcEI7QUFBQSxJQUNHLENBQUMsWUFBUSwrQkFBTSxHQUFHO0FBQUEsSUFDbEIsTUFBTTtBQUFBLEVBQ1Y7QUFDUjtBQVhTO0FBYVQsU0FBUyxVQUFVLEVBQUUsUUFBUSxLQUFLLE9BQU8sTUFBTSxNQUFNLEdBQWlFO0FBQ2xILFNBQU8sSUFBSSxRQUFRLE9BQU8sR0FBRyxPQUFPLEVBQUUsUUFBUSxPQUFPLEdBQUcsUUFBUSxFQUFFLFFBQVEsT0FBTyxHQUFHO0FBQ3hGO0FBRlM7QUFJVCxTQUFTLGNBQWMsR0FBVztBQUM5QixRQUFNLElBQUksd0JBQUMsTUFBYyxTQUFpQixPQUFPLDBCQUEwQixVQUFqRTtBQUNWLFFBQU0sUUFBUSxJQUFJO0FBQUEsSUFDZDtBQUFBLE1BQ0k7QUFBQSxNQUNBLEVBQUUsU0FBUyxHQUFHO0FBQUEsTUFDZCxFQUFFLFVBQVUsR0FBRztBQUFBLE1BQ2YsRUFBRSxTQUFTLEdBQUc7QUFBQSxNQUNkLEVBQUUsUUFBUSxHQUFHO0FBQUEsTUFDYjtBQUFBLE1BQ0EsRUFBRSxTQUFTLEdBQUc7QUFBQSxNQUNkLEVBQUUsV0FBVyxHQUFHO0FBQUEsTUFDaEIsRUFBRSxXQUFXLEdBQUc7QUFBQSxNQUNoQjtBQUFBLElBQ0osRUFBRSxLQUFLLEVBQUU7QUFBQSxFQUNiO0FBQ0EsUUFBTSxPQUFPLE1BQU0sS0FBSyxDQUFDO0FBQ3pCLE1BQUksQ0FBQyxRQUFRLENBQUMsS0FBSztBQUFRLFdBQU87QUFFbEMsUUFBTSxNQUFNLENBQUMsS0FBSyxPQUFPLE9BQU8sS0FBSyxPQUFPLFFBQVEsS0FBSyxPQUFPLE9BQU8sS0FBSyxPQUFPLE1BQU0sS0FBSyxPQUFPLE9BQU8sS0FBSyxPQUFPLFNBQVMsS0FBSyxPQUFPLE9BQU87QUFFcEosU0FDSSxJQUNLLE9BQU8sQ0FBQ0MsSUFBRyxHQUFHLE1BQU0sQ0FBQyxDQUFDQSxNQUFLLElBQUksRUFBRSxTQUFTLENBQUMsRUFDM0MsSUFBSSxDQUFDLEdBQUcsTUFBTTtBQUNYLFFBQUksQ0FBQztBQUFHLFVBQUk7QUFDWixXQUFPLElBQUksSUFBSSxJQUFJLEVBQUUsU0FBUyxHQUFHLEdBQUc7QUFBQSxFQUN4QyxDQUFDLEVBQ0EsS0FBSyxHQUFHLEtBQUs7QUFFMUI7QUE5QlM7QUFnQ0YsSUFBTSxhQUFOLE1BQWlCO0FBQUEsRUFDYixjQUFjO0FBQ2pCLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxhQUFvQixPQUFPLE9BQWU7QUFDdEMsUUFBSTtBQUNBLFlBQU0sTUFBTSwwQ0FBMEMsbUJBQW1CLEtBQUs7QUFDOUUsWUFBTSxPQUFPLE1BQU0sUUFBUSxHQUFHO0FBQzlCLFVBQUksQ0FBQztBQUFNLGVBQU8sQ0FBQztBQUVuQixZQUFNLFVBQVUsS0FBSyxlQUFlLHdCQUF3QjtBQUM1RCxVQUFJLENBQUM7QUFBUyxlQUFPLENBQUM7QUFFdEIsWUFBTSxPQUFPLEtBQUssTUFBTSxRQUFRLFNBQVMsRUFBRSxHQUFHLEtBQUs7QUFDbkQsWUFBTSxTQUFTLEtBQUssS0FBSyxDQUFDLE1BQVcsRUFBRSxhQUFhLGFBQWEsR0FBRztBQUNwRSxVQUFJLENBQUM7QUFBUSxlQUFPLENBQUM7QUFFckIsYUFBTyxPQUFPLElBQUksQ0FBQyxXQUFnQjtBQUFBLFFBQy9CLElBQUksTUFBTSxrQkFBa0IsWUFBWTtBQUFBLFFBQ3hDLFVBQVUsTUFBTSxZQUFZO0FBQUEsUUFDNUIsT0FBTyxNQUFNO0FBQUEsUUFDYixLQUFLLE1BQU0sa0JBQWtCO0FBQUEsUUFDN0IsV0FBVyxPQUFPLFNBQVMsYUFDckIsVUFBVTtBQUFBLFVBQ04sS0FBSyxNQUFNLFFBQVEsV0FBVztBQUFBLFVBQzlCLFFBQVEsTUFBTSxRQUFRLFdBQVc7QUFBQSxVQUNqQyxPQUFPLE1BQU0sUUFBUSxXQUFXO0FBQUEsUUFDcEMsQ0FBQyxJQUNEO0FBQUEsUUFDTixRQUFRO0FBQUEsVUFDSixNQUFNLE1BQU0sZ0JBQWdCLElBQUksU0FBUztBQUFBLFFBQzdDO0FBQUEsTUFDSixFQUFFO0FBQUEsSUFDTixRQUFFO0FBQ0UsYUFBTyxDQUFDO0FBQUEsSUFDWjtBQUFBLEVBQ0o7QUFBQSxFQUVBLGFBQW9CLG9CQUFvQixLQUFrQixNQUFjLElBQVksTUFBYztBQUM5RixRQUFJO0FBQ0EsWUFBTSxXQUFXLElBQUkscUJBQXFCLE1BQU07QUFDaEQsVUFBSSxDQUFDLFNBQVM7QUFBUSxlQUFPO0FBRTdCLFlBQU0sUUFBUSxTQUFTLEtBQUssQ0FBQyxNQUFNLEVBQUUsYUFBYSxNQUFNLE1BQU0sYUFBYSxHQUFHLGFBQWEsU0FBUyxLQUFLLElBQUksY0FBYyxPQUFPLEdBQUcsYUFBYTtBQUNsSixZQUFNLFlBQVksU0FBUyxLQUFLLENBQUMsTUFBTSxFQUFFLGFBQWEsTUFBTSxNQUFNLGtCQUFrQixHQUFHLGFBQWEsU0FBUyxLQUFLO0FBQ2xILFlBQU0sY0FBYyxTQUFTLEtBQUssQ0FBQyxNQUFNLEVBQUUsYUFBYSxVQUFVLE1BQU0scUJBQXFCLEdBQUcsYUFBYSxTQUFTO0FBRXRILFlBQU0sT0FBTztBQUFBLFFBQ1QsSUFBSTtBQUFBLFFBQ0osVUFBVSxjQUNKLGNBQWMsV0FBVyxJQUN6QixTQUNLLEtBQUssQ0FBQyxNQUFNLEVBQUUsYUFBYSxNQUFNLE1BQU0sbUJBQW1CLEdBQ3pELFlBQVksTUFBTSxZQUFZLElBQUksR0FDbkMsTUFBTSxHQUFHLElBQUksTUFBTTtBQUFBLFFBQzlCO0FBQUEsUUFDQSxLQUFLO0FBQUEsUUFDTCxXQUNJLFNBQVMsS0FBSyxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsVUFBVSxFQUFFLFNBQVMsRUFBRSxhQUFhLFVBQVUsQ0FBRSxDQUFDLEdBQUcsYUFBYSxTQUFTLEtBQ3ZIO0FBQUEsUUFDSixRQUFRO0FBQUEsVUFDSixNQUFNLElBQUksY0FBYyw0QkFBNEIsR0FBRyxhQUFhLEtBQUssS0FBSztBQUFBLFFBQ2xGO0FBQUEsTUFDSjtBQUVBLGFBQU87QUFBQSxJQUNYLFFBQUU7QUFDRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQSxFQUVBLGFBQW9CLFlBQVksTUFBYztBQUMxQyxRQUFJLENBQUMscUNBQWMsTUFBTSxvQkFBb0IsS0FBSyxJQUFJLEdBQUc7QUFDckQsYUFBTztBQUFBLElBQ1g7QUFFQSxVQUFNLE1BQU0sSUFBSSxJQUFJLElBQUk7QUFDeEIsVUFBTSxLQUFLLElBQUksYUFBYSxJQUFJLEdBQUc7QUFDbkMsVUFBTSxPQUFPLElBQUksU0FBUyxNQUFNLFFBQVEsRUFBRSxJQUFJLE1BQU0sR0FBRyxFQUFFO0FBRXpELFFBQUksQ0FBQyxNQUFNLENBQUM7QUFBTSxhQUFPO0FBRXpCLFVBQU0sTUFBTSxNQUFNLFFBQVEsbUNBQW1DLFFBQVEsSUFBSTtBQUN6RSxRQUFJLENBQUM7QUFBSyxhQUFPO0FBRWpCLFFBQUk7QUFDQSxZQUFNLFVBQ0YsSUFBSSxlQUFlLHdCQUF3QixHQUFHLGFBQWEsSUFBSSxVQUFVLE1BQU0sOERBQThELElBQUksSUFBSSxNQUFNLFlBQVcsSUFBSTtBQUM5SyxVQUFJLENBQUM7QUFBUyxjQUFNO0FBQ3BCLFlBQU0sT0FBTyxLQUFLLE1BQU0sT0FBTyxFQUFFLEdBQUcsS0FBSztBQUN6QyxZQUFNLE9BQU8sS0FBSyxRQUFRLElBQUk7QUFFOUIsYUFBTztBQUFBLFFBQ0gsSUFBSSxLQUFLLFFBQVEsSUFBSSxNQUFNLEtBQUssa0JBQWtCO0FBQUEsUUFDbEQsVUFBVSxNQUFNLG9CQUFvQjtBQUFBLFFBQ3BDLE9BQU8sTUFBTSxRQUFRLEtBQUs7QUFBQSxRQUMxQixLQUFLLE1BQU0sT0FBTyxLQUFLLE9BQU87QUFBQSxRQUM5QixXQUFXLE1BQU0sVUFDWCxVQUFVO0FBQUEsVUFDTixLQUFLLEtBQUssUUFBUTtBQUFBLFVBQ2xCLFFBQVEsS0FBSyxRQUFRO0FBQUEsVUFDckIsT0FBTyxLQUFLLFFBQVE7QUFBQSxRQUN4QixDQUFDLElBQ0QsS0FBSyxhQUNMLFVBQVU7QUFBQSxVQUNOLFFBQVEsS0FBSztBQUFBLFVBQ2IsT0FBTyxLQUFLO0FBQUEsVUFDWixLQUFLLEtBQUs7QUFBQSxVQUNWLEtBQUssS0FBSyxZQUFZO0FBQUEsUUFDMUIsQ0FBQyxJQUNEO0FBQUEsUUFDTixRQUFRO0FBQUEsVUFDSixNQUFNLE1BQU0sY0FBYyxLQUFLLGVBQWU7QUFBQSxRQUNsRDtBQUFBLE1BQ0o7QUFBQSxJQUNKLFFBQUU7QUFDRSxhQUFPLEtBQUssb0JBQW9CLEtBQUssTUFBTSxJQUFJLElBQUk7QUFBQSxJQUN2RDtBQUFBLEVBQ0o7QUFBQSxFQUVBLGFBQW9CLGdCQUFnQixNQUFjO0FBQzlDLFFBQUksQ0FBQyxxQ0FBYyxNQUFNLHdCQUF3QixLQUFLLElBQUksR0FBRztBQUN6RCxhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sTUFBTSxNQUFNLFFBQVEsSUFBSTtBQUM5QixRQUFJLENBQUM7QUFBSyxhQUFPO0FBRWpCLFFBQUk7QUFDQSxZQUFNLFVBQ0YsSUFBSSxlQUFlLHdCQUF3QixHQUFHLGFBQWEsSUFBSSxVQUFVLE1BQU0sOERBQThELElBQUksSUFBSSxNQUFNLFlBQVcsSUFBSTtBQUM5SyxVQUFJLENBQUM7QUFBUyxjQUFNO0FBQ3BCLFlBQU0sS0FBSyxLQUFLLE1BQU0sT0FBTyxFQUFFLEdBQUcsS0FBSztBQUN2QyxZQUFNLFlBQVksR0FBRyxhQUNmLFVBQVU7QUFBQSxRQUNOLFFBQVEsR0FBRztBQUFBLFFBQ1gsT0FBTyxHQUFHO0FBQUEsUUFDVixLQUFLLEdBQUc7QUFBQSxRQUNSLEtBQUssR0FBRyxZQUFZO0FBQUEsTUFDeEIsQ0FBQyxJQUNEO0FBQ04sYUFBTztBQUFBLFFBQ0gsSUFBSSxHQUFHO0FBQUEsUUFDUCxPQUFPLEdBQUc7QUFBQSxRQUNWO0FBQUEsUUFDQSxRQUFRO0FBQUEsVUFDSixNQUFNLEdBQUcsVUFBVSxJQUFJLFlBQVksY0FBYztBQUFBLFFBQ3JEO0FBQUEsUUFDQSxLQUFLLEdBQUc7QUFBQSxRQUNSLFFBRUksR0FBRyxTQUFTLElBQUksQ0FBQyxNQUFXO0FBQ3hCLGdCQUFNLE9BQU8sRUFBRTtBQUNmLGlCQUFPO0FBQUEsWUFDSCxJQUFJLEVBQUU7QUFBQSxZQUNOLFVBQVUsS0FBSyxvQkFBb0I7QUFBQSxZQUNuQyxPQUFPLEtBQUs7QUFBQSxZQUNaLEtBQUssS0FBSztBQUFBLFlBQ1YsV0FBVyxLQUFLLFVBQ1YsVUFBVTtBQUFBLGNBQ04sS0FBSyxLQUFLLFFBQVE7QUFBQSxjQUNsQixRQUFRLEtBQUssUUFBUTtBQUFBLGNBQ3JCLE9BQU8sS0FBSyxRQUFRO0FBQUEsWUFDeEIsQ0FBQyxJQUNEO0FBQUEsWUFDTixRQUFRO0FBQUEsY0FDSixNQUFNLEtBQUssY0FBYztBQUFBLFlBQzdCO0FBQUEsVUFDSjtBQUFBLFFBQ0osQ0FBQyxLQUFLLENBQUM7QUFBQSxNQUNmO0FBQUEsSUFDSixRQUFFO0FBQ0UsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFQSxhQUFvQixhQUFhLE1BQWM7QUFDM0MsUUFBSSxDQUFDLHFDQUFjLE1BQU0scUJBQXFCLEtBQUssSUFBSSxHQUFHO0FBQ3RELGFBQU87QUFBQSxJQUNYO0FBRUEsVUFBTSxNQUFNLE1BQU0sUUFBUSxJQUFJO0FBQzlCLFFBQUksQ0FBQztBQUFLLGFBQU87QUFFakIsUUFBSTtBQUNBLFlBQU0sVUFDRixJQUFJLGVBQWUsd0JBQXdCLEdBQUcsYUFBYSxJQUFJLFVBQVUsTUFBTSw4REFBOEQsSUFBSSxJQUFJLE1BQU0sWUFBVyxJQUFJO0FBQzlLLFVBQUksQ0FBQztBQUFTLGNBQU07QUFDcEIsWUFBTSxLQUFLLEtBQUssTUFBTSxPQUFPLEVBQUUsR0FBRyxLQUFLO0FBQ3ZDLFlBQU0sWUFBWSxHQUFHLGFBQ2YsVUFBVTtBQUFBLFFBQ04sUUFBUSxHQUFHO0FBQUEsUUFDWCxPQUFPLEdBQUc7QUFBQSxRQUNWLEtBQUssR0FBRztBQUFBLFFBQ1IsS0FBSyxHQUFHLFlBQVk7QUFBQSxNQUN4QixDQUFDLElBQ0Q7QUFDTixhQUFPO0FBQUEsUUFDSCxJQUFJLEdBQUc7QUFBQSxRQUNQLE9BQU8sR0FBRztBQUFBLFFBQ1Y7QUFBQSxRQUNBLFFBQVE7QUFBQSxVQUNKLE1BQU0sR0FBRyxVQUFVLElBQUksWUFBWSxjQUFjO0FBQUEsUUFDckQ7QUFBQSxRQUNBLEtBQUssR0FBRztBQUFBLFFBQ1IsUUFFSSxHQUFHLFNBQVMsSUFBSSxDQUFDLE1BQVc7QUFDeEIsZ0JBQU0sT0FBTyxFQUFFO0FBQ2YsaUJBQU87QUFBQSxZQUNILElBQUksRUFBRTtBQUFBLFlBQ04sVUFBVSxLQUFLLG9CQUFvQjtBQUFBLFlBQ25DLE9BQU8sS0FBSztBQUFBLFlBQ1osS0FBSyxLQUFLO0FBQUEsWUFDVixXQUFXLEtBQUssVUFDVixVQUFVO0FBQUEsY0FDTixLQUFLLEtBQUssUUFBUTtBQUFBLGNBQ2xCLFFBQVEsS0FBSyxRQUFRO0FBQUEsY0FDckIsT0FBTyxLQUFLLFFBQVE7QUFBQSxZQUN4QixDQUFDLElBQ0Q7QUFBQSxZQUNOLFFBQVE7QUFBQSxjQUNKLE1BQU0sS0FBSyxjQUFjO0FBQUEsWUFDN0I7QUFBQSxVQUNKO0FBQUEsUUFDSixDQUFDLEtBQUssQ0FBQztBQUFBLE1BQ2Y7QUFBQSxJQUNKLFFBQUU7QUFDRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFDSjtBQXhPYTs7O0FDcERiLElBQU0sb0JBQW9CO0FBQzFCLElBQU0sc0JBQXNCO0FBQzVCLElBQU0sVUFBVTtBQVFULElBQU0sYUFBTixNQUFpQjtBQUFBLEVBR2IsWUFDSSxjQUF3RTtBQUFBLElBQzNFLFVBQVU7QUFBQSxJQUNWLGNBQWM7QUFBQSxFQUNsQixHQUNGO0FBSlM7QUFIWCxTQUFPLGNBQXNDO0FBQUEsRUFPMUM7QUFBQSxFQUVILElBQVcsbUJBQW1CO0FBQzFCLFFBQUksQ0FBQyxLQUFLLFlBQVksWUFBWSxDQUFDLEtBQUssWUFBWTtBQUFjLGFBQU87QUFDekUsV0FBTyxPQUFPLEtBQUssR0FBRyxLQUFLLFlBQVksWUFBWSxLQUFLLFlBQVksY0FBYyxFQUFFLFNBQVMsUUFBUTtBQUFBLEVBQ3pHO0FBQUEsRUFFQSxNQUFhLGVBQWU7QUFDeEIsVUFBTSxNQUFNLEtBQUs7QUFFakIsUUFBSSxDQUFDO0FBQUssYUFBTyxNQUFNLEtBQUssc0JBQXNCO0FBRWxELFFBQUk7QUFDQSxZQUFNLE1BQU0sTUFBTSxTQUFTLHFCQUFxQjtBQUFBLFFBQzVDLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNMLGNBQWM7QUFBQSxVQUNkLGVBQWUsU0FBUztBQUFBLFVBQ3hCLGdCQUFnQjtBQUFBLFFBQ3BCO0FBQUEsTUFDSixDQUFDO0FBRUQsWUFBTSxPQUFPLE1BQU0sSUFBSSxLQUFLO0FBRTVCLFVBQUksQ0FBQyxLQUFLO0FBQWMsY0FBTTtBQUU5QixZQUFNLE9BQU87QUFBQSxRQUNULE9BQU8sS0FBSztBQUFBLFFBQ1osY0FBYyxLQUFLO0FBQUEsUUFDbkIsTUFBTTtBQUFBLE1BQ1Y7QUFFQSxhQUFRLEtBQUssY0FBYztBQUFBLElBQy9CLFFBQUU7QUFDRSxhQUFPLE1BQU0sS0FBSyxzQkFBc0I7QUFBQSxJQUM1QztBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQWEsd0JBQXdCO0FBQ2pDLFFBQUk7QUFDQSxZQUFNLE1BQU0sTUFBTSxTQUFTLG1CQUFtQjtBQUFBLFFBQzFDLFNBQVM7QUFBQSxVQUNMLGNBQWM7QUFBQSxVQUNkLGdCQUFnQjtBQUFBLFFBQ3BCO0FBQUEsTUFDSixDQUFDO0FBRUQsVUFBSSxDQUFDLElBQUk7QUFBSSxjQUFNO0FBRW5CLFlBQU0sT0FBTyxNQUFNLElBQUksS0FBSztBQUU1QixVQUFJLENBQUMsS0FBSztBQUFhLGNBQU07QUFFN0IsWUFBTSxPQUFPO0FBQUEsUUFDVCxPQUFPLEtBQUs7QUFBQSxRQUNaLGNBQWMsS0FBSztBQUFBLFFBQ25CLE1BQU07QUFBQSxNQUNWO0FBRUEsYUFBUSxLQUFLLGNBQWM7QUFBQSxJQUMvQixRQUFFO0FBQ0UsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFTyxpQkFBaUI7QUFDcEIsUUFBSSxDQUFDLEtBQUs7QUFBYSxhQUFPO0FBQzlCLFdBQU8sS0FBSyxJQUFJLElBQUksS0FBSyxZQUFZO0FBQUEsRUFDekM7QUFBQSxFQUVBLE1BQWEsT0FBTyxPQUFlO0FBQy9CLFFBQUk7QUFFQSxVQUFJLEtBQUssZUFBZTtBQUFHLGNBQU0sS0FBSyxhQUFhO0FBRW5ELFVBQUksQ0FBQyxLQUFLO0FBQWEsZUFBTztBQUU5QixZQUFNLE1BQU0sTUFBTSxTQUFTLEdBQUcscUJBQXFCLG1CQUFtQixLQUFLLDBCQUEwQjtBQUFBLFFBQ2pHLFNBQVM7QUFBQSxVQUNMLGNBQWM7QUFBQSxVQUNkLGVBQWUsR0FBRyxLQUFLLFlBQVksUUFBUSxLQUFLLFlBQVk7QUFBQSxVQUM1RCxnQkFBZ0I7QUFBQSxRQUNwQjtBQUFBLE1BQ0osQ0FBQztBQUVELFVBQUksQ0FBQyxJQUFJO0FBQUksZUFBTztBQUVwQixZQUFNLE9BQThDLE1BQU0sSUFBSSxLQUFLO0FBRW5FLGFBQU8sS0FBSyxPQUFPLE1BQU0sSUFBSSxDQUFDLE9BQU87QUFBQSxRQUNqQyxPQUFPLEVBQUU7QUFBQSxRQUNULFVBQVUsRUFBRTtBQUFBLFFBQ1osUUFBUSxFQUFFLFFBQVEsSUFBSSxDQUFDQyxPQUFNQSxHQUFFLElBQUksRUFBRSxLQUFLLElBQUk7QUFBQSxRQUM5QyxLQUFLLEVBQUUsZUFBZSxXQUFXLGtDQUFrQyxFQUFFO0FBQUEsUUFDckUsV0FBVyxFQUFFLE1BQU0sU0FBUyxJQUFJLE9BQU87QUFBQSxNQUMzQyxFQUFFO0FBQUEsSUFDTixRQUFFO0FBQ0UsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUEsRUFFQSxNQUFhLFlBQVksSUFBWTtBQUNqQyxRQUFJO0FBRUEsVUFBSSxLQUFLLGVBQWU7QUFBRyxjQUFNLEtBQUssYUFBYTtBQUVuRCxVQUFJLENBQUMsS0FBSztBQUFhLGVBQU87QUFFOUIsWUFBTSxNQUFNLE1BQU0sU0FBUyxHQUFHLHFCQUFxQixnQkFBZ0I7QUFBQSxRQUMvRCxTQUFTO0FBQUEsVUFDTCxjQUFjO0FBQUEsVUFDZCxlQUFlLEdBQUcsS0FBSyxZQUFZLFFBQVEsS0FBSyxZQUFZO0FBQUEsVUFDNUQsZ0JBQWdCO0FBQUEsUUFDcEI7QUFBQSxNQUNKLENBQUM7QUFDRCxVQUFJLENBQUMsSUFBSTtBQUFJLGVBQU87QUFFcEIsWUFBTSxPQVVGLE1BQU0sSUFBSSxLQUFLO0FBRW5CLFVBQUksQ0FBQyxLQUFLLE9BQU8sTUFBTTtBQUFRLGVBQU87QUFFdEMsWUFBTSxJQUErQixLQUFLLE9BQU87QUFFakQsVUFBSSxPQUEyQixLQUFLLE9BQU87QUFFM0MsYUFBTyxPQUFPLFNBQVMsVUFBVTtBQUM3QixZQUFJO0FBQ0EsZ0JBQU1DLE9BQU0sTUFBTSxTQUFTLE1BQU07QUFBQSxZQUM3QixTQUFTO0FBQUEsY0FDTCxjQUFjO0FBQUEsY0FDZCxlQUFlLEdBQUcsS0FBSyxZQUFZLFFBQVEsS0FBSyxZQUFZO0FBQUEsY0FDNUQsZ0JBQWdCO0FBQUEsWUFDcEI7QUFBQSxVQUNKLENBQUM7QUFDRCxjQUFJLENBQUNBLEtBQUk7QUFBSTtBQUNiLGdCQUFNLFdBQWdFLE1BQU1BLEtBQUksS0FBSztBQUVyRixZQUFFLEtBQUssR0FBRyxTQUFTLEtBQUs7QUFDeEIsaUJBQU8sU0FBUztBQUVoQixjQUFJLENBQUM7QUFBTTtBQUFBLFFBQ2YsUUFBRTtBQUNFO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFFQSxZQUFNLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxPQUFPLEVBQUUsT0FBTztBQUFBLFFBQ3BDLE9BQU8sRUFBRTtBQUFBLFFBQ1QsVUFBVSxFQUFFO0FBQUEsUUFDWixRQUFRLEVBQUUsUUFBUSxJQUFJLENBQUNELE9BQU1BLEdBQUUsSUFBSSxFQUFFLEtBQUssSUFBSTtBQUFBLFFBQzlDLEtBQUssRUFBRSxlQUFlLFdBQVcsa0NBQWtDLEVBQUU7QUFBQSxRQUNyRSxXQUFXLEVBQUUsTUFBTSxTQUFTLElBQUksT0FBTztBQUFBLE1BQzNDLEVBQUU7QUFFRixVQUFJLENBQUMsT0FBTztBQUFRLGVBQU87QUFDM0IsYUFBTztBQUFBLFFBQ0gsTUFBTSxLQUFLO0FBQUEsUUFDWCxRQUFRLEtBQUssTUFBTTtBQUFBLFFBQ25CLFdBQVcsS0FBSyxTQUFTLElBQUksT0FBTztBQUFBLFFBQ3BDLElBQUksS0FBSztBQUFBLFFBQ1QsS0FBSyxLQUFLLGNBQWMsV0FBVyxxQ0FBcUM7QUFBQSxRQUN4RTtBQUFBLE1BQ0o7QUFBQSxJQUNKLFFBQUU7QUFDRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQWEsU0FBUyxJQUFZO0FBQzlCLFFBQUk7QUFFQSxVQUFJLEtBQUssZUFBZTtBQUFHLGNBQU0sS0FBSyxhQUFhO0FBRW5ELFVBQUksQ0FBQyxLQUFLO0FBQWEsZUFBTztBQUU5QixZQUFNLE1BQU0sTUFBTSxTQUFTLEdBQUcsa0JBQWtCLGdCQUFnQjtBQUFBLFFBQzVELFNBQVM7QUFBQSxVQUNMLGNBQWM7QUFBQSxVQUNkLGVBQWUsR0FBRyxLQUFLLFlBQVksUUFBUSxLQUFLLFlBQVk7QUFBQSxVQUM1RCxnQkFBZ0I7QUFBQSxRQUNwQjtBQUFBLE1BQ0osQ0FBQztBQUNELFVBQUksQ0FBQyxJQUFJO0FBQUksZUFBTztBQUVwQixZQUFNLE9BVUYsTUFBTSxJQUFJLEtBQUs7QUFFbkIsVUFBSSxDQUFDLEtBQUssT0FBTyxNQUFNO0FBQVEsZUFBTztBQUV0QyxZQUFNLElBQW9CLEtBQUssT0FBTztBQUV0QyxVQUFJLE9BQTJCLEtBQUssT0FBTztBQUUzQyxhQUFPLE9BQU8sU0FBUyxVQUFVO0FBQzdCLFlBQUk7QUFDQSxnQkFBTUMsT0FBTSxNQUFNLFNBQVMsTUFBTTtBQUFBLFlBQzdCLFNBQVM7QUFBQSxjQUNMLGNBQWM7QUFBQSxjQUNkLGVBQWUsR0FBRyxLQUFLLFlBQVksUUFBUSxLQUFLLFlBQVk7QUFBQSxjQUM1RCxnQkFBZ0I7QUFBQSxZQUNwQjtBQUFBLFVBQ0osQ0FBQztBQUNELGNBQUksQ0FBQ0EsS0FBSTtBQUFJO0FBQ2IsZ0JBQU0sV0FBcUQsTUFBTUEsS0FBSSxLQUFLO0FBRTFFLFlBQUUsS0FBSyxHQUFHLFNBQVMsS0FBSztBQUN4QixpQkFBTyxTQUFTO0FBRWhCLGNBQUksQ0FBQztBQUFNO0FBQUEsUUFDZixRQUFFO0FBQ0U7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUVBLFlBQU0sU0FBUyxFQUFFLElBQUksQ0FBQyxPQUFPO0FBQUEsUUFDekIsT0FBTyxFQUFFO0FBQUEsUUFDVCxVQUFVLEVBQUU7QUFBQSxRQUNaLFFBQVEsRUFBRSxRQUFRLElBQUksQ0FBQ0QsT0FBTUEsR0FBRSxJQUFJLEVBQUUsS0FBSyxJQUFJO0FBQUEsUUFDOUMsS0FBSyxFQUFFLGVBQWUsV0FBVyxrQ0FBa0MsRUFBRTtBQUFBLFFBQ3JFLFdBQVcsS0FBSyxTQUFTLElBQUksT0FBTztBQUFBLE1BQ3hDLEVBQUU7QUFFRixVQUFJLENBQUMsT0FBTztBQUFRLGVBQU87QUFDM0IsYUFBTztBQUFBLFFBQ0gsTUFBTSxLQUFLO0FBQUEsUUFDWCxRQUFRLEtBQUssUUFBUSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLElBQUk7QUFBQSxRQUNqRCxXQUFXLEtBQUssU0FBUyxJQUFJLE9BQU87QUFBQSxRQUNwQyxJQUFJLEtBQUs7QUFBQSxRQUNULEtBQUssS0FBSyxjQUFjLFdBQVcsa0NBQWtDO0FBQUEsUUFDckU7QUFBQSxNQUNKO0FBQUEsSUFDSixRQUFFO0FBQ0UsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQ0o7QUF0UWE7OztBSEZOLElBQU0sc0JBQU4sY0FBa0MscUNBQXVDO0FBQUEsRUFBekU7QUFBQTtBQUdILFNBQVEsVUFBVTtBQUFBO0FBQUEsRUFFbEIsTUFBYSxXQUEwQjtBQUNuQyxVQUFNLEtBQUssS0FBSyxRQUFRO0FBRXhCLFFBQUksT0FBTyxPQUFPLFlBQVk7QUFDMUIsV0FBSyxVQUFVO0FBQ2YsV0FBSyxVQUFVLENBQUMsTUFBYztBQUMxQixlQUFPLEdBQUcsTUFBTSxDQUFDO0FBQUEsTUFDckI7QUFFQTtBQUFBLElBQ0o7QUFFQSxVQUFNLE1BQU0sTUFBTSxTQUFTLEtBQUssUUFBUSxPQUFPLFFBQVEsV0FBVztBQUNsRSxTQUFLLFVBQVUsSUFBSTtBQUNuQixTQUFLLFVBQVU7QUFBQSxFQUNuQjtBQUFBLEVBRUEsTUFBYSxTQUFTLE9BQWUsTUFBNkQ7QUFFOUYsV0FBMkI7QUFBQSxNQUN2QixpQ0FBVTtBQUFBLE1BQ1YsaUNBQVU7QUFBQSxNQUNWLGlDQUFVO0FBQUEsTUFDVixpQ0FBVTtBQUFBLE1BQ1YsaUNBQVU7QUFBQSxNQUNWLGlDQUFVO0FBQUEsSUFDZCxFQUFHLEtBQUssQ0FBQyxNQUFNLE1BQU0sSUFBSTtBQUFBLEVBQzdCO0FBQUEsRUFFQSxNQUFhLGlCQUFpQixPQUFjO0FBQ3hDLFFBQUksTUFBTSxjQUFjLGlDQUFVO0FBQzlCLGFBQU8sS0FBSyxPQUFPLE1BQU0sVUFBVSxNQUFNLE9BQU87QUFBQSxRQUM1QyxNQUFNLGlDQUFVO0FBQUEsUUFDaEIsYUFBYSxNQUFNO0FBQUEsTUFDdkIsQ0FBQztBQUVMLFdBQU8sS0FBSyxlQUFlO0FBQUEsRUFDL0I7QUFBQSxFQUVBLE1BQWEsT0FBTyxPQUFlLFNBQXlEO0FBQ3hGLFlBQVEsUUFBUSxNQUFNO0FBQUEsTUFDbEIsS0FBSyxpQ0FBVTtBQUFBLE1BQ2YsS0FBSyxpQ0FBVTtBQUFBLE1BQ2YsS0FBSyxpQ0FBVSxvQkFBb0I7QUFDL0IsY0FBTSxPQUFPLE1BQU0sV0FBVyxPQUFPLEtBQUs7QUFDMUMsWUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLO0FBQVEsaUJBQU8sS0FBSyxlQUFlO0FBQ3RELGNBQU0sU0FBUyxLQUFLO0FBQUEsVUFFaEIsQ0FBQyxNQUFXO0FBQ1Isa0JBQU0sUUFBUSxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsY0FDekMsUUFBUSxFQUFFLE9BQU87QUFBQSxjQUNqQixhQUFhLEVBQUU7QUFBQSxjQUNmLFVBQVUsT0FBTyxFQUFFLGFBQWEsV0FBVyw0QkFBSyxjQUFjLDRCQUFLLFFBQVEsRUFBRSxRQUFRLENBQUMsSUFBSSxFQUFFO0FBQUEsY0FDNUYsV0FBVyxFQUFFO0FBQUEsY0FDYixPQUFPLEVBQUU7QUFBQSxjQUNULEtBQUssRUFBRTtBQUFBLGNBQ1AsT0FBTztBQUFBLGNBQ1AsUUFBUTtBQUFBLGNBQ1IsYUFBYSxRQUFRO0FBQUEsY0FDckIsV0FBVztBQUFBLFlBQ2YsQ0FBQztBQUVELGtCQUFNLFlBQVk7QUFFbEIsbUJBQU87QUFBQSxVQUNYO0FBQUEsUUFDSjtBQUVBLGVBQU8sS0FBSyxlQUFlLE1BQU0sTUFBTTtBQUFBLE1BQzNDO0FBQUEsTUFDQSxLQUFLLGlDQUFVLG1CQUFtQjtBQUM5QixjQUFNLE9BQU8sTUFBTSxXQUFXLGFBQWEsS0FBSztBQUNoRCxZQUFJLENBQUM7QUFBTSxpQkFBTyxLQUFLLGVBQWU7QUFFdEMsY0FBTSxXQUFXLElBQUksZ0NBQVMsS0FBSyxRQUFRLFFBQVE7QUFBQSxVQUMvQyxRQUFRO0FBQUEsWUFDSixNQUFNLEtBQUssT0FBTztBQUFBLFlBQ2xCLEtBQUs7QUFBQSxVQUNUO0FBQUEsVUFDQSxhQUFhLEtBQUs7QUFBQSxVQUNsQixJQUFJLEtBQUs7QUFBQSxVQUNULFFBQVE7QUFBQSxVQUNSLFdBQVcsS0FBSztBQUFBLFVBQ2hCLE9BQU8sS0FBSztBQUFBLFVBQ1osUUFBUSxDQUFDO0FBQUEsVUFDVCxNQUFNO0FBQUEsVUFDTixLQUFLLEtBQUs7QUFBQSxVQUNWLGFBQWE7QUFBQSxRQUNqQixDQUFDO0FBRUQsaUJBQVMsU0FBUyxLQUFLLE9BQU87QUFBQSxVQUMxQixDQUNJLE1BQ0M7QUFDRCxrQkFBTSxRQUFRLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxjQUN6QyxRQUFRLEVBQUUsT0FBTztBQUFBLGNBQ2pCLGFBQWEsRUFBRTtBQUFBLGNBQ2YsVUFBVSxPQUFPLEVBQUUsYUFBYSxXQUFXLDRCQUFLLGNBQWMsNEJBQUssUUFBUSxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQUU7QUFBQSxjQUM1RixXQUFXLEVBQUU7QUFBQSxjQUNiLE9BQU8sRUFBRTtBQUFBLGNBQ1QsS0FBSyxFQUFFO0FBQUEsY0FDUCxPQUFPO0FBQUEsY0FDUCxRQUFRO0FBQUEsY0FDUixhQUFhLFFBQVE7QUFBQSxjQUNyQixXQUFXO0FBQUEsWUFDZixDQUFDO0FBQ0Qsa0JBQU0sWUFBWTtBQUNsQixtQkFBTztBQUFBLFVBQ1g7QUFBQSxRQUNKO0FBRUEsZUFBTyxFQUFFLFVBQVUsUUFBUSxTQUFTLE9BQU87QUFBQSxNQUMvQztBQUFBLE1BQ0EsS0FBSyxpQ0FBVSxzQkFBc0I7QUFDakMsY0FBTSxPQUFPLE1BQU0sV0FBVyxnQkFBZ0IsS0FBSztBQUNuRCxZQUFJLENBQUM7QUFBTSxpQkFBTyxLQUFLLGVBQWU7QUFFdEMsY0FBTSxXQUFXLElBQUksZ0NBQVMsS0FBSyxRQUFRLFFBQVE7QUFBQSxVQUMvQyxRQUFRO0FBQUEsWUFDSixNQUFNLEtBQUssT0FBTztBQUFBLFlBQ2xCLEtBQUs7QUFBQSxVQUNUO0FBQUEsVUFDQSxhQUFhLEtBQUs7QUFBQSxVQUNsQixJQUFJLEtBQUs7QUFBQSxVQUNULFFBQVE7QUFBQSxVQUNSLFdBQVcsS0FBSztBQUFBLFVBQ2hCLE9BQU8sS0FBSztBQUFBLFVBQ1osUUFBUSxDQUFDO0FBQUEsVUFDVCxNQUFNO0FBQUEsVUFDTixLQUFLLEtBQUs7QUFBQSxVQUNWLGFBQWE7QUFBQSxRQUNqQixDQUFDO0FBRUQsaUJBQVMsU0FBUyxLQUFLLE9BQU87QUFBQSxVQUMxQixDQUNJLE1BQ0M7QUFDRCxrQkFBTSxRQUFRLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxjQUN6QyxRQUFRLEVBQUUsT0FBTztBQUFBLGNBQ2pCLGFBQWEsRUFBRTtBQUFBLGNBQ2YsVUFBVSxPQUFPLEVBQUUsYUFBYSxXQUFXLDRCQUFLLGNBQWMsNEJBQUssUUFBUSxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQUU7QUFBQSxjQUM1RixXQUFXLEVBQUU7QUFBQSxjQUNiLE9BQU8sRUFBRTtBQUFBLGNBQ1QsS0FBSyxFQUFFO0FBQUEsY0FDUCxPQUFPO0FBQUEsY0FDUCxRQUFRO0FBQUEsY0FDUixhQUFhLFFBQVE7QUFBQSxjQUNyQixXQUFXO0FBQUEsWUFDZixDQUFDO0FBRUQsa0JBQU0sWUFBWTtBQUVsQixtQkFBTztBQUFBLFVBQ1g7QUFBQSxRQUNKO0FBRUEsZUFBTyxFQUFFLFVBQVUsUUFBUSxTQUFTLE9BQU87QUFBQSxNQUMvQztBQUFBLE1BQ0EsS0FBSyxpQ0FBVSxrQkFBa0I7QUFDN0IsY0FBTSxPQUFPLE1BQU0sV0FBVyxZQUFZLEtBQUs7QUFDL0MsWUFBSSxDQUFDO0FBQU0saUJBQU8sS0FBSyxlQUFlO0FBRXRDLGNBQU0sUUFBUSxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsVUFDekMsUUFBUSxLQUFLLE9BQU87QUFBQSxVQUNwQixhQUFhLEtBQUs7QUFBQSxVQUNsQixVQUFVLE9BQU8sS0FBSyxhQUFhLFdBQVcsNEJBQUssY0FBYyw0QkFBSyxRQUFRLEtBQUssUUFBUSxDQUFDLElBQUksS0FBSztBQUFBLFVBQ3JHLFdBQVcsS0FBSztBQUFBLFVBQ2hCLE9BQU8sS0FBSztBQUFBLFVBQ1osS0FBSyxLQUFLO0FBQUEsVUFDVixPQUFPO0FBQUEsVUFDUCxRQUFRO0FBQUEsVUFDUixhQUFhLFFBQVE7QUFBQSxVQUNyQixXQUFXLFFBQVE7QUFBQSxRQUN2QixDQUFDO0FBRUQsY0FBTSxZQUFZO0FBRWxCLGVBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEtBQUssRUFBRTtBQUFBLE1BQzdDO0FBQUEsTUFDQTtBQUNJLGVBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEVBQUU7QUFBQSxJQUM1QztBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQWEsT0FBTyxNQUF5QztBQUN6RCxRQUFJLENBQUMsS0FBSyxTQUFTO0FBQ2YsWUFBTSxJQUFJLE1BQU0sMkNBQTJDLEtBQUssWUFBWSxPQUFPO0FBQUEsSUFDdkY7QUFFQSxRQUFJLE1BQU0sS0FBSztBQUVmLFFBQUksS0FBSyxTQUFTO0FBQ2QsVUFBSSxpQkFBaUIsWUFBWSxLQUFLLElBQUksR0FBRztBQUFHLGNBQU0sS0FBSyxJQUFJO0FBQUEsV0FDMUQ7QUFDRCxjQUFNLE9BQU8sTUFBTSxhQUFhLEdBQUcsS0FBSyxTQUFTLEtBQUssVUFBVSxPQUFPLEVBQ2xFLEtBQUssQ0FBQyxNQUFNLEVBQUUsR0FBRyxHQUFHLEVBQ3BCLE1BQU0sNEJBQUssSUFBSTtBQUNwQixZQUFJLENBQUM7QUFBTSxnQkFBTSxJQUFJLE1BQU0sOENBQThDO0FBQ3pFLGFBQUssSUFBSSxNQUFNLE1BQU07QUFBQSxNQUN6QjtBQUFBLElBQ0o7QUFFQSxXQUFPLEtBQUssUUFBUSxHQUFHO0FBQUEsRUFDM0I7QUFDSjtBQWpOYTtBQUFBLG9CQUNLLGFBQWE7OztBSVgvQixJQUFBRSx5QkFBd0g7QUFJeEgsOEJBQTZFO0FBRzdFLElBQU0sS0FBSztBQVFKLElBQU0sbUJBQU4sY0FBK0IscUNBQW9DO0FBQUEsRUFBbkU7QUFBQTtBQUdILFNBQVEsVUFBVTtBQUVsQixTQUFRLGVBQWU7QUFBQSxNQUNuQixVQUFVLEtBQUssUUFBUSxZQUFZLFFBQVEsSUFBSSx3QkFBd0I7QUFBQSxNQUN2RSxjQUFjLEtBQUssUUFBUSxnQkFBZ0IsUUFBUSxJQUFJLDRCQUE0QjtBQUFBLElBQ3ZGO0FBQ0EsU0FBTyxXQUFXLElBQUksV0FBVyxLQUFLLFlBQVk7QUFBQTtBQUFBLEVBRWxELE1BQWEsV0FBMEI7QUFDbkMsVUFBTSxLQUFLLEtBQUssUUFBUTtBQUV4QixRQUFJLE9BQU8sT0FBTyxZQUFZO0FBQzFCLFdBQUssVUFBVTtBQUNmLFdBQUssVUFBVSxDQUFDLE1BQWM7QUFDMUIsZUFBTyxHQUFHLE1BQU0sQ0FBQztBQUFBLE1BQ3JCO0FBRUE7QUFBQSxJQUNKO0FBRUEsVUFBTSxNQUFNLE1BQU0sU0FBUyxLQUFLLFFBQVEsT0FBTyxRQUFRLFdBQVc7QUFDbEUsU0FBSyxVQUFVLElBQUk7QUFDbkIsU0FBSyxXQUFPLHdCQUFBQyxTQUFRLFFBQVE7QUFDNUIsU0FBSyxVQUFVO0FBQ2YsUUFBSSxLQUFLLFNBQVMsZUFBZTtBQUFHLFlBQU0sS0FBSyxTQUFTLGFBQWE7QUFBQSxFQUN6RTtBQUFBLEVBRUEsTUFBYSxTQUFTLE9BQWUsTUFBNkQ7QUFFOUYsV0FBMkI7QUFBQSxNQUN2QixpQ0FBVTtBQUFBLE1BQ1YsaUNBQVU7QUFBQSxNQUNWLGlDQUFVO0FBQUEsTUFDVixpQ0FBVTtBQUFBLE1BQ1YsaUNBQVU7QUFBQSxNQUNWLGlDQUFVO0FBQUEsSUFDZCxFQUFHLEtBQUssQ0FBQyxNQUFNLE1BQU0sSUFBSTtBQUFBLEVBQzdCO0FBQUEsRUFFQSxNQUFhLGlCQUFpQixPQUFjO0FBQ3hDLFdBQU8sTUFBTSxLQUFLLE9BQU8sTUFBTSxVQUFVLE1BQU0sT0FBTztBQUFBLE1BQ2xELE1BQU0saUNBQVU7QUFBQSxJQUNwQixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsTUFBYSxPQUFPLE9BQWUsU0FBeUQ7QUFDeEYsWUFBUSxRQUFRLE1BQU07QUFBQSxNQUNsQixLQUFLLGlDQUFVO0FBQUEsTUFDZixLQUFLLGlDQUFVO0FBQUEsTUFDZixLQUFLLGlDQUFVLGdCQUFnQjtBQUMzQixjQUFNLE9BQU8sTUFBTSxLQUFLLFNBQVMsT0FBTyxLQUFLO0FBQzdDLFlBQUksQ0FBQztBQUFNLGlCQUFPLEtBQUssZUFBZTtBQUV0QyxlQUFPLEtBQUs7QUFBQSxVQUNSO0FBQUEsVUFDQSxLQUFLLElBQUksQ0FBQyxnQkFBZ0I7QUFDdEIsa0JBQU0sUUFBUSxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsY0FDekMsT0FBTyxZQUFZO0FBQUEsY0FDbkIsYUFBYSxHQUFHLFlBQVksWUFBWSxZQUFZO0FBQUEsY0FDcEQsUUFBUSxZQUFZLFVBQVU7QUFBQSxjQUM5QixLQUFLLFlBQVk7QUFBQSxjQUNqQixXQUFXLFlBQVksYUFBYTtBQUFBLGNBQ3BDLFVBQVUsNEJBQUssY0FBYyw0QkFBSyxRQUFRLFlBQVksWUFBWSxDQUFDLENBQUM7QUFBQSxjQUNwRSxPQUFPO0FBQUEsY0FDUCxhQUFhLFFBQVE7QUFBQSxjQUNyQixRQUFRO0FBQUEsY0FDUixXQUFXLGlDQUFVO0FBQUEsWUFDekIsQ0FBQztBQUVELGtCQUFNLFlBQVk7QUFFbEIsbUJBQU87QUFBQSxVQUNYLENBQUM7QUFBQSxRQUNMO0FBQUEsTUFDSjtBQUFBLE1BQ0EsS0FBSyxpQ0FBVSxjQUFjO0FBQ3pCLGNBQU0sY0FBa0MsTUFBTSxLQUFLLEtBQUssUUFBUSxPQUFPLFFBQVEsY0FBd0MsRUFBRSxNQUFNLDRCQUFLLElBQUk7QUFDeEksWUFBSSxDQUFDO0FBQWEsaUJBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEVBQUU7QUFDdEQsY0FBTSxlQUFlLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxVQUNoRCxPQUFPLFlBQVk7QUFBQSxVQUNuQixhQUFhLEdBQUcsWUFBWSxXQUFXLFlBQVksUUFBUSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLElBQUk7QUFBQSxVQUN2RixRQUFRLFlBQVksUUFBUSxJQUFJLFFBQVE7QUFBQSxVQUN4QyxLQUFLLFlBQVksS0FBSyxrQ0FBa0MsWUFBWSxPQUFPO0FBQUEsVUFDM0UsV0FBVyxZQUFZLFVBQVUsVUFBVSxJQUFJLE9BQU87QUFBQSxVQUN0RCxVQUFVLDRCQUFLLGNBQWMsNEJBQUssUUFBUSxZQUFZLFlBQVksWUFBWSxlQUFlLENBQUMsQ0FBQztBQUFBLFVBQy9GLE9BQU87QUFBQSxVQUNQLGFBQWEsUUFBUTtBQUFBLFVBQ3JCLFFBQVE7QUFBQSxVQUNSLFdBQVcsUUFBUTtBQUFBLFFBQ3ZCLENBQUM7QUFFRCxxQkFBYSxZQUFZO0FBRXpCLGVBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLFlBQVksRUFBRTtBQUFBLE1BQ3BEO0FBQUEsTUFDQSxLQUFLLGlDQUFVLGtCQUFrQjtBQUM3QixZQUFJO0FBQ0EsZ0JBQU0sRUFBRSxXQUFXLEdBQUcsSUFBSSxLQUFLLE1BQU0sS0FBSztBQUMxQyxjQUFJLGNBQWM7QUFBWSxrQkFBTTtBQUVwQyxnQkFBTSxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsWUFBWSxFQUFFO0FBQzFELGNBQUksQ0FBQztBQUFpQixrQkFBTTtBQUU1QixnQkFBTSxXQUFXLElBQUksZ0NBQVMsS0FBSyxRQUFRLFFBQVE7QUFBQSxZQUMvQyxPQUFPLGdCQUFnQjtBQUFBLFlBQ3ZCLGFBQWEsZ0JBQWdCLFFBQVE7QUFBQSxZQUNyQyxXQUFXLGdCQUFnQixhQUFhO0FBQUEsWUFDeEMsTUFBTTtBQUFBLFlBQ04sUUFBUTtBQUFBLFlBQ1IsUUFBUTtBQUFBLGNBQ0osTUFBTSxnQkFBZ0IsVUFBVTtBQUFBLGNBQ2hDLEtBQUs7QUFBQSxZQUNUO0FBQUEsWUFDQSxRQUFRLENBQUM7QUFBQSxZQUNULElBQUksZ0JBQWdCO0FBQUEsWUFDcEIsS0FBSyxnQkFBZ0IsT0FBTztBQUFBLFlBQzVCLGFBQWE7QUFBQSxVQUNqQixDQUFDO0FBRUQsbUJBQVMsU0FBUyxnQkFBZ0IsT0FBTyxJQUFJLENBQUMsZ0JBQWdCO0FBQzFELGtCQUFNLE9BQU8sSUFBSSw2QkFBTSxLQUFLLFFBQVEsUUFBUTtBQUFBLGNBQ3hDLE9BQU8sWUFBWTtBQUFBLGNBQ25CLGFBQWEsR0FBRyxZQUFZLFlBQVksWUFBWTtBQUFBLGNBQ3BELFFBQVEsWUFBWSxVQUFVO0FBQUEsY0FDOUIsS0FBSyxZQUFZO0FBQUEsY0FDakIsV0FBVyxZQUFZLGFBQWE7QUFBQSxjQUNwQyxVQUFVLDRCQUFLLGNBQWMsNEJBQUssUUFBUSxZQUFZLFlBQVksQ0FBQyxDQUFDO0FBQUEsY0FDcEUsT0FBTztBQUFBLGNBQ1AsYUFBYSxRQUFRO0FBQUEsY0FDckIsUUFBUTtBQUFBLGNBQ1IsV0FBVyxpQ0FBVTtBQUFBLFlBQ3pCLENBQUM7QUFDRCxpQkFBSyxZQUFZO0FBQ2pCLG1CQUFPO0FBQUEsVUFDWCxDQUFDO0FBRUQsaUJBQU8sRUFBRSxVQUFVLFFBQVEsU0FBUyxPQUFPO0FBQUEsUUFDL0MsUUFBRTtBQUNFLGdCQUFNLGtCQUEwQyxNQUFNLEtBQUssS0FBSyxRQUFRLE9BQU8sUUFBUSxjQUF3QyxFQUFFLE1BQU0sNEJBQUssSUFBSTtBQUNoSixjQUFJLENBQUM7QUFBaUIsbUJBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEVBQUU7QUFFMUQsZ0JBQU0sV0FBVyxJQUFJLGdDQUFTLEtBQUssUUFBUSxRQUFRO0FBQUEsWUFDL0MsT0FBTyxnQkFBZ0IsUUFBUSxnQkFBZ0I7QUFBQSxZQUMvQyxhQUFhLGdCQUFnQixTQUFTO0FBQUEsWUFDdEMsV0FBVyxnQkFBZ0IsVUFBVSxVQUFVLElBQUksT0FBTztBQUFBLFlBQzFELE1BQU0sZ0JBQWdCO0FBQUEsWUFDdEIsUUFBUTtBQUFBLFlBQ1IsUUFBUTtBQUFBLGNBQ0osTUFBTSxnQkFBZ0IsWUFBWTtBQUFBLGNBQ2xDLEtBQUs7QUFBQSxZQUNUO0FBQUEsWUFDQSxRQUFRLENBQUM7QUFBQSxZQUNULElBQUksZ0JBQWdCO0FBQUEsWUFDcEIsS0FBSyxnQkFBZ0IsS0FBSyxxQ0FBcUMsZ0JBQWdCLE9BQU87QUFBQSxZQUN0RixhQUFhO0FBQUEsVUFDakIsQ0FBQztBQUVELG1CQUFTLFNBQVMsZ0JBQWdCLFVBQVUsSUFBSSxDQUFDLE1BQU07QUFDbkQsa0JBQU0sT0FBTyxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsY0FDeEMsT0FBTyxFQUFFLFNBQVM7QUFBQSxjQUNsQixhQUFhLEVBQUUsU0FBUztBQUFBLGNBQ3hCLFFBQVEsRUFBRSxZQUFZO0FBQUEsY0FDdEIsS0FBSyxFQUFFLE1BQU0sbUNBQW1DLEVBQUUsUUFBUTtBQUFBLGNBQzFELFdBQVc7QUFBQSxjQUNYLFVBQVUsNEJBQUssY0FBYyw0QkFBSyxRQUFRLEVBQUUsUUFBUSxDQUFDO0FBQUEsY0FDckQsT0FBTztBQUFBLGNBQ1AsYUFBYSxRQUFRO0FBQUEsY0FDckI7QUFBQSxjQUNBLFFBQVE7QUFBQSxjQUNSLFdBQVc7QUFBQSxZQUNmLENBQUM7QUFDRCxpQkFBSyxZQUFZO0FBQ2pCLG1CQUFPO0FBQUEsVUFDWCxDQUFDO0FBRUQsaUJBQU8sRUFBRSxVQUFVLFFBQVEsU0FBUyxPQUFPO0FBQUEsUUFDL0M7QUFBQSxNQUNKO0FBQUEsTUFDQSxLQUFLLGlDQUFVLGVBQWU7QUFDMUIsWUFBSTtBQUNBLGdCQUFNLEVBQUUsV0FBVyxHQUFHLElBQUksS0FBSyxNQUFNLEtBQUs7QUFDMUMsY0FBSSxjQUFjO0FBQVMsa0JBQU07QUFFakMsZ0JBQU0sZUFBZSxNQUFNLEtBQUssU0FBUyxTQUFTLEVBQUU7QUFDcEQsY0FBSSxDQUFDO0FBQWMsa0JBQU07QUFFekIsZ0JBQU0sV0FBVyxJQUFJLGdDQUFTLEtBQUssUUFBUSxRQUFRO0FBQUEsWUFDL0MsT0FBTyxhQUFhO0FBQUEsWUFDcEIsYUFBYSxhQUFhLFFBQVE7QUFBQSxZQUNsQyxXQUFXLGFBQWEsYUFBYTtBQUFBLFlBQ3JDLE1BQU07QUFBQSxZQUNOLFFBQVE7QUFBQSxZQUNSLFFBQVE7QUFBQSxjQUNKLE1BQU0sYUFBYSxVQUFVO0FBQUEsY0FDN0IsS0FBSztBQUFBLFlBQ1Q7QUFBQSxZQUNBLFFBQVEsQ0FBQztBQUFBLFlBQ1QsSUFBSSxhQUFhO0FBQUEsWUFDakIsS0FBSyxhQUFhLE9BQU87QUFBQSxZQUN6QixhQUFhO0FBQUEsVUFDakIsQ0FBQztBQUVELG1CQUFTLFNBQVMsYUFBYSxPQUFPLElBQUksQ0FBQyxnQkFBZ0I7QUFDdkQsa0JBQU0sT0FBTyxJQUFJLDZCQUFNLEtBQUssUUFBUSxRQUFRO0FBQUEsY0FDeEMsT0FBTyxZQUFZO0FBQUEsY0FDbkIsYUFBYSxHQUFHLFlBQVksWUFBWSxZQUFZO0FBQUEsY0FDcEQsUUFBUSxZQUFZLFVBQVU7QUFBQSxjQUM5QixLQUFLLFlBQVk7QUFBQSxjQUNqQixXQUFXLFlBQVksYUFBYTtBQUFBLGNBQ3BDLFVBQVUsNEJBQUssY0FBYyw0QkFBSyxRQUFRLFlBQVksWUFBWSxDQUFDLENBQUM7QUFBQSxjQUNwRSxPQUFPO0FBQUEsY0FDUCxhQUFhLFFBQVE7QUFBQSxjQUNyQixRQUFRO0FBQUEsY0FDUixXQUFXLGlDQUFVO0FBQUEsWUFDekIsQ0FBQztBQUNELGlCQUFLLFlBQVk7QUFDakIsbUJBQU87QUFBQSxVQUNYLENBQUM7QUFFRCxpQkFBTyxFQUFFLFVBQVUsUUFBUSxTQUFTLE9BQU87QUFBQSxRQUMvQyxRQUFFO0FBQ0UsZ0JBQU0sUUFBNkIsTUFBTSxLQUFLLEtBQUssUUFBUSxPQUFPLFFBQVEsY0FBd0MsRUFBRSxNQUFNLDRCQUFLLElBQUk7QUFDbkksY0FBSSxDQUFDO0FBQU8sbUJBQU8sRUFBRSxVQUFVLE1BQU0sUUFBUSxDQUFDLEVBQUU7QUFFaEQsZ0JBQU0sV0FBVyxJQUFJLGdDQUFTLEtBQUssUUFBUSxRQUFRO0FBQUEsWUFDL0MsT0FBTyxNQUFNLFFBQVEsTUFBTTtBQUFBLFlBQzNCLGFBQWEsTUFBTSxTQUFTO0FBQUEsWUFDNUIsV0FBVyxNQUFNLFVBQVUsVUFBVSxJQUFJLE9BQU87QUFBQSxZQUNoRCxNQUFNLE1BQU07QUFBQSxZQUNaLFFBQVE7QUFBQSxZQUNSLFFBQVE7QUFBQSxjQUNKLE1BQU0sTUFBTSxZQUFZO0FBQUEsY0FDeEIsS0FBSztBQUFBLFlBQ1Q7QUFBQSxZQUNBLFFBQVEsQ0FBQztBQUFBLFlBQ1QsSUFBSSxNQUFNO0FBQUEsWUFDVixLQUFLLE1BQU0sS0FBSyxxQ0FBcUMsTUFBTSxPQUFPO0FBQUEsWUFDbEUsYUFBYTtBQUFBLFVBQ2pCLENBQUM7QUFFRCxtQkFBUyxTQUFTLE1BQU0sVUFBVSxJQUFJLENBQUMsTUFBTTtBQUN6QyxrQkFBTSxPQUFPLElBQUksNkJBQU0sS0FBSyxRQUFRLFFBQVE7QUFBQSxjQUN4QyxPQUFPLEVBQUUsU0FBUztBQUFBLGNBQ2xCLGFBQWEsRUFBRSxTQUFTO0FBQUEsY0FDeEIsUUFBUSxFQUFFLFlBQVk7QUFBQSxjQUN0QixLQUFLLEVBQUUsTUFBTSxtQ0FBbUMsRUFBRSxRQUFRO0FBQUEsY0FDMUQsV0FBVztBQUFBLGNBQ1gsVUFBVSw0QkFBSyxjQUFjLDRCQUFLLFFBQVEsRUFBRSxRQUFRLENBQUM7QUFBQSxjQUNyRCxPQUFPO0FBQUEsY0FDUCxhQUFhLFFBQVE7QUFBQSxjQUNyQjtBQUFBLGNBQ0EsUUFBUTtBQUFBLGNBQ1IsV0FBVztBQUFBLFlBQ2YsQ0FBQztBQUNELGlCQUFLLFlBQVk7QUFDakIsbUJBQU87QUFBQSxVQUNYLENBQUM7QUFFRCxpQkFBTyxFQUFFLFVBQVUsUUFBUSxTQUFTLE9BQU87QUFBQSxRQUMvQztBQUFBLE1BQ0o7QUFBQSxNQUNBO0FBQ0ksZUFBTyxFQUFFLFVBQVUsTUFBTSxRQUFRLENBQUMsRUFBRTtBQUFBLElBQzVDO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYSxPQUFPLE1BQXlDO0FBQ3pELFFBQUksQ0FBQyxLQUFLLFNBQVM7QUFDZixZQUFNLElBQUksTUFBTSwyQ0FBMkMsS0FBSyxZQUFZLE9BQU87QUFBQSxJQUN2RjtBQUVBLFFBQUksTUFBTSxLQUFLO0FBRWYsUUFBSSxLQUFLLFNBQVM7QUFDZCxVQUFJLGlCQUFpQixZQUFZLEtBQUssSUFBSSxHQUFHO0FBQUcsY0FBTSxLQUFLLElBQUk7QUFBQSxXQUMxRDtBQUNELGNBQU0sT0FBTyxNQUFNLGFBQWEsR0FBRyxLQUFLLFNBQVMsS0FBSyxVQUFVLE9BQU8sRUFDbEUsS0FBSyxDQUFDLE1BQU0sRUFBRSxHQUFHLEdBQUcsRUFDcEIsTUFBTSw0QkFBSyxJQUFJO0FBQ3BCLFlBQUksQ0FBQztBQUFNLGdCQUFNLElBQUksTUFBTSw4Q0FBOEM7QUFDekUsYUFBSyxJQUFJLE1BQU0sTUFBTTtBQUFBLE1BQ3pCO0FBQUEsSUFDSjtBQUVBLFdBQU8sS0FBSyxRQUFRLEdBQUc7QUFBQSxFQUMzQjtBQUFBLEVBRU8sTUFBTSxHQUFXO0FBQ3BCLFVBQU0sQ0FBQyxFQUFFLFdBQVcsRUFBRSxJQUFJLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQztBQUV6QyxXQUFPLEVBQUUsV0FBVyxHQUFHO0FBQUEsRUFDM0I7QUFDSjtBQXZTYTtBQUFBLGlCQUNLLGFBQWE7OztBZFp4QixJQUFNLFVBQWtCOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfeW91dHViZV9zciIsICJpbXBvcnRfZGlzY29yZF9wbGF5ZXIiLCAibGliIiwgInJlIiwgIkdlbml1c0NsaWVudCIsICJpbXBvcnRfZGlzY29yZF9wbGF5ZXIiLCAiaHR0cHMiLCAiaHR0cCIsICJpbXBvcnRfZGlzY29yZF9wbGF5ZXIiLCAicmV2ZXJibmF0aW9uIiwgImltcG9ydF9kaXNjb3JkX3BsYXllciIsICJpbXBvcnRfaHR0cCIsICJpbXBvcnRfaHR0cHMiLCAiaHR0cCIsICJodHRwcyIsICJwYXRoIiwgImltcG9ydF9kaXNjb3JkX3BsYXllciIsICJpbXBvcnRfZGlzY29yZF9wbGF5ZXIiLCAiciIsICJtIiwgInJlcyIsICJpbXBvcnRfZGlzY29yZF9wbGF5ZXIiLCAic3BvdGlmeSJdCn0K